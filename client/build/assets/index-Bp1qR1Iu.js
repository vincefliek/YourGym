var Ua=Object.defineProperty;var Wa=(e,t,n)=>t in e?Ua(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var I=(e,t,n)=>Wa(e,typeof t!="symbol"?t+"":t,n);import{j as d,O as _i,R as Ga,c as qa,a as Va,b as X,d as Ka}from"./router-HN5EHAsr.js";import{a as nt,R as j,r as f,g as mn,d as Kt,c as Xt}from"./react-B0Mogulq.js";import{M as Xa,u as Ya,C as Se,I as Za,_ as lr,a as Si,b as Ja,d as Qa,S as eo}from"./mantine-reKHhM81.js";import{R as kn,L as is,a as On,B as to,C as as,X as os,Y as cs,T as ls,b as no}from"./charts-6H_0gcD4.js";import{t as ro,f as so,V as io}from"./utils-D6vW3VTF.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var Ti,ds=nt;Ti=ds.createRoot,ds.hydrateRoot;const ao="modulepreload",oo=function(e){return"/"+e},us={},co=function(t,n,r){let s=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));s=Promise.allSettled(n.map(c=>{if(c=oo(c),c in us)return;us[c]=!0;const l=c.endsWith(".css"),u=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const g=document.createElement("link");if(g.rel=l?"stylesheet":ao,l||(g.as="script"),g.crossOrigin="",g.href=c,o&&g.setAttribute("nonce",o),document.head.appendChild(g),l)return new Promise((h,p)=>{g.addEventListener("load",h),g.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return s.then(a=>{for(const o of a||[])o.status==="rejected"&&i(o.reason);return t().catch(i)})},lo=function(){return null},Ei=j.createContext({serviceLocator:{getStore:()=>({getStoreData:()=>({}),subscribe:()=>()=>{}}),getAPIs:()=>({navigationApi:{routes:{home:"",trainings:"",menu:"",createTraining:"",createExercise:"",editNewExercise:"",editExistingExercise:"",openTraining:"",openExercise:""}}})}}),V=(e,t)=>{if(typeof e!="object")throw new Error("First argument in `connect` function is mandatory");if(typeof e.controller!="function")throw new Error("`params.controller` property in `connect` function is mandatory");if(!Array.isArray(e.controller.storeDataAccessors))throw new Error("Controller doesn't have mandatory static property 'storeDataAccessors'");return n=>{class r extends j.Component{constructor(a,o){super(a);I(this,"unsubscribe");I(this,"controller");I(this,"stateToProps");I(this,"_update",()=>{this.stateToProps=t(this.controller),this.forceUpdate()});this.controller=e.controller(o.serviceLocator),this.stateToProps=t(this.controller);const c=o.serviceLocator.getStore();e.controller.storeDataAccessors.length&&(this.unsubscribe=c.subscribe(this._update,e.controller.storeDataAccessors))}componentWillUnmount(){this.unsubscribe&&this.unsubscribe()}render(){return d.jsx(n,{...this.props,...this.stateToProps})}}return I(r,"contextType",Ei),r}},We=e=>{if(typeof e!="function")throw new Error("`getInfo` argument in `requireData` function is mandatory");const t=e({});if(!!!(Object.prototype.hasOwnProperty.call(t,"isData")&&Object.prototype.hasOwnProperty.call(t,"onNoData")))throw new Error("return value of `getInfo()` in `requireData` lacks data!");return r=>{class s extends j.Component{componentDidMount(){this.check()}check(){const{isData:a,onNoData:o}=e(this.props);a||o()}render(){const{isData:a}=e(this.props);return a?j.createElement(r,this.props):null}}return s}},uo=()=>{const e=window,t=navigator.userAgent||navigator.vendor||e.opera;return!!(/iPad|iPhone|iPod/.test(t)&&!e.MSStream||navigator.maxTouchPoints>0&&/Macintosh/.test(t))};function go(e,t=1e3){let n=0,r=!1;function s(i){r||(i-n>=t&&(n=i,e()),requestAnimationFrame(s))}return requestAnimationFrame(s),()=>{r=!0}}const jt=e=>{const t=-e.getTimezoneOffset(),n=t>=0?"+":"-",r=String(Math.floor(Math.abs(t)/60)).padStart(2,"0"),s=String(Math.abs(t)%60).padStart(2,"0");return e.toISOString().replace("Z",`${n}${r}:${s}`)},dr=e=>{const{authApi:t,trainingsApi:n,notificationsApi:r}=e.getAPIs(),s=e.getStore(),i=()=>s.getStoreData(dr.storeDataAccessors),a=o=>i().completedTrainings.find(c=>c.id===o);return{isAuthenticated:()=>i().auth.isAuthenticated,signin:async(o,c)=>{try{await t.signin(o,c)}catch(l){r.addNotification({type:"error",message:l.message||"Sigin failed. Double check your credentials!"})}},signup:async(o,c)=>{try{await t.signup(o,c)}catch(l){r.addNotification({type:"error",message:l.message||"Signup failed. Double check your credentials!"})}},getCompletedTrainings:()=>i().completedTrainings.sort((o,c)=>new Date(c.timestamptz).getTime()-new Date(o.timestamptz).getTime()),onDeleteCompletedTraining:async o=>{const c=a(o);if(!c)throw new Error(`Training with ID "${o}" doesn't exist!`);window.confirm(`Do you really want to delete "${c.name}"?`)&&await n.delete.completedTraining(c.id)},getDateAndTime:o=>({date:n.create.datePreview(o),time:n.create.timePreview(o)}),createSetsPreview:o=>n.create.setsPreview(o.map(c=>({...c,done:!0})))}};dr.storeDataAccessors=["auth","completedTrainings"];const Ue=e=>f.createElement("svg",{width:"30px",height:"30px",viewBox:"0 0 284.011 284.011",xmlns:"http://www.w3.org/2000/svg",...e},f.createElement("path",{d:"M235.732,66.214l-28.006-13.301l1.452-3.057c6.354-13.379,0.639-29.434-12.74-35.789L172.316,2.611 c-6.48-3.079-13.771-3.447-20.532-1.042c-6.76,2.406-12.178,7.301-15.256,13.782l-1.452,3.057L107.07,5.106 c-14.653-6.958-32.239-0.698-39.2,13.955L60.7,34.155c-1.138,2.396-1.277,5.146-0.388,7.644c0.89,2.499,2.735,4.542,5.131,5.68 l74.218,35.25h-98.18c-2.797,0-5.465,1.171-7.358,3.229c-1.894,2.059-2.839,4.815-2.607,7.602l13.143,157.706 c1.53,18.362,17.162,32.745,35.588,32.745h73.54c18.425,0,34.057-14.383,35.587-32.745l11.618-139.408l28.205,13.396 c1.385,0.658,2.845,0.969,4.283,0.969c3.74,0,7.328-2.108,9.04-5.712l7.169-15.093C256.646,90.761,250.386,73.175,235.732,66.214z M154.594,23.931c0.786-1.655,2.17-2.905,3.896-3.521c1.729-0.614,3.59-0.521,5.245,0.267l24.121,11.455 c3.418,1.624,4.878,5.726,3.255,9.144l-1.452,3.057l-36.518-17.344L154.594,23.931z M169.441,249.604 c-0.673,8.077-7.55,14.405-15.655,14.405h-73.54c-8.106,0-14.983-6.328-15.656-14.405L52.35,102.728h129.332L169.441,249.604z M231.62,96.835l-2.878,6.06L83.057,33.701l2.879-6.061c2.229-4.695,7.863-6.698,12.554-4.469l128.661,61.108 C231.845,86.509,233.85,92.142,231.62,96.835z"})),ho="_screen_1xw2f_1",po="_authForm_1xw2f_8",fo="_authFormHeader_1xw2f_22",vo="_authField_1xw2f_29",mo="_authLabel_1xw2f_35",xo="_authInput_1xw2f_40",yo="_authActions_1xw2f_55",bo="_authSubmit_1xw2f_63",wo="_authToggleButton_1xw2f_68",_o="_trainings_1xw2f_76",So="_training_1xw2f_76",To="_trainingDate_1xw2f_90",Eo="_trainingBoxWrapper_1xw2f_95",Co="_trainingBox_1xw2f_95",Do="_trainingDelete_1xw2f_113",Ao="_trainingBoxHeader_1xw2f_117",$o="_trainingName_1xw2f_125",No="_expandIndicator_1xw2f_129",jo="_exerciseList_1xw2f_135",Ro="_expanded_1xw2f_142",Io="_exerciseRow_1xw2f_148",Po="_exerciseName_1xw2f_158",ko="_exerciseSets_1xw2f_162",L={screen:ho,authForm:po,authFormHeader:fo,authField:vo,authLabel:mo,authInput:xo,authActions:yo,authSubmit:bo,authToggleButton:wo,trainings:_o,training:So,trainingDate:To,trainingBoxWrapper:Eo,trainingBox:Co,trainingDelete:Do,trainingBoxHeader:Ao,trainingName:$o,expandIndicator:No,exerciseList:jo,expanded:Ro,exerciseRow:Io,exerciseName:Po,exerciseSets:ko};var Ci={exports:{}};/*!
  Copyright (c) 2018 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/(function(e){(function(){var t={}.hasOwnProperty;function n(){for(var r=[],s=0;s<arguments.length;s++){var i=arguments[s];if(i){var a=typeof i;if(a==="string"||a==="number")r.push(i);else if(Array.isArray(i)){if(i.length){var o=n.apply(null,i);o&&r.push(o)}}else if(a==="object")if(i.toString===Object.prototype.toString)for(var c in i)t.call(i,c)&&i[c]&&r.push(c);else r.push(i.toString())}}return r.join(" ")}e.exports?(n.default=n,e.exports=n):window.classNames=n})()})(Ci);var Oo=Ci.exports;const ae=mn(Oo),gs=({title:e,onSubmit:t})=>{const[n,r]=j.useState(""),[s,i]=j.useState(""),a=o=>{o.preventDefault(),t({email:n,password:s})};return d.jsxs("form",{onSubmit:a,className:L.authForm,children:[d.jsx("h3",{className:L.authFormHeader,children:e}),d.jsxs("div",{className:L.authField,children:[d.jsx("label",{className:L.authLabel,htmlFor:"email",children:"Email:"}),d.jsx("input",{className:L.authInput,type:"email",id:"email",value:n,onChange:o=>r(o.target.value)})]}),d.jsxs("div",{className:L.authField,children:[d.jsx("label",{className:L.authLabel,htmlFor:"password",children:"Password:"}),d.jsx("input",{className:L.authInput,type:"password",id:"password",value:s,onChange:o=>i(o.target.value)})]}),d.jsx("div",{className:L.authActions,children:d.jsx(k,{type:"submit",className:L.authSubmit,skin:"primary",size:"medium","data-testid":"auth-submit-button",children:"Submit"})})]})},Bo=e=>{const{isAuthenticated:t,signin:n,signup:r,onDeleteCompletedTraining:s,createSetsPreview:i}=e,[a,o]=j.useState(null),c=h=>{o(p=>p===h?null:h)},[l,u]=j.useState(!0),g=()=>{const{completedTrainings:h,getDateAndTime:p}=e;return d.jsxs(d.Fragment,{children:[d.jsx("h3",{style:{textAlign:"center"},children:"Recent Trainings"}),d.jsx("ul",{className:L.trainings,"data-testid":"completed-trainings-list",children:h.map(m=>{const y=a===m.id;return d.jsxs("li",{className:L.training,"data-testid":"completed-training-item",children:[d.jsx("div",{className:L.trainingDate,children:p(m.timestamptz).date}),d.jsxs("div",{className:L.trainingBoxWrapper,children:[d.jsx(k,{skin:"icon",size:"medium",className:L.trainingDelete,onClick:()=>s(m.id),"data-testid":"delete-completed-training-button",children:d.jsx(Ue,{})}),d.jsxs("div",{className:L.trainingBox,children:[d.jsxs("div",{className:L.trainingBoxHeader,"aria-expanded":y,children:[d.jsx("div",{className:ae({[L.trainingName]:y}),children:m.name}),d.jsx(k,{className:L.expandIndicator,skin:"text",size:"medium",onClick:()=>c(m.id),"aria-expanded":y,"data-testid":"toggle-completed-training-details-button",children:y?"ðŸ“–":"ðŸ“—"})]}),d.jsx("div",{className:ae(L.exerciseList,{[L.expanded]:y,[L.collapsed]:!y}),children:m.exercises.map(b=>d.jsxs("div",{className:L.exerciseRow,children:[d.jsx("div",{className:L.exerciseName,children:b.name}),d.jsx("div",{className:L.exerciseSets,children:i(b.sets)})]},b.id))})]})]})]},m.id)})})]})};return d.jsx(ve,{bottomBar:d.jsx(st,{}),dataTestId:"home-screen",children:d.jsxs("div",{className:L.screen,children:[!t&&d.jsxs(d.Fragment,{children:[l?d.jsx(gs,{title:"Sign In",onSubmit:({email:h,password:p})=>n(h,p)}):d.jsx(gs,{title:"Sign Up",onSubmit:({email:h,password:p})=>r(h,p)}),d.jsx(k,{className:L.authToggleButton,skin:"text",size:"medium",onClick:()=>u(h=>!h),"data-testid":"toggle-form-type-button",children:l?"Go to Sign Up":"Go to Sign In"})]}),g()]})})},Lo=V({controller:dr},e=>({isAuthenticated:e.isAuthenticated(),completedTrainings:e.getCompletedTrainings(),onDeleteCompletedTraining:e.onDeleteCompletedTraining,signin:e.signin,signup:e.signup,getDateAndTime:e.getDateAndTime,createSetsPreview:e.createSetsPreview}))(Bo),ur=e=>{const{getStoreData:t}=e.getStore(),{navigationApi:n,trainingsApi:r}=e.getAPIs(),s=()=>t(ur.storeDataAccessors),i=a=>s().trainings.find(o=>o.id===a);return{getTrainings:()=>s().trainings,onAddTraining:()=>{r.create.newTraining();const a=s().newTraining;a!=null&&a.id&&n.toCreateTraining(a.id)},onDeleteTraining:a=>{const o=i(a);if(!o)throw new Error(`Training with ID "${a}" doesn't exist!`);window.confirm(`Do you really want to delete "${o.name}"?`)&&r.delete.training(a)},onOpenTraining:a=>{n.toTraining(a)}}};ur.storeDataAccessors=["trainings","newTraining"];const Mo=e=>f.createElement("svg",{width:"30px",height:"30px",viewBox:"0 0 489.8 489.8",xmlns:"http://www.w3.org/2000/svg",...e},f.createElement("path",{d:"M438.2,0H51.6C23.1,0,0,23.2,0,51.6v386.6c0,28.5,23.2,51.6,51.6,51.6h386.6c28.5,0,51.6-23.2,51.6-51.6V51.6 C489.8,23.2,466.6,0,438.2,0z M465.3,438.2c0,14.9-12.2,27.1-27.1,27.1H51.6c-14.9,0-27.1-12.2-27.1-27.1V51.6 c0-14.9,12.2-27.1,27.1-27.1h386.6c14.9,0,27.1,12.2,27.1,27.1V438.2z"}),f.createElement("path",{d:"M337.4,232.7h-80.3v-80.3c0-6.8-5.5-12.3-12.3-12.3s-12.3,5.5-12.3,12.3v80.3h-80.3c-6.8,0-12.3,5.5-12.3,12.2 c0,6.8,5.5,12.3,12.3,12.3h80.3v80.3c0,6.8,5.5,12.3,12.3,12.3s12.3-5.5,12.3-12.3v-80.3h80.3c6.8,0,12.3-5.5,12.3-12.3 C349.7,238.1,344.2,232.7,337.4,232.7z"})),Fo="_screen_1cql9_1",zo="_screenAddNew_1cql9_1",Ho="_addNew_1cql9_11",Uo="_trainings_1cql9_15",Wo="_training_1cql9_15",Go="_trainingBox_1cql9_29",qo="_trainingDelete_1cql9_36",Vo="_navbarContainer_1cql9_40",Pe={screen:Fo,screenAddNew:zo,addNew:Ho,trainings:Uo,training:Wo,trainingBox:Go,trainingDelete:qo,navbarContainer:Vo},Ko=e=>{const{data:t}=e,n=t.length,r=()=>{const{onAdd:a}=e;return d.jsx(k,{skin:"primary",font:"nunito",className:Pe.addNew,onClick:a,"data-testid":"add-first-training-button",children:"Add your 1st training"})},s=()=>{const{data:a,onDelete:o,onOpen:c}=e;return d.jsx("ul",{className:Pe.trainings,"data-testid":"trainings-list",children:a.map(l=>d.jsxs("li",{className:Pe.training,"data-testid":"training-item",children:[d.jsx(k,{skin:"icon",size:"medium",className:Pe.trainingDelete,onClick:()=>o(l.id),"data-testid":"delete-training-button",children:d.jsx(Ue,{})}),d.jsx("div",{className:Pe.trainingBox,onClick:()=>c(l.id),"data-testid":"open-training-button",children:l.name})]},l.id))})},i=()=>{const{onAdd:a}=e;return d.jsx(it,{className:Pe.navbarContainer,children:d.jsx(k,{skin:"icon",size:"large",onClick:a,"data-testid":"add-training-button-top",children:d.jsx(Mo,{})})})};return n?d.jsx(ve,{topBar:i(),bottomBar:d.jsx(st,{}),dataTestId:"trainings-screen",children:d.jsx("div",{className:Pe.screen,children:s()})}):d.jsx(ve,{bottomBar:d.jsx(st,{}),dataTestId:"trainings-screen-no-data",children:d.jsx("div",{className:Pe.screenAddNew,children:r()})})},Xo=V({controller:ur},e=>({data:e.getTrainings(),onAdd:e.onAddTraining,onDelete:e.onDeleteTraining,onOpen:e.onOpenTraining}))(Ko);function Yo(e={}){const{immediate:t=!1,onNeedRefresh:n,onOfflineReady:r,onRegistered:s,onRegisteredSW:i,onRegisterError:a}=e;let o,c,l;const u=async(h=!0)=>{await c,l==null||l()};async function g(){if("serviceWorker"in navigator){if(o=await co(async()=>{const{Workbox:h}=await import("./workbox-window.prod.es5-vqzQaGvo.js");return{Workbox:h}},[]).then(({Workbox:h})=>new h("/sw.js",{scope:"/",type:"classic"})).catch(h=>{a==null||a(h)}),!o)return;l=()=>{o==null||o.messageSkipWaiting()};{let h=!1;const p=()=>{h=!0,o==null||o.addEventListener("controlling",m=>{m.isUpdate&&window.location.reload()}),n==null||n()};o.addEventListener("installed",m=>{typeof m.isUpdate>"u"?typeof m.isExternal<"u"&&m.isExternal?p():!h&&(r==null||r()):m.isUpdate||r==null||r()}),o.addEventListener("waiting",p)}o.register({immediate:t}).then(h=>{i?i("/sw.js",h):s==null||s(h)}).catch(h=>{a==null||a(h)})}}return c=g(),u}function Zo(e={}){const{immediate:t=!0,onNeedRefresh:n,onOfflineReady:r,onRegistered:s,onRegisteredSW:i,onRegisterError:a}=e,[o,c]=f.useState(!1),[l,u]=f.useState(!1),[g]=f.useState(()=>Yo({immediate:t,onOfflineReady(){u(!0),r==null||r()},onNeedRefresh(){c(!0),n==null||n()},onRegistered:s,onRegisteredSW:i,onRegisterError:a}));return{needRefresh:[o,c],offlineReady:[l,u],updateServiceWorker:g}}const gr=e=>{const t=e.getStore(),{syncApi:n,authApi:r,notificationsApi:s}=e.getAPIs(),i=()=>t.getStoreData(gr.storeDataAccessors);return{getAuthData:()=>{const a=i().auth;return{isAuthenticated:a.isAuthenticated,isLoading:a.authLoading,error:a.authError}},getSyncData:()=>{const a=i().sync;return{lastSyncAt:a.lastSyncAt,isLoading:a.isLoading,serverHasChanges:a.serverHasChanges,error:a.error}},sync:async()=>{await n.sync()},signout:async()=>{try{await r.signout()}catch(a){s.addNotification({type:"error",message:`Sigout failed, details: ${a.message}`})}}}};gr.storeDataAccessors=["auth","sync"];const Jo="_metadataBox_1jj5x_1",Qo="_twoColumns_1jj5x_12",Ee={metadataBox:Jo,twoColumns:Qo};function ec(){const{needRefresh:[e,t],updateServiceWorker:n}=Zo();return d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:Ee.twoColumns,children:[d.jsx("div",{children:"Status:"}),e?d.jsx("div",{children:"â³ New version is waiting..."}):d.jsx("div",{children:"âœ…"})]}),d.jsx("br",{}),e&&d.jsxs(d.Fragment,{children:[d.jsx(k,{skin:"primary",font:"nunito",size:"small",onClick:()=>n(!0),style:{width:"100%"},"data-testid":"update-sw-button",children:"Update Now"}),d.jsx("br",{}),d.jsx(k,{skin:"zero-style",font:"nunito",onClick:()=>t(!1),style:{width:"100%"},"data-testid":"dismiss-sw-button",children:"DISMISS"})]})]})}const tc=e=>{const{authData:t,syncData:n,sync:r,signout:s}=e;return d.jsxs(ve,{bottomBar:d.jsx(st,{}),dataTestId:"menu-screen",children:[d.jsx("div",{style:{marginBottom:12},children:d.jsx(Sy,{})}),d.jsxs("div",{className:Ee.metadataBox,children:[d.jsx("h4",{children:"Auth"}),d.jsxs("div",{className:Ee.twoColumns,children:[d.jsx("div",{children:"Status:"}),t.isLoading?d.jsx("div",{children:"â³ Loading..."}):t.isAuthenticated?d.jsx("div",{children:"âœ…"}):d.jsx("div",{children:"â›”ï¸"})]}),t.error&&d.jsxs("div",{className:Ee.twoColumns,children:[d.jsx("div",{children:"Error:"}),d.jsx("div",{children:t.error})]}),d.jsx("br",{}),d.jsx(k,{skin:"primary",font:"nunito",onClick:()=>s(),style:{width:"100%"},disabled:t.isLoading,"data-testid":"signout-button",children:"Sign out"})]}),d.jsxs("div",{className:Ee.metadataBox,children:[d.jsx("h4",{children:"Service Worker"}),d.jsx(ec,{})]}),d.jsxs("div",{className:Ee.metadataBox,children:[d.jsx("h4",{children:"Sync"}),d.jsxs("div",{className:Ee.twoColumns,children:[d.jsx("div",{children:"Last at:"}),n.isLoading?d.jsx("div",{children:"â³ Loading..."}):n.lastSyncAt?d.jsx("div",{children:n.lastSyncAt}):d.jsx("div",{children:"ðŸ—ï¸ TBD"})]}),d.jsxs("div",{className:Ee.twoColumns,children:[d.jsx("div",{children:"Status:"}),n.serverHasChanges?d.jsx("div",{children:"âš ï¸ Server has changes âš ï¸"}):d.jsx("div",{children:"âœ…"})]}),n.error&&d.jsxs("div",{className:Ee.twoColumns,children:[d.jsx("div",{children:"Error:"}),d.jsx("div",{children:n.error})]}),d.jsx("br",{}),d.jsx(k,{skin:"primary",font:"nunito",onClick:r,style:{width:"100%"},disabled:n.isLoading,"data-testid":"sync-button",children:"Sync"})]}),d.jsx("br",{})]})},nc=V({controller:gr},e=>({authData:e.getAuthData(),syncData:e.getSyncData(),sync:e.sync,signout:e.signout}))(tc);function rc(){return d.jsx(ve,{dataTestId:"not-found-screen",bottomBar:d.jsx(st,{}),children:d.jsxs("div",{style:{padding:12},children:[d.jsx("h2",{children:"404 - Not Found"}),d.jsx("p",{children:"The page you are looking for does not exist."})]})})}const hr=e=>{const{getStoreData:t}=e.getStore(),{trainingsApi:n,navigationApi:r}=e.getAPIs(),s=()=>t(hr.storeDataAccessors);return{getData:()=>{const i=s().newTraining;if(i!==null)return{...i,exercises:i.exercises.map(a=>({...a,setsPreview:n.create.setsPreview(a.sets)}))}},onNoData:()=>{r.toTrainings()},onChangeName:i=>{n.update.newTraining({name:i})},onAddExercise:async()=>{var a,o;const i=(a=s().newTraining)==null?void 0:a.id;if(i){n.create.newExercise();const c=(o=s().newExercise)==null?void 0:o.id;c&&await r.toCreateExercise(i,c,{goBackTo:r.routes.createTraining})}},onDelete:async()=>{await r.toTrainings(),n.delete.newTraining()},onSave:async()=>{await r.toTrainings(),n.save.newTraining()},onDeleteExercise:(i,a)=>{n.delete.exercise(i,a)},onOpenExercise:i=>{var o;const a=(o=s().newTraining)==null?void 0:o.id;a&&r.toEditNewExercise(a,i,{goBackTo:r.routes.createTraining})},onReorderExercises:(i,a)=>{n.update.exercisesOrder(i,a)}}};hr.storeDataAccessors=["newTraining","newExercise"];const sc=e=>{const{data:t,onChangeName:n,onAddExercise:r,onDelete:s,onSave:i,onDeleteExercise:a,onOpenExercise:o,onReorderExercises:c}=e;return d.jsx(ea,{dataTestId:"create-training-screen",id:t.id,name:t.name,exercises:t.exercises,onChangeName:n,onAddExercise:r,onDelete:s,onSave:i,onDeleteExercise:a,onOpenExercise:o,onReorderExercises:c})},ic=V({controller:hr},e=>({data:e.getData(),onNoData:e.onNoData,onChangeName:e.onChangeName,onAddExercise:e.onAddExercise,onDelete:e.onDelete,onSave:e.onSave,onDeleteExercise:e.onDeleteExercise,onOpenExercise:e.onOpenExercise,onReorderExercises:e.onReorderExercises}))(We(e=>({isData:!!e.data,onNoData:e.onNoData}))(sc));var ac=/\s/;function oc(e){for(var t=e.length;t--&&ac.test(e.charAt(t)););return t}var cc=oc,lc=cc,dc=/^\s+/;function uc(e){return e&&e.slice(0,lc(e)+1).replace(dc,"")}var gc=uc;function hc(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Ot=hc,pc=typeof Kt=="object"&&Kt&&Kt.Object===Object&&Kt,Di=pc,fc=Di,vc=typeof self=="object"&&self&&self.Object===Object&&self,mc=fc||vc||Function("return this")(),Ce=mc,xc=Ce,yc=xc.Symbol,Bt=yc,hs=Bt,Ai=Object.prototype,bc=Ai.hasOwnProperty,wc=Ai.toString,Tt=hs?hs.toStringTag:void 0;function _c(e){var t=bc.call(e,Tt),n=e[Tt];try{e[Tt]=void 0;var r=!0}catch{}var s=wc.call(e);return r&&(t?e[Tt]=n:delete e[Tt]),s}var Sc=_c,Tc=Object.prototype,Ec=Tc.toString;function Cc(e){return Ec.call(e)}var Dc=Cc,ps=Bt,Ac=Sc,$c=Dc,Nc="[object Null]",jc="[object Undefined]",fs=ps?ps.toStringTag:void 0;function Rc(e){return e==null?e===void 0?jc:Nc:fs&&fs in Object(e)?Ac(e):$c(e)}var Lt=Rc;function Ic(e){return e!=null&&typeof e=="object"}var Mt=Ic,Pc=Lt,kc=Mt,Oc="[object Symbol]";function Bc(e){return typeof e=="symbol"||kc(e)&&Pc(e)==Oc}var Ft=Bc,Lc=gc,vs=Ot,Mc=Ft,ms=NaN,Fc=/^[-+]0x[0-9a-f]+$/i,zc=/^0b[01]+$/i,Hc=/^0o[0-7]+$/i,Uc=parseInt;function Wc(e){if(typeof e=="number")return e;if(Mc(e))return ms;if(vs(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=vs(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=Lc(e);var n=zc.test(e);return n||Hc.test(e)?Uc(e.slice(2),n?2:8):Fc.test(e)?ms:+e}var Gc=Wc;const Oe=mn(Gc),pr=e=>{const{getStoreData:t}=e.getStore(),{trainingsApi:n,navigationApi:r}=e.getAPIs(),s=()=>t(pr.storeDataAccessors),i=()=>r.getPathParams(r.routes.createExercise);return{getData:()=>s().newExercise,onNoData:()=>{r.toTrainings()},onChangeName:a=>{n.update.newExercise({name:a})},onChangeRepetitions:(a,o)=>{const{sets:c}=s().newExercise;n.update.newExercise({sets:c.map(l=>l.id===a?{...l,repetitions:Oe(o)}:l)})},onChangeWeight:(a,o)=>{const{sets:c}=s().newExercise;n.update.newExercise({sets:c.map(l=>l.id===a?{...l,weight:Oe(o)}:l)})},onAddSet:()=>{var c;const a=i().training,o=(c=s().newExercise)==null?void 0:c.id;a&&o&&n.create.set(a,o)},onDeleteSet:(a,o)=>{const c=i().training;c&&n.delete.set(c,a,o)},onDelete:async()=>{await r.goBack({replace:!0}),n.delete.newExercise()},onSave:async()=>{const a=i().training;await r.goBack({replace:!0}),a&&n.save.newExercise(a)}}};pr.storeDataAccessors=["newExercise"];class qc extends j.Component{constructor(){super(...arguments);I(this,"_onDeleteSet",n=>{const r=this.props.data.id;this.props.onDeleteSet(r,n)})}render(){const{data:n,onChangeName:r,onChangeRepetitions:s,onChangeWeight:i,onAddSet:a,onDelete:o,onSave:c}=this.props;return d.jsx(Or,{dataTestId:"create-exercise-screen",data:n,onChangeName:r,onDeleteSet:this._onDeleteSet,onChangeRepetitions:s,onChangeWeight:i,onAddSet:a,onDelete:o,onSave:c})}}const Vc=V({controller:pr},e=>({data:e.getData(),onChangeName:e.onChangeName,onChangeWeight:e.onChangeWeight,onChangeRepetitions:e.onChangeRepetitions,onNoData:e.onNoData,onAddSet:e.onAddSet,onDeleteSet:e.onDeleteSet,onDelete:e.onDelete,onSave:e.onSave}))(We(e=>({isData:!!e.data,onNoData:e.onNoData}))(qc)),fr=e=>{const{getStoreData:t}=e.getStore(),{navigationApi:n,trainingsApi:r}=e.getAPIs(),s=()=>t(fr.storeDataAccessors),i=()=>n.getPathParams(n.routes.openTraining),a=()=>s().trainings,o=()=>{const c=i();return a().find(g=>g.id===c.training)};return{isAnyTrainingInProgress:()=>!!s().activeTraining,isCurrentTrainingInProgress:()=>{const c=o(),l=s().activeTraining;return c&&l?c.id===l.templateTrainingId:!1},getTraining:()=>{const c=o();if(c)return{...c,exercises:c.exercises.map(l=>({...l,setsPreview:r.create.setsPreview(l.sets)}))}},onNoData:()=>{n.toTrainings()},onStart:()=>{const c=o();if(c){if(!c.exercises.length){window.alert("Start denied - training has ZERO exercises!");return}r.create.newActiveTraining(c.id);const l=c.exercises[0];n.toExercise(c.id,l.id)}},onFinish:async()=>{var l;const c=(l=o())==null?void 0:l.id;if(c){if(!s().activeTraining){window.alert("Stop denied - your training was NOT started!");return}const u=a().map(g=>g.id===c?{...g,exercises:g.exercises.map(h=>({...h,sets:h.sets.map(p=>(p.done&&r.update.newActiveTraining(c,h.id,p),{...p,done:!1}))}))}:g);r.update.allTrainings(u),r.save.newActiveTraining(),await n.toHome()}},onBack:()=>{n.toTrainings()},onEdit:()=>{const c=o();c&&n.toEditTraining(c.id)},onOpenExercise:(c,l)=>{n.toExercise(c.id,l.id)}}};fr.storeDataAccessors=["trainings","activeTraining"];const Kc=e=>f.createElement("svg",{width:"30px",height:"30px",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 55.25 55.25",...e},f.createElement("path",{d:"M52.618,2.631c-3.51-3.508-9.219-3.508-12.729,0L3.827,38.693C3.81,38.71,3.8,38.731,3.785,38.749 c-0.021,0.024-0.039,0.05-0.058,0.076c-0.053,0.074-0.094,0.153-0.125,0.239c-0.009,0.026-0.022,0.049-0.029,0.075 c-0.003,0.01-0.009,0.02-0.012,0.03l-3.535,14.85c-0.016,0.067-0.02,0.135-0.022,0.202C0.004,54.234,0,54.246,0,54.259 c0.001,0.114,0.026,0.225,0.065,0.332c0.009,0.025,0.019,0.047,0.03,0.071c0.049,0.107,0.11,0.21,0.196,0.296 c0.095,0.095,0.207,0.168,0.328,0.218c0.121,0.05,0.25,0.075,0.379,0.075c0.077,0,0.155-0.009,0.231-0.027l14.85-3.535 c0.027-0.006,0.051-0.021,0.077-0.03c0.034-0.011,0.066-0.024,0.099-0.039c0.072-0.033,0.139-0.074,0.201-0.123 c0.024-0.019,0.049-0.033,0.072-0.054c0.008-0.008,0.018-0.012,0.026-0.02l36.063-36.063C56.127,11.85,56.127,6.14,52.618,2.631z  M51.204,4.045c2.488,2.489,2.7,6.397,0.65,9.137l-9.787-9.787C44.808,1.345,48.716,1.557,51.204,4.045z M46.254,18.895l-9.9-9.9 l1.414-1.414l9.9,9.9L46.254,18.895z M4.961,50.288c-0.391-0.391-1.023-0.391-1.414,0L2.79,51.045l2.554-10.728l4.422-0.491 l-0.569,5.122c-0.004,0.038,0.01,0.073,0.01,0.11c0,0.038-0.014,0.072-0.01,0.11c0.004,0.033,0.021,0.06,0.028,0.092 c0.012,0.058,0.029,0.111,0.05,0.165c0.026,0.065,0.057,0.124,0.095,0.181c0.031,0.046,0.062,0.087,0.1,0.127 c0.048,0.051,0.1,0.094,0.157,0.134c0.045,0.031,0.088,0.06,0.138,0.084C9.831,45.982,9.9,46,9.972,46.017 c0.038,0.009,0.069,0.03,0.108,0.035c0.036,0.004,0.072,0.006,0.109,0.006c0,0,0.001,0,0.001,0c0,0,0.001,0,0.001,0h0.001 c0,0,0.001,0,0.001,0c0.036,0,0.073-0.002,0.109-0.006l5.122-0.569l-0.491,4.422L4.204,52.459l0.757-0.757 C5.351,51.312,5.351,50.679,4.961,50.288z M17.511,44.809L39.889,22.43c0.391-0.391,0.391-1.023,0-1.414s-1.023-0.391-1.414,0 L16.097,43.395l-4.773,0.53l0.53-4.773l22.38-22.378c0.391-0.391,0.391-1.023,0-1.414s-1.023-0.391-1.414,0L10.44,37.738 l-3.183,0.354L34.94,10.409l9.9,9.9L17.157,47.992L17.511,44.809z M49.082,16.067l-9.9-9.9l1.415-1.415l9.9,9.9L49.082,16.067z"})),$i=e=>f.createElement("svg",{width:"30px",height:"30px",viewBox:"0 0 386.242 386.242",xmlns:"http://www.w3.org/2000/svg",...e},f.createElement("path",{d:"M374.212,182.3H39.432l100.152-99.767c4.704-4.704,4.704-12.319,0-17.011 c-4.704-4.704-12.319-4.704-17.011,0L3.474,184.61c-4.632,4.632-4.632,12.379,0,17.011l119.1,119.1 c4.704,4.704,12.319,4.704,17.011,0c4.704-4.704,4.704-12.319,0-17.011L39.432,206.36h334.779c6.641,0,12.03-5.39,12.03-12.03 S380.852,182.3,374.212,182.3z"})),Xc="_screen_3m9a3_1",Yc="_buttonScreen_3m9a3_9",Zc="_navbarContainer_3m9a3_16",Jc="_topBar_3m9a3_20",Qc="_button_3m9a3_9",el="_exercises_3m9a3_34",tl="_exercise_3m9a3_34",nl="_exerciseBox_3m9a3_49",Te={screen:Xc,buttonScreen:Yc,navbarContainer:Zc,topBar:Jc,button:Qc,exercises:el,exercise:tl,exerciseBox:nl};class rl extends j.Component{constructor(){super(...arguments);I(this,"renderTopBar",()=>{const{data:n}=this.props;return d.jsx("div",{className:Te.topBar,children:n.name})});I(this,"renderBottomBar",()=>{const{onBack:n,onEdit:r}=this.props;return d.jsxs(it,{className:Te.navbarContainer,children:[d.jsx(k,{skin:"icon",size:"large",onClick:n,"data-testid":"training-back-button",children:d.jsx($i,{})}),d.jsx(k,{skin:"icon",size:"large",onClick:r,"data-testid":"training-edit-button",children:d.jsx(Kc,{})})]})});I(this,"renderExercises",()=>{const{data:n,onOpenExercise:r}=this.props;return d.jsx("ul",{className:Te.exercises,"data-testid":"training-exercises-list",children:n.exercises.map(s=>d.jsx("li",{className:Te.exercise,"data-testid":"training-exercise-item",onClick:()=>r(n,s),children:d.jsxs("div",{className:Te.exerciseBox,children:[s.name,d.jsx("br",{}),s.setsPreview]})},s.id))})})}render(){const{data:n,isAnyTrainingInProgress:r,isCurrentTrainingInProgress:s,onStart:i,onFinish:a}=this.props,o=!!n.exercises.length;return d.jsxs(ve,{topBar:this.renderTopBar(),bottomBar:this.renderBottomBar(),dataTestId:"existing-training-screen",children:[d.jsx("div",{className:Te.screen,children:o&&this.renderExercises()}),d.jsx("div",{className:Te.buttonScreen,children:s?d.jsx(k,{skin:"primary",font:"nunito",className:Te.button,onClick:a,"data-testid":"finish-training-button",children:"ðŸ† FINISH ðŸ†"}):r?null:d.jsx(k,{skin:"primary",font:"nunito",className:Te.button,onClick:i,"data-testid":"start-training-button",children:"Start"})})]})}}const sl=V({controller:fr},e=>({data:e.getTraining(),isAnyTrainingInProgress:e.isAnyTrainingInProgress(),isCurrentTrainingInProgress:e.isCurrentTrainingInProgress(),onNoData:e.onNoData,onStart:e.onStart,onFinish:e.onFinish,onBack:e.onBack,onEdit:e.onEdit,onOpenExercise:e.onOpenExercise}))(We(e=>({isData:!!e.data,onNoData:e.onNoData}))(rl)),vr=e=>{const{getStoreData:t}=e.getStore(),{navigationApi:n,trainingsApi:r}=e.getAPIs(),s=()=>t(vr.storeDataAccessors),i=()=>n.getPathParams(n.routes.openExercise),a=()=>{const c=i();return s().trainings.find(g=>g.id===c.training)},o=(c,l,u)=>{var p;const g=(p=a())==null?void 0:p.id;if(!g)return;const h=s().trainings.map(m=>m.id===g?{...m,exercises:m.exercises.map(y=>y.id===c?{...y,sets:y.sets.map(b=>b.id===l?{...b,...u}:b)}:y)}:m);r.update.allTrainings(h)};return{isInProgress:()=>!!s().activeTraining,getTraining:()=>a(),getExercise:()=>{const c=i(),l=a();return l==null?void 0:l.exercises.find(g=>g.id===c.exercise)},getCurrentExerciseIntoNavbar:(c,l)=>c.exercises.indexOf(l)+1,getTotalExercisesIntoNavbar:c=>c.exercises.length,onChangeRepetitions:(c,l,u)=>{o(c,l,{repetitions:Oe(u)})},onChangeWeight:(c,l,u)=>{o(c,l,{weight:Oe(u)})},onDoneSet:async(c,l,u)=>{o(l,u.id,{done:!0})},onResetDoneSet:async(c,l,u)=>{o(l,u.id,{done:!1})},onExerciseNext:async(c,l)=>{const u=c.exercises.indexOf(l);if(u<c.exercises.length-1){const g=c.exercises[u+1].id;await n.toExercise(c.id,g);const h=s().trainings;r.update.allTrainings(h)}},onExercisePrev:async(c,l)=>{const u=c.exercises.indexOf(l);if(u>0){const g=c.exercises[u-1].id;await n.toExercise(c.id,g);const h=s().trainings;r.update.allTrainings(h)}},onNoData:()=>{n.toTrainings()},onBack:()=>{const c=i().training;c&&n.toTraining(c)},getSetsHistory:()=>{const c=s(),l=i(),u=a(),g=u==null?void 0:u.exercises.find(p=>p.id===l.exercise);return g?[...c.completedTrainings].sort((p,m)=>new Date(m.timestamptz).getTime()-new Date(p.timestamptz).getTime()).map(p=>{const m=p.exercises.find(y=>y.name===g.name);return!m||!m.sets.length?null:{date:r.create.datePreview(p.timestamptz),sets:m.sets.map(y=>({id:y.id,repetitions:y.repetitions,weight:y.weight,time:r.create.timePreview(y.timestamptz)}))}}).filter(Boolean):[]}}};vr.storeDataAccessors=["trainings","activeTraining","completedTrainings"];const il=e=>f.createElement("svg",{width:"30px",height:"30px",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg",...e},f.createElement("path",{d:"M15 2a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2zM0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2zm11.5 5.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H11.5z"})),al=e=>f.createElement("svg",{width:"30px",height:"30px",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg",...e},f.createElement("path",{d:"M15 2a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2zM0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2zm4.5 5.5a.5.5 0 0 0 0 1h5.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3a.5.5 0 0 0 0-.708l-3-3a.5.5 0 1 0-.708.708L10.293 7.5H4.5z"})),cn=e=>f.createElement("svg",{height:30,viewBox:"0 0 400 400",width:30,xmlns:"http://www.w3.org/2000/svg",...e},f.createElement("path",{d:"m199.996 0c-110.283 0-199.996 89.72-199.996 200s89.713 200 199.996 200 200.004-89.72 200.004-200-89.721-200-200.004-200zm0 373.77c-95.816 0-173.766-77.954-173.766-173.77 0-95.817 77.949-173.769 173.766-173.769s173.771 77.953 173.771 173.769c.001 95.816-77.955 173.77-173.771 173.77z"}),f.createElement("path",{d:"m272.406 134.526-103.131 103.126-41.689-41.68c-5.123-5.117-13.422-5.12-18.545.003-5.125 5.125-5.125 13.425 0 18.548l50.963 50.955c2.561 2.558 5.916 3.838 9.271 3.838s6.719-1.28 9.279-3.842c.008-.011.014-.022.027-.035l112.369-112.368c5.125-5.12 5.125-13.426 0-18.546-5.122-5.123-13.427-5.123-18.544.001z"})),ol="_screen_1k40v_1",cl="_navbarContainer_1k40v_9",ll="_topBar_1k40v_18",dl="_sets_1k40v_26",ul="_set_1k40v_26",gl="_setPreview_1k40v_40",hl="_setRepetitions_1k40v_54",pl="_setWeight_1k40v_58",fl="_setDone_1k40v_74",vl="_history_1k40v_79",ml="_historyUnit_1k40v_84",xl="_setsDate_1k40v_91",yl="_setsHistoryBox_1k40v_97",bl="_setsByDate_1k40v_104",wl="_setUnit_1k40v_111",_l="_setTime_1k40v_115",F={screen:ol,navbarContainer:cl,switch:"_switch_1k40v_13",topBar:ll,sets:dl,set:ul,setPreview:gl,setRepetitions:hl,setWeight:pl,setDone:fl,history:vl,historyUnit:ml,setsDate:xl,setsHistoryBox:yl,setsByDate:bl,setUnit:wl,setTime:_l};let Sl=class extends j.Component{constructor(){super(...arguments);I(this,"renderTopBar",()=>{const{exercise:n}=this.props;return d.jsx("div",{className:F.topBar,children:n.name})});I(this,"renderBottomBar",()=>{const{training:n,exercise:r,isInProgress:s,getCurrentExercise:i,getTotalExercises:a,onBack:o,onExerciseNext:c,onExercisePrev:l}=this.props;return d.jsxs(it,{className:F.navbarContainer,children:[d.jsx(k,{skin:"icon",size:"large",onClick:o,"data-testid":"back-button",children:d.jsx($i,{})}),s&&d.jsxs("div",{className:F.switch,children:[d.jsx(k,{skin:"icon",size:"large",onClick:()=>l(n,r),"data-testid":"prev-exercise-button",children:d.jsx(il,{})}),d.jsxs("div",{children:[i(n,r),"/",a(n)]}),d.jsx(k,{skin:"icon",size:"large",onClick:()=>c(n,r),"data-testid":"next-exercise-button",children:d.jsx(al,{})})]})]})});I(this,"renderSets",()=>{const{training:n,exercise:r,isInProgress:s,onDoneSet:i,onResetDoneSet:a,onChangeRepetitions:o,onChangeWeight:c}=this.props;return d.jsx("ul",{className:F.sets,children:r.sets.map(l=>{const u=l.done||!s;return d.jsx("li",{className:F.set,children:d.jsxs("div",{className:F.setPreview,children:[d.jsx("div",{className:F.setRepetitions,children:d.jsx(Rt,{type:"number",disabled:u,value:l.repetitions,onBlur:g=>o(r.id,l.id,Number(g))})}),d.jsx("div",{children:"X"}),d.jsx("div",{className:F.setWeight,children:d.jsx(Rt,{type:"number",disabled:u,value:l.weight,onBlur:g=>c(r.id,l.id,Number(g))})}),d.jsx("div",{children:"kg"}),s?l.done?d.jsx(k,{skin:"text",size:"large",font:"indieFlower",onClick:()=>a(n.id,r.id,l),"data-testid":"undo-set-button",children:"done"}):d.jsx(k,{skin:"icon",size:"large",className:F.setDone,onClick:()=>i(n.id,r.id,l),"data-testid":"done-set-button",children:d.jsx(cn,{})}):null]})},l.id)})})});I(this,"renderSetsHistory",()=>{const{setsHistory:n}=this.props;return d.jsxs("div",{className:F.history,children:[d.jsx("div",{className:F.historyUnit,children:"History"}),d.jsx("ul",{className:F.setsHistoryBox,"data-testid":"sets-history-list",children:n.map(r=>d.jsx("li",{className:F.setsByDate,"data-testid":"set-history-item",children:d.jsxs("ul",{className:F.sets,children:[d.jsx("div",{className:F.setsDate,children:d.jsx("b",{children:r.date})}),r.sets.map((s,i)=>d.jsx("li",{className:F.set,children:d.jsxs("div",{className:F.setPreview,children:[d.jsxs("div",{className:F.setUnit,children:[d.jsxs("b",{children:["â„–",i+1]})," ",s.repetitions,"x",s.weight,"kg"]}),d.jsx("div",{className:F.setTime,children:s.time})]})},s.id))]})},r.date))})]})})}render(){const{exercise:n,setsHistory:r}=this.props,s=!!n.sets.length,i=!!r.length;return d.jsx(ve,{topBar:this.renderTopBar(),bottomBar:this.renderBottomBar(),dataTestId:"existing-exercise-screen",children:d.jsxs("div",{className:F.screen,children:[s&&this.renderSets(),i&&this.renderSetsHistory()]})})}};const Tl=V({controller:vr},e=>({training:e.getTraining(),exercise:e.getExercise(),setsHistory:e.getSetsHistory(),isInProgress:e.isInProgress(),getCurrentExercise:e.getCurrentExerciseIntoNavbar,getTotalExercises:e.getTotalExercisesIntoNavbar,onChangeRepetitions:e.onChangeRepetitions,onChangeWeight:e.onChangeWeight,onDoneSet:e.onDoneSet,onResetDoneSet:e.onResetDoneSet,onExerciseNext:e.onExerciseNext,onExercisePrev:e.onExercisePrev,onNoData:e.onNoData,onBack:e.onBack}))(We(e=>({isData:!!e.exercise,onNoData:e.onNoData}))(Sl)),mr=e=>{const{getStoreData:t}=e.getStore(),{trainingsApi:n,navigationApi:r}=e.getAPIs(),s=()=>t(mr.storeDataAccessors),i=()=>r.getPathParams(r.routes.editNewExercise);return{getExercise:()=>{var c;const a=i().exercise;return(c=s().newTraining)==null?void 0:c.exercises.find(l=>l.id===a)},onNoData:()=>{r.toTrainings()},onChangeName:(a,o)=>{const{exercises:c}=s().newTraining;n.update.newTraining({exercises:c.map(l=>l.id===a?{...l,name:o}:l)})},onChangeRepetitions:(a,o,c)=>{const{exercises:l}=s().newTraining,{sets:u}=a;n.update.newTraining({exercises:l.map(g=>g.id===a.id?{...g,sets:u.map(h=>h.id===o?{...h,repetitions:Oe(c)}:h)}:g)})},onChangeWeight:(a,o,c)=>{const{exercises:l}=s().newTraining,{sets:u}=a;n.update.newTraining({exercises:l.map(g=>g.id===a.id?{...g,sets:u.map(h=>h.id===o?{...h,weight:Oe(c)}:h)}:g)})},onAddSet:()=>{const a=i().training,o=i().exercise;a&&o&&n.create.set(a,o)},onDeleteSet:(a,o)=>{const c=i().training;c&&n.delete.set(c,a,o)},onDelete:async()=>{const a=i().training,o=i().exercise;a&&o&&n.delete.exercise(a,o),await r.goBack({replace:!0})},onSave:async()=>{await r.goBack({replace:!0})}}};mr.storeDataAccessors=["newTraining"];class El extends j.Component{constructor(){super(...arguments);I(this,"_onChangeName",n=>{const r=this.props.data.id;this.props.onChangeName(r,n)});I(this,"_onDeleteSet",n=>{const r=this.props.data.id;this.props.onDeleteSet(r,n)});I(this,"_onChangeRepetitions",(n,r)=>{const s=this.props.data;this.props.onChangeRepetitions(s,n,r)});I(this,"_onChangeWeight",(n,r)=>{const s=this.props.data;this.props.onChangeWeight(s,n,r)})}render(){const{data:n,onAddSet:r,onDelete:s,onSave:i}=this.props;return d.jsx(Or,{dataTestId:"edit-new-exercise-screen",data:n,onChangeName:this._onChangeName,onDeleteSet:this._onDeleteSet,onChangeRepetitions:this._onChangeRepetitions,onChangeWeight:this._onChangeWeight,onAddSet:r,onDelete:s,onSave:i})}}const Cl=V({controller:mr},e=>({data:e.getExercise(),onNoData:e.onNoData,onChangeName:e.onChangeName,onChangeWeight:e.onChangeWeight,onChangeRepetitions:e.onChangeRepetitions,onAddSet:e.onAddSet,onDeleteSet:e.onDeleteSet,onDelete:e.onDelete,onSave:e.onSave}))(We(e=>({isData:!!e.data,onNoData:e.onNoData}))(El)),xr=e=>{const{getStoreData:t}=e.getStore(),{trainingsApi:n,navigationApi:r}=e.getAPIs(),s=()=>t(xr.storeDataAccessors),i=()=>r.getPathParams(r.routes.editExistingExercise);return{getExercise:()=>{const a=i(),c=s().trainings.find(u=>u.id===a.training);return c==null?void 0:c.exercises.find(u=>u.id===a.exercise)},onNoData:()=>{r.toTrainings()},onChangeName:(a,o)=>{const c=i(),u=s().trainings.find(g=>g.id===c.training);if(u){const g=u.exercises.map(h=>h.id===a?{...h,name:o}:h);n.update.training(u.id,{exercises:g})}},onChangeRepetitions:(a,o,c)=>{const l=i(),g=s().trainings.find(h=>h.id===l.training);if(g){const h=g.exercises.map(p=>p.id===a.id?{...p,sets:p.sets.map(m=>m.id===o?{...m,repetitions:Oe(c)}:m)}:p);n.update.training(g.id,{exercises:h})}},onChangeWeight:(a,o,c)=>{const l=i(),g=s().trainings.find(h=>h.id===l.training);if(g){const h=g.exercises.map(p=>p.id===a.id?{...p,sets:p.sets.map(m=>m.id===o?{...m,weight:Oe(c)}:m)}:p);n.update.training(g.id,{exercises:h})}},onAddSet:()=>{const a=i(),c=s().trainings.find(u=>u.id===a.training),l=c==null?void 0:c.exercises.find(u=>u.id===a.exercise);c&&l&&n.create.set(c.id,l.id)},onDeleteSet:(a,o)=>{const c=i(),u=s().trainings.find(g=>g.id===c.training);u&&n.delete.set(u.id,a,o)},onDelete:async()=>{const a=i(),c=s().trainings.find(u=>u.id===a.training),l=c==null?void 0:c.exercises.find(u=>u.id===a.exercise);await r.goBack({replace:!0}),c&&l&&n.delete.exercise(c.id,l.id)},onSave:async()=>{await r.goBack({replace:!0})}}};xr.storeDataAccessors=["trainings"];class Dl extends j.Component{constructor(){super(...arguments);I(this,"_onChangeName",n=>{const r=this.props.data.id;this.props.onChangeName(r,n)});I(this,"_onDeleteSet",n=>{const r=this.props.data.id;this.props.onDeleteSet(r,n)});I(this,"_onChangeRepetitions",(n,r)=>{const s=this.props.data;this.props.onChangeRepetitions(s,n,r)});I(this,"_onChangeWeight",(n,r)=>{const s=this.props.data;this.props.onChangeWeight(s,n,r)})}render(){const{data:n,onAddSet:r,onDelete:s,onSave:i}=this.props;return d.jsx(Or,{dataTestId:"edit-existing-exercise-screen",data:n,onChangeName:this._onChangeName,onDeleteSet:this._onDeleteSet,onChangeRepetitions:this._onChangeRepetitions,onChangeWeight:this._onChangeWeight,onAddSet:r,onDelete:s,onSave:i})}}const Al=V({controller:xr},e=>({data:e.getExercise(),onNoData:e.onNoData,onChangeName:e.onChangeName,onChangeWeight:e.onChangeWeight,onChangeRepetitions:e.onChangeRepetitions,onAddSet:e.onAddSet,onDeleteSet:e.onDeleteSet,onDelete:e.onDelete,onSave:e.onSave}))(We(e=>({isData:!!e.data,onNoData:e.onNoData}))(Dl)),yr=e=>{const{getStoreData:t}=e.getStore(),{navigationApi:n,trainingsApi:r}=e.getAPIs(),s=()=>t(yr.storeDataAccessors),i=()=>n.getPathParams(n.routes.editTraining),a=()=>{const o=i();return s().trainings.find(u=>u.id===o.training)};return{getTraining:()=>a(),onSave:async()=>{const o=a();o?await n.toTraining(o.id):await n.toTrainings()},onNoData:()=>{n.toTrainings()},onChangeName:o=>{const c=a();c&&r.update.training(c.id,{name:o})},onAddExercise:async()=>{var l;const o=i();r.create.newExercise();const c=(l=s().newExercise)==null?void 0:l.id;o.training&&c&&await n.toCreateExercise(o.training,c,{goBackTo:n.routes.editTraining})},onDeleteExercise:(o,c)=>{r.delete.exercise(o,c)},onEditExercise:async o=>{const c=i();c.training&&await n.toEditExistingExercise(c.training,o)},onDelete:async()=>{const o=i();await n.toTrainings(),o.training&&r.delete.training(o.training)},onReorderExercises:(o,c)=>{r.update.exercisesOrder(o,c)}}};yr.storeDataAccessors=["trainings","newExercise"];const $l=e=>{const{data:t,onChangeName:n,onAddExercise:r,onDelete:s,onSave:i,onDeleteExercise:a,onEditExercise:o,onReorderExercises:c}=e;return d.jsx(ea,{dataTestId:"edit-existing-training-screen",id:t.id,name:t.name,exercises:t.exercises,onChangeName:n,onAddExercise:r,onDelete:s,onSave:i,onDeleteExercise:a,onOpenExercise:o,onReorderExercises:c})},Nl=V({controller:yr},e=>({data:e.getTraining(),onSave:e.onSave,onDelete:e.onDelete,onNoData:e.onNoData,onChangeName:e.onChangeName,onAddExercise:e.onAddExercise,onDeleteExercise:e.onDeleteExercise,onEditExercise:e.onEditExercise,onReorderExercises:e.onReorderExercises}))(We(e=>({isData:!!e.data,onNoData:e.onNoData}))($l)),br=e=>{const t=e.getStore(),{navigationApi:n}=e.getAPIs(),r=()=>t.getStoreData(br.storeDataAccessors);return{isAuthenticated:()=>r().auth.isAuthenticated,navigate:async()=>{await n.goBack({replace:!0})}}};br.storeDataAccessors=["auth"];const jl=e=>{const{isAuthenticated:t,navigate:n}=e;return f.useEffect(()=>{t||n()},[t,n]),t?d.jsx(_i,{}):null},Rl=V({controller:br},e=>({isAuthenticated:e.isAuthenticated(),navigate:e.navigate}))(jl);function Il(e){const t=new Date(e);return Number.isNaN(t.getTime())?e.slice(0,10):t.toISOString().slice(0,10)}const Kn=e=>{const t=new Map;return e.forEach(n=>{const r=Il(n.timestamptz);t.has(r)||t.set(r,{dateISO:r,totalVolumeKg:0,totalReps:0,sessionsCount:0});const s=t.get(r);s.sessionsCount+=1,n.exercises.forEach(i=>{i.sets.forEach(a=>{const o=typeof a.weight=="number"?a.weight:0,c=typeof a.repetitions=="number"?a.repetitions:0;s.totalVolumeKg+=o*c,s.totalReps+=c})})}),Array.from(t.values()).sort((n,r)=>n.dateISO<r.dateISO?-1:1)},xs=(e,t=7)=>{if(t<=0)return[];const n=new Map(e.map(i=>[i.dateISO,i])),r=24*60*60*1e3,s=[];for(let i=0;i<t;i+=1){const a=t-1-i,c=new Date(Date.now()-a*r).toISOString().slice(0,10),l=n.get(c);l?s.push(l):s.push({dateISO:c,totalVolumeKg:0,totalReps:0,sessionsCount:0})}return s},wr=e=>{const t=e.getStore(),n=()=>t.getStoreData(wr.storeDataAccessors);return{getAggregates:()=>{const r=n().completedTrainings||[];return Kn(r)}}};wr.storeDataAccessors=["completedTrainings"];const Pl=({aggregates:e})=>d.jsx(ve,{bottomBar:d.jsx(st,{}),dataTestId:"dashboard-screen",children:d.jsxs("div",{style:{padding:12},children:[d.jsx("h2",{children:"Progress dashboard"}),d.jsxs("section",{style:{marginTop:12},children:[d.jsx("h3",{children:"Volume trend (last 30 days)"}),d.jsx("div",{style:{height:240},children:d.jsx(nr,{data:e.slice(-30),variant:"detailed",height:240})})]}),d.jsxs("section",{style:{marginTop:12},children:[d.jsx("h3",{children:"Sessions (last 30 days)"}),d.jsx("div",{style:{height:160},children:d.jsx(nr,{data:e.slice(-30),variant:"bar",height:160})})]})]})}),kl=V({controller:wr},e=>({aggregates:e.getAggregates()}))(Pl),Ol="_app_f3a00_18",Bl="_releaseVersion_f3a00_22",ys={app:Ol,releaseVersion:Bl},Ll=()=>d.jsx(_i,{}),Ml=()=>d.jsx(Lo,{}),Fl=()=>d.jsx(kl,{}),zl=()=>d.jsx(Rl,{}),Hl=()=>d.jsx(nc,{}),Ul=()=>d.jsx(Xo,{}),Wl=()=>d.jsx(sl,{}),Gl=()=>d.jsx(Nl,{}),ql=()=>d.jsx(ic,{}),Vl=()=>d.jsx(Tl,{}),Kl=()=>d.jsx(Al,{}),Xl=()=>d.jsx(Cl,{}),Yl=()=>d.jsx(Vc,{});class Zl extends j.Component{constructor(n){super(n);I(this,"apis");I(this,"appContext");const{apis:r,appContext:s}=n;this.apis=r,this.appContext=s}componentDidMount(){const n={DEFAULT_NOT_FOUND:rc,__root__:Ll,"/":Ml,"/dashboard":Fl,"/pathless_auth":zl,"/menu":Hl,"/trainings":void 0,"/trainings/":Ul,"/trainings/$training":void 0,"/trainings/$training/":Wl,"/trainings/$training/edit":Gl,"/trainings/$training/new":ql,"/trainings/$training/$exercise":void 0,"/trainings/$training/$exercise/":Vl,"/trainings/$training/$exercise/edit":Kl,"/trainings/$training/$exercise/editNew":Xl,"/trainings/$training/$exercise/new-exercise":Yl};this.apis.navigationApi.setRouterConfiguration({routePathsToComponents:n})}render(){return d.jsx(Ei.Provider,{value:this.appContext,children:d.jsxs(Xa,{children:[d.jsxs("div",{className:ys.releaseVersion,children:["v","1.0.43"]}),d.jsxs("div",{className:ys.app,children:[d.jsx(ly,{}),d.jsx(fy,{}),d.jsx(lo,{position:"bottom-right",router:this.apis.navigationApi.__router}),d.jsx(Ga,{router:this.apis.navigationApi.__router})]})]})})}}const Jl="_navbar_my6yz_1",Ql={navbar:Jl},it=({className:e,children:t})=>d.jsx("div",{className:ae(Ql.navbar,e),children:t}),ed=e=>f.createElement("svg",{width:"30px",height:"30px",viewBox:"0 0 384.97 384.97",xmlns:"http://www.w3.org/2000/svg",...e},f.createElement("path",{d:"M12.03,84.212h360.909c6.641,0,12.03-5.39,12.03-12.03c0-6.641-5.39-12.03-12.03-12.03H12.03     C5.39,60.152,0,65.541,0,72.182C0,78.823,5.39,84.212,12.03,84.212z"}),f.createElement("path",{d:"M372.939,180.455H12.03c-6.641,0-12.03,5.39-12.03,12.03s5.39,12.03,12.03,12.03h360.909c6.641,0,12.03-5.39,12.03-12.03     S379.58,180.455,372.939,180.455z"}),f.createElement("path",{d:"M372.939,300.758H12.03c-6.641,0-12.03,5.39-12.03,12.03c0,6.641,5.39,12.03,12.03,12.03h360.909     c6.641,0,12.03-5.39,12.03-12.03C384.97,306.147,379.58,300.758,372.939,300.758z"})),td=e=>f.createElement("svg",{width:"30px",height:"30px",viewBox:"0 0 488 488",xmlns:"http://www.w3.org/2000/svg",...e},f.createElement("path",{d:"M451.522,182.475l33.579-32.914c1.699-1.701,2.798-4.302,2.798-6.903l0,0c0-2.701-0.999-5.202-2.898-7.103l-33.979-34.014 l33.979-33.314c1.899-1.901,2.998-4.402,2.998-7.103s-0.999-5.202-2.898-7.103L434.033,2.901C432.134,1,429.636,0,426.938,0 c-2.698,0-5.197,1.1-7.096,3.001l-33.28,34.014L352.583,3.001C350.685,1.1,348.086,0.1,345.488,0.1 c-2.698,0-5.197,1.1-7.096,3.001l-32.88,33.614L271.933,3.101c-3.898-3.902-10.194-3.902-14.091,0l-51.069,51.121 c-1.899,1.901-2.898,4.402-2.898,7.103s1.099,5.202,2.898,7.103l74.454,74.531L143.012,281.315l-74.454-74.531 c-1.899-1.901-4.397-2.901-7.096-2.901c-2.698,0-5.197,1.1-7.096,2.901L3.098,257.505c-3.898,3.902-3.898,10.204,0,14.106 l33.579,33.614L2.998,338.038C1.099,339.939,0,342.44,0,345.141s0.999,5.202,2.898,7.103l34.179,34.214L3.098,419.772 c-1.899,1.901-2.998,4.402-2.998,7.103s0.999,5.202,2.898,7.103l51.069,51.121C55.966,487,58.464,488,61.163,488 c2.698,0,5.197-1.1,7.096-3.001l33.28-34.014l33.879,33.914c1.899,1.901,4.397,2.901,7.096,2.901s5.197-1.1,7.096-3.001 l33.08-33.514l33.679,33.714c1.999,2.001,4.497,2.901,7.096,2.901c2.598,0,5.097-1,7.096-2.901l51.069-51.121 c3.898-3.902,3.898-10.204,0-14.106l-74.454-74.531l138.215-138.357l74.454,74.531c1.999,2.001,4.497,2.901,7.096,2.901 s5.097-1,7.096-2.901l51.069-51.121c1.899-1.901,2.898-4.402,2.898-7.103s-1.099-5.202-2.898-7.103L451.522,182.475z M426.938,24.11l36.777,36.815l-26.883,26.411l-18.089-18.107l-18.089-18.107L426.938,24.11z M345.388,24.11l118.327,118.349 l-26.484,26.111v0L319.404,50.621L345.388,24.11z M61.163,463.89l-36.777-36.815l26.883-26.411l36.278,36.315L61.163,463.89z M142.512,463.79l-33.879-33.914l-50.269-50.321l-34.079-34.114l26.584-25.911l58.864,58.924l58.964,59.024L142.512,463.79z M260.34,427.075l-36.877,36.915l-33.679-33.714L57.964,298.322l-33.679-33.714l36.877-36.915L260.34,427.075z M192.981,331.236 l-36.178-36.215l138.215-138.357l36.178,36.215L192.981,331.236z M426.838,260.307L426.838,260.307l-82.849-82.934l-41.874-41.917 L227.66,60.925l36.877-36.915l33.679,33.714l131.819,131.954l33.679,33.714L426.838,260.307z"})),_r=e=>{const{navigationApi:t}=e.getAPIs();return{onHomeClick:()=>{t.toHome()},onTrainingsClick:()=>{t.toTrainings()},onBurgerClick:()=>{t.toMenu()},isHomeActive:()=>t.isHomeUrl(),isTrainingsActive:()=>t.isTrainingsUrl(),isBurgerActive:()=>t.isMenuUrl(),storeDataAccessors:_r.storeDataAccessors}};_r.storeDataAccessors=[];const nd="_button_1nsyn_1",rd="_nunito_1nsyn_12",sd="_indieFlower_1nsyn_16",id="_zeroStyle_1nsyn_22",ad="_primary_1nsyn_26",od="_icon_1nsyn_35",cd="_text_1nsyn_43",ld="_disabled_1nsyn_48",dd="_small_1nsyn_59",ud="_medium_1nsyn_63",gd="_large_1nsyn_67",hd="_xLarge_1nsyn_71",se={button:nd,nunito:rd,indieFlower:sd,zeroStyle:id,primary:ad,icon:od,text:cd,disabled:ld,small:dd,medium:ud,large:gd,xLarge:hd},pd=uo(),k=({skin:e,font:t,size:n,className:r,children:s,disabled:i,onClick:a,...o})=>{const c={[se.zeroStyle]:e==="zero-style",[se.primary]:e==="primary",[se.icon]:e==="icon",[se.text]:e==="text"},l={[se.nunito]:t==="nunito",[se.indieFlower]:t==="indieFlower"},u={[se.small]:n==="small",[se.medium]:n==="medium",[se.large]:n==="large",[se.xLarge]:n==="xLarge"},g=pd?vd:fd;return d.jsx(g,{type:"button",...o,onClick:i?void 0:a,disabled:i,className:ae(r,se.button,c,l,u,{[se.disabled]:i}),children:s})},fd=e=>d.jsx("button",{...e}),vd=({onClick:e,children:t,style:n,...r})=>{const s=j.useRef(!1),i=()=>{s.current=!0},a=()=>{s.current=!1},o=c=>{s.current||e(c)};return d.jsx("button",{...r,onPointerDown:a,onPointerMove:i,onPointerUp:o,style:{...n,touchAction:"pan-y"},children:t})},md="_active_1ncra_1",xd="_activeBurger_1ncra_5",yd="_burger_1ncra_9",bd="_animationBurger_1ncra_15",Et={active:md,activeBurger:xd,burger:yd,animationBurger:bd};class wd extends j.Component{render(){const{onHomeClick:t,onTrainingsClick:n,onBurgerClick:r,isHomeActive:s,isTrainingsActive:i,isBurgerActive:a}=this.props;return d.jsxs(it,{children:[d.jsx(k,{skin:"text",font:"indieFlower",size:"large",className:ae({[Et.active]:s}),onClick:t,"data-testid":"nav-home-button",children:"Home"}),d.jsx(k,{skin:"text",font:"indieFlower",size:"large",className:ae({[Et.active]:i}),onClick:n,"data-testid":"nav-trainings-button",children:"Trainings"}),d.jsxs(k,{skin:"icon",size:"large",className:ae(Et.burger,{[Et.activeBurger]:a,[Et.animationBurger]:a}),onClick:r,"data-testid":"nav-burger-button",children:[d.jsx(ed,{}),d.jsx(td,{})]})]})}}const st=V({controller:_r},e=>({onHomeClick:e.onHomeClick,onTrainingsClick:e.onTrainingsClick,onBurgerClick:e.onBurgerClick,isHomeActive:e.isHomeActive(),isTrainingsActive:e.isTrainingsActive(),isBurgerActive:e.isBurgerActive()}))(wd),_d="_layout_11hts_1",Sd="_layoutTop_11hts_10",Td="_layoutBottom_11hts_11",Ed="_layoutCenter_11hts_15",Cd="_layoutContent_11hts_21",Ct={layout:_d,layoutTop:Sd,layoutBottom:Td,layoutCenter:Ed,layoutContent:Cd},ve=e=>{const{topBar:t,bottomBar:n,children:r,dataTestId:s}=e;return d.jsxs("div",{className:Ct.layout,"data-testid":s,children:[t&&d.jsx("div",{className:Ct.layoutTop,children:t}),d.jsx("div",{className:Ct.layoutCenter,children:d.jsx("div",{className:Ct.layoutContent,children:r})}),n&&d.jsx("div",{className:Ct.layoutBottom,children:n})]})},Dd="_input_11miz_1",Ad={input:Dd},Rt=({value:e,onChange:t,onBlur:n,className:r,...s})=>{const[i,a]=j.useState(e),o=f.useCallback(l=>{const u=l.target.value;a(u),t==null||t(u,l)},[t]),c=f.useCallback(l=>{n==null||n(String(i),l)},[i,n]);return d.jsx("input",{...s,value:i,onChange:o,onBlur:c,className:ae(Ad.input,r)})};var $d=Lt,Nd=Ot,jd="[object AsyncFunction]",Rd="[object Function]",Id="[object GeneratorFunction]",Pd="[object Proxy]";function kd(e){if(!Nd(e))return!1;var t=$d(e);return t==Rd||t==Id||t==jd||t==Pd}var Ni=kd,Od=Ce,Bd=Od["__core-js_shared__"],Ld=Bd,Bn=Ld,bs=function(){var e=/[^.]+$/.exec(Bn&&Bn.keys&&Bn.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function Md(e){return!!bs&&bs in e}var Fd=Md,zd=Function.prototype,Hd=zd.toString;function Ud(e){if(e!=null){try{return Hd.call(e)}catch{}try{return e+""}catch{}}return""}var ji=Ud,Wd=Ni,Gd=Fd,qd=Ot,Vd=ji,Kd=/[\\^$.*+?()[\]{}|]/g,Xd=/^\[object .+?Constructor\]$/,Yd=Function.prototype,Zd=Object.prototype,Jd=Yd.toString,Qd=Zd.hasOwnProperty,eu=RegExp("^"+Jd.call(Qd).replace(Kd,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function tu(e){if(!qd(e)||Gd(e))return!1;var t=Wd(e)?eu:Xd;return t.test(Vd(e))}var nu=tu;function ru(e,t){return e==null?void 0:e[t]}var su=ru,iu=nu,au=su;function ou(e,t){var n=au(e,t);return iu(n)?n:void 0}var Ge=ou,cu=Ge,lu=function(){try{var e=cu(Object,"defineProperty");return e({},"",{}),e}catch{}}(),Ri=lu,ws=Ri;function du(e,t,n){t=="__proto__"&&ws?ws(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}var uu=du;function gu(e,t,n,r){for(var s=-1,i=e==null?0:e.length;++s<i;){var a=e[s];t(r,a,n(a),e)}return r}var hu=gu;function pu(e){return function(t,n,r){for(var s=-1,i=Object(t),a=r(t),o=a.length;o--;){var c=a[e?o:++s];if(n(i[c],c,i)===!1)break}return t}}var fu=pu,vu=fu,mu=vu(),xu=mu;function yu(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}var bu=yu,wu=Lt,_u=Mt,Su="[object Arguments]";function Tu(e){return _u(e)&&wu(e)==Su}var Eu=Tu,_s=Eu,Cu=Mt,Ii=Object.prototype,Du=Ii.hasOwnProperty,Au=Ii.propertyIsEnumerable,$u=_s(function(){return arguments}())?_s:function(e){return Cu(e)&&Du.call(e,"callee")&&!Au.call(e,"callee")},Sr=$u,Nu=Array.isArray,le=Nu,ln={exports:{}};function ju(){return!1}var Ru=ju;ln.exports;(function(e,t){var n=Ce,r=Ru,s=t&&!t.nodeType&&t,i=s&&!0&&e&&!e.nodeType&&e,a=i&&i.exports===s,o=a?n.Buffer:void 0,c=o?o.isBuffer:void 0,l=c||r;e.exports=l})(ln,ln.exports);var Pi=ln.exports,Iu=9007199254740991,Pu=/^(?:0|[1-9]\d*)$/;function ku(e,t){var n=typeof e;return t=t??Iu,!!t&&(n=="number"||n!="symbol"&&Pu.test(e))&&e>-1&&e%1==0&&e<t}var Tr=ku,Ou=9007199254740991;function Bu(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Ou}var Er=Bu,Lu=Lt,Mu=Er,Fu=Mt,zu="[object Arguments]",Hu="[object Array]",Uu="[object Boolean]",Wu="[object Date]",Gu="[object Error]",qu="[object Function]",Vu="[object Map]",Ku="[object Number]",Xu="[object Object]",Yu="[object RegExp]",Zu="[object Set]",Ju="[object String]",Qu="[object WeakMap]",eg="[object ArrayBuffer]",tg="[object DataView]",ng="[object Float32Array]",rg="[object Float64Array]",sg="[object Int8Array]",ig="[object Int16Array]",ag="[object Int32Array]",og="[object Uint8Array]",cg="[object Uint8ClampedArray]",lg="[object Uint16Array]",dg="[object Uint32Array]",M={};M[ng]=M[rg]=M[sg]=M[ig]=M[ag]=M[og]=M[cg]=M[lg]=M[dg]=!0;M[zu]=M[Hu]=M[eg]=M[Uu]=M[tg]=M[Wu]=M[Gu]=M[qu]=M[Vu]=M[Ku]=M[Xu]=M[Yu]=M[Zu]=M[Ju]=M[Qu]=!1;function ug(e){return Fu(e)&&Mu(e.length)&&!!M[Lu(e)]}var gg=ug;function hg(e){return function(t){return e(t)}}var ki=hg,dn={exports:{}};dn.exports;(function(e,t){var n=Di,r=t&&!t.nodeType&&t,s=r&&!0&&e&&!e.nodeType&&e,i=s&&s.exports===r,a=i&&n.process,o=function(){try{var c=s&&s.require&&s.require("util").types;return c||a&&a.binding&&a.binding("util")}catch{}}();e.exports=o})(dn,dn.exports);var pg=dn.exports,fg=gg,vg=ki,Ss=pg,Ts=Ss&&Ss.isTypedArray,mg=Ts?vg(Ts):fg,Oi=mg,xg=bu,yg=Sr,bg=le,wg=Pi,_g=Tr,Sg=Oi,Tg=Object.prototype,Eg=Tg.hasOwnProperty;function Cg(e,t){var n=bg(e),r=!n&&yg(e),s=!n&&!r&&wg(e),i=!n&&!r&&!s&&Sg(e),a=n||r||s||i,o=a?xg(e.length,String):[],c=o.length;for(var l in e)(t||Eg.call(e,l))&&!(a&&(l=="length"||s&&(l=="offset"||l=="parent")||i&&(l=="buffer"||l=="byteLength"||l=="byteOffset")||_g(l,c)))&&o.push(l);return o}var Dg=Cg,Ag=Object.prototype;function $g(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||Ag;return e===n}var Ng=$g;function jg(e,t){return function(n){return e(t(n))}}var Rg=jg,Ig=Rg,Pg=Ig(Object.keys,Object),kg=Pg,Og=Ng,Bg=kg,Lg=Object.prototype,Mg=Lg.hasOwnProperty;function Fg(e){if(!Og(e))return Bg(e);var t=[];for(var n in Object(e))Mg.call(e,n)&&n!="constructor"&&t.push(n);return t}var zg=Fg,Hg=Ni,Ug=Er;function Wg(e){return e!=null&&Ug(e.length)&&!Hg(e)}var xn=Wg,Gg=Dg,qg=zg,Vg=xn;function Kg(e){return Vg(e)?Gg(e):qg(e)}var Cr=Kg,Xg=xu,Yg=Cr;function Zg(e,t){return e&&Xg(e,t,Yg)}var Jg=Zg,Qg=xn;function eh(e,t){return function(n,r){if(n==null)return n;if(!Qg(n))return e(n,r);for(var s=n.length,i=t?s:-1,a=Object(n);(t?i--:++i<s)&&r(a[i],i,a)!==!1;);return n}}var th=eh,nh=Jg,rh=th,sh=rh(nh),Bi=sh,ih=Bi;function ah(e,t,n,r){return ih(e,function(s,i,a){t(r,s,n(s),a)}),r}var oh=ah;function ch(){this.__data__=[],this.size=0}var lh=ch;function dh(e,t){return e===t||e!==e&&t!==t}var Dr=dh,uh=Dr;function gh(e,t){for(var n=e.length;n--;)if(uh(e[n][0],t))return n;return-1}var yn=gh,hh=yn,ph=Array.prototype,fh=ph.splice;function vh(e){var t=this.__data__,n=hh(t,e);if(n<0)return!1;var r=t.length-1;return n==r?t.pop():fh.call(t,n,1),--this.size,!0}var mh=vh,xh=yn;function yh(e){var t=this.__data__,n=xh(t,e);return n<0?void 0:t[n][1]}var bh=yh,wh=yn;function _h(e){return wh(this.__data__,e)>-1}var Sh=_h,Th=yn;function Eh(e,t){var n=this.__data__,r=Th(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this}var Ch=Eh,Dh=lh,Ah=mh,$h=bh,Nh=Sh,jh=Ch;function at(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}at.prototype.clear=Dh;at.prototype.delete=Ah;at.prototype.get=$h;at.prototype.has=Nh;at.prototype.set=jh;var bn=at,Rh=bn;function Ih(){this.__data__=new Rh,this.size=0}var Ph=Ih;function kh(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}var Oh=kh;function Bh(e){return this.__data__.get(e)}var Lh=Bh;function Mh(e){return this.__data__.has(e)}var Fh=Mh,zh=Ge,Hh=Ce,Uh=zh(Hh,"Map"),Ar=Uh,Wh=Ge,Gh=Wh(Object,"create"),wn=Gh,Es=wn;function qh(){this.__data__=Es?Es(null):{},this.size=0}var Vh=qh;function Kh(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var Xh=Kh,Yh=wn,Zh="__lodash_hash_undefined__",Jh=Object.prototype,Qh=Jh.hasOwnProperty;function ep(e){var t=this.__data__;if(Yh){var n=t[e];return n===Zh?void 0:n}return Qh.call(t,e)?t[e]:void 0}var tp=ep,np=wn,rp=Object.prototype,sp=rp.hasOwnProperty;function ip(e){var t=this.__data__;return np?t[e]!==void 0:sp.call(t,e)}var ap=ip,op=wn,cp="__lodash_hash_undefined__";function lp(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=op&&t===void 0?cp:t,this}var dp=lp,up=Vh,gp=Xh,hp=tp,pp=ap,fp=dp;function ot(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}ot.prototype.clear=up;ot.prototype.delete=gp;ot.prototype.get=hp;ot.prototype.has=pp;ot.prototype.set=fp;var vp=ot,Cs=vp,mp=bn,xp=Ar;function yp(){this.size=0,this.__data__={hash:new Cs,map:new(xp||mp),string:new Cs}}var bp=yp;function wp(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var _p=wp,Sp=_p;function Tp(e,t){var n=e.__data__;return Sp(t)?n[typeof t=="string"?"string":"hash"]:n.map}var _n=Tp,Ep=_n;function Cp(e){var t=Ep(this,e).delete(e);return this.size-=t?1:0,t}var Dp=Cp,Ap=_n;function $p(e){return Ap(this,e).get(e)}var Np=$p,jp=_n;function Rp(e){return jp(this,e).has(e)}var Ip=Rp,Pp=_n;function kp(e,t){var n=Pp(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this}var Op=kp,Bp=bp,Lp=Dp,Mp=Np,Fp=Ip,zp=Op;function ct(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}ct.prototype.clear=Bp;ct.prototype.delete=Lp;ct.prototype.get=Mp;ct.prototype.has=Fp;ct.prototype.set=zp;var $r=ct,Hp=bn,Up=Ar,Wp=$r,Gp=200;function qp(e,t){var n=this.__data__;if(n instanceof Hp){var r=n.__data__;if(!Up||r.length<Gp-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new Wp(r)}return n.set(e,t),this.size=n.size,this}var Vp=qp,Kp=bn,Xp=Ph,Yp=Oh,Zp=Lh,Jp=Fh,Qp=Vp;function lt(e){var t=this.__data__=new Kp(e);this.size=t.size}lt.prototype.clear=Xp;lt.prototype.delete=Yp;lt.prototype.get=Zp;lt.prototype.has=Jp;lt.prototype.set=Qp;var Li=lt,ef="__lodash_hash_undefined__";function tf(e){return this.__data__.set(e,ef),this}var nf=tf;function rf(e){return this.__data__.has(e)}var sf=rf,af=$r,of=nf,cf=sf;function un(e){var t=-1,n=e==null?0:e.length;for(this.__data__=new af;++t<n;)this.add(e[t])}un.prototype.add=un.prototype.push=of;un.prototype.has=cf;var lf=un;function df(e,t){for(var n=-1,r=e==null?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}var uf=df;function gf(e,t){return e.has(t)}var hf=gf,pf=lf,ff=uf,vf=hf,mf=1,xf=2;function yf(e,t,n,r,s,i){var a=n&mf,o=e.length,c=t.length;if(o!=c&&!(a&&c>o))return!1;var l=i.get(e),u=i.get(t);if(l&&u)return l==t&&u==e;var g=-1,h=!0,p=n&xf?new pf:void 0;for(i.set(e,t),i.set(t,e);++g<o;){var m=e[g],y=t[g];if(r)var b=a?r(y,m,g,t,e,i):r(m,y,g,e,t,i);if(b!==void 0){if(b)continue;h=!1;break}if(p){if(!ff(t,function(S,A){if(!vf(p,A)&&(m===S||s(m,S,n,r,i)))return p.push(A)})){h=!1;break}}else if(!(m===y||s(m,y,n,r,i))){h=!1;break}}return i.delete(e),i.delete(t),h}var Mi=yf,bf=Ce,wf=bf.Uint8Array,_f=wf;function Sf(e){var t=-1,n=Array(e.size);return e.forEach(function(r,s){n[++t]=[s,r]}),n}var Tf=Sf;function Ef(e){var t=-1,n=Array(e.size);return e.forEach(function(r){n[++t]=r}),n}var Cf=Ef,Ds=Bt,As=_f,Df=Dr,Af=Mi,$f=Tf,Nf=Cf,jf=1,Rf=2,If="[object Boolean]",Pf="[object Date]",kf="[object Error]",Of="[object Map]",Bf="[object Number]",Lf="[object RegExp]",Mf="[object Set]",Ff="[object String]",zf="[object Symbol]",Hf="[object ArrayBuffer]",Uf="[object DataView]",$s=Ds?Ds.prototype:void 0,Ln=$s?$s.valueOf:void 0;function Wf(e,t,n,r,s,i,a){switch(n){case Uf:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Hf:return!(e.byteLength!=t.byteLength||!i(new As(e),new As(t)));case If:case Pf:case Bf:return Df(+e,+t);case kf:return e.name==t.name&&e.message==t.message;case Lf:case Ff:return e==t+"";case Of:var o=$f;case Mf:var c=r&jf;if(o||(o=Nf),e.size!=t.size&&!c)return!1;var l=a.get(e);if(l)return l==t;r|=Rf,a.set(e,t);var u=Af(o(e),o(t),r,s,i,a);return a.delete(e),u;case zf:if(Ln)return Ln.call(e)==Ln.call(t)}return!1}var Gf=Wf;function qf(e,t){for(var n=-1,r=t.length,s=e.length;++n<r;)e[s+n]=t[n];return e}var Fi=qf,Vf=Fi,Kf=le;function Xf(e,t,n){var r=t(e);return Kf(e)?r:Vf(r,n(e))}var Yf=Xf;function Zf(e,t){for(var n=-1,r=e==null?0:e.length,s=0,i=[];++n<r;){var a=e[n];t(a,n,e)&&(i[s++]=a)}return i}var Jf=Zf;function Qf(){return[]}var ev=Qf,tv=Jf,nv=ev,rv=Object.prototype,sv=rv.propertyIsEnumerable,Ns=Object.getOwnPropertySymbols,iv=Ns?function(e){return e==null?[]:(e=Object(e),tv(Ns(e),function(t){return sv.call(e,t)}))}:nv,av=iv,ov=Yf,cv=av,lv=Cr;function dv(e){return ov(e,lv,cv)}var uv=dv,js=uv,gv=1,hv=Object.prototype,pv=hv.hasOwnProperty;function fv(e,t,n,r,s,i){var a=n&gv,o=js(e),c=o.length,l=js(t),u=l.length;if(c!=u&&!a)return!1;for(var g=c;g--;){var h=o[g];if(!(a?h in t:pv.call(t,h)))return!1}var p=i.get(e),m=i.get(t);if(p&&m)return p==t&&m==e;var y=!0;i.set(e,t),i.set(t,e);for(var b=a;++g<c;){h=o[g];var S=e[h],A=t[h];if(r)var C=a?r(A,S,h,t,e,i):r(S,A,h,e,t,i);if(!(C===void 0?S===A||s(S,A,n,r,i):C)){y=!1;break}b||(b=h=="constructor")}if(y&&!b){var _=e.constructor,D=t.constructor;_!=D&&"constructor"in e&&"constructor"in t&&!(typeof _=="function"&&_ instanceof _&&typeof D=="function"&&D instanceof D)&&(y=!1)}return i.delete(e),i.delete(t),y}var vv=fv,mv=Ge,xv=Ce,yv=mv(xv,"DataView"),bv=yv,wv=Ge,_v=Ce,Sv=wv(_v,"Promise"),Tv=Sv,Ev=Ge,Cv=Ce,Dv=Ev(Cv,"Set"),Av=Dv,$v=Ge,Nv=Ce,jv=$v(Nv,"WeakMap"),Rv=jv,Xn=bv,Yn=Ar,Zn=Tv,Jn=Av,Qn=Rv,zi=Lt,dt=ji,Rs="[object Map]",Iv="[object Object]",Is="[object Promise]",Ps="[object Set]",ks="[object WeakMap]",Os="[object DataView]",Pv=dt(Xn),kv=dt(Yn),Ov=dt(Zn),Bv=dt(Jn),Lv=dt(Qn),Le=zi;(Xn&&Le(new Xn(new ArrayBuffer(1)))!=Os||Yn&&Le(new Yn)!=Rs||Zn&&Le(Zn.resolve())!=Is||Jn&&Le(new Jn)!=Ps||Qn&&Le(new Qn)!=ks)&&(Le=function(e){var t=zi(e),n=t==Iv?e.constructor:void 0,r=n?dt(n):"";if(r)switch(r){case Pv:return Os;case kv:return Rs;case Ov:return Is;case Bv:return Ps;case Lv:return ks}return t});var Mv=Le,Mn=Li,Fv=Mi,zv=Gf,Hv=vv,Bs=Mv,Ls=le,Ms=Pi,Uv=Oi,Wv=1,Fs="[object Arguments]",zs="[object Array]",Yt="[object Object]",Gv=Object.prototype,Hs=Gv.hasOwnProperty;function qv(e,t,n,r,s,i){var a=Ls(e),o=Ls(t),c=a?zs:Bs(e),l=o?zs:Bs(t);c=c==Fs?Yt:c,l=l==Fs?Yt:l;var u=c==Yt,g=l==Yt,h=c==l;if(h&&Ms(e)){if(!Ms(t))return!1;a=!0,u=!1}if(h&&!u)return i||(i=new Mn),a||Uv(e)?Fv(e,t,n,r,s,i):zv(e,t,c,n,r,s,i);if(!(n&Wv)){var p=u&&Hs.call(e,"__wrapped__"),m=g&&Hs.call(t,"__wrapped__");if(p||m){var y=p?e.value():e,b=m?t.value():t;return i||(i=new Mn),s(y,b,n,r,i)}}return h?(i||(i=new Mn),Hv(e,t,n,r,s,i)):!1}var Vv=qv,Kv=Vv,Us=Mt;function Hi(e,t,n,r,s){return e===t?!0:e==null||t==null||!Us(e)&&!Us(t)?e!==e&&t!==t:Kv(e,t,n,r,Hi,s)}var Ui=Hi,Xv=Li,Yv=Ui,Zv=1,Jv=2;function Qv(e,t,n,r){var s=n.length,i=s,a=!r;if(e==null)return!i;for(e=Object(e);s--;){var o=n[s];if(a&&o[2]?o[1]!==e[o[0]]:!(o[0]in e))return!1}for(;++s<i;){o=n[s];var c=o[0],l=e[c],u=o[1];if(a&&o[2]){if(l===void 0&&!(c in e))return!1}else{var g=new Xv;if(r)var h=r(l,u,c,e,t,g);if(!(h===void 0?Yv(u,l,Zv|Jv,r,g):h))return!1}}return!0}var em=Qv,tm=Ot;function nm(e){return e===e&&!tm(e)}var Wi=nm,rm=Wi,sm=Cr;function im(e){for(var t=sm(e),n=t.length;n--;){var r=t[n],s=e[r];t[n]=[r,s,rm(s)]}return t}var am=im;function om(e,t){return function(n){return n==null?!1:n[e]===t&&(t!==void 0||e in Object(n))}}var Gi=om,cm=em,lm=am,dm=Gi;function um(e){var t=lm(e);return t.length==1&&t[0][2]?dm(t[0][0],t[0][1]):function(n){return n===e||cm(n,e,t)}}var gm=um,hm=le,pm=Ft,fm=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,vm=/^\w*$/;function mm(e,t){if(hm(e))return!1;var n=typeof e;return n=="number"||n=="symbol"||n=="boolean"||e==null||pm(e)?!0:vm.test(e)||!fm.test(e)||t!=null&&e in Object(t)}var Nr=mm,qi=$r,xm="Expected a function";function jr(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(xm);var n=function(){var r=arguments,s=t?t.apply(this,r):r[0],i=n.cache;if(i.has(s))return i.get(s);var a=e.apply(this,r);return n.cache=i.set(s,a)||i,a};return n.cache=new(jr.Cache||qi),n}jr.Cache=qi;var ym=jr,bm=ym,wm=500;function _m(e){var t=bm(e,function(r){return n.size===wm&&n.clear(),r}),n=t.cache;return t}var Sm=_m,Tm=Sm,Em=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Cm=/\\(\\)?/g,Dm=Tm(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(Em,function(n,r,s,i){t.push(s?i.replace(Cm,"$1"):r||n)}),t}),Am=Dm;function $m(e,t){for(var n=-1,r=e==null?0:e.length,s=Array(r);++n<r;)s[n]=t(e[n],n,e);return s}var Vi=$m,Ws=Bt,Nm=Vi,jm=le,Rm=Ft,Gs=Ws?Ws.prototype:void 0,qs=Gs?Gs.toString:void 0;function Ki(e){if(typeof e=="string")return e;if(jm(e))return Nm(e,Ki)+"";if(Rm(e))return qs?qs.call(e):"";var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var Im=Ki,Pm=Im;function km(e){return e==null?"":Pm(e)}var Om=km,Bm=le,Lm=Nr,Mm=Am,Fm=Om;function zm(e,t){return Bm(e)?e:Lm(e,t)?[e]:Mm(Fm(e))}var Xi=zm,Hm=Ft;function Um(e){if(typeof e=="string"||Hm(e))return e;var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var Sn=Um,Wm=Xi,Gm=Sn;function qm(e,t){t=Wm(t,e);for(var n=0,r=t.length;e!=null&&n<r;)e=e[Gm(t[n++])];return n&&n==r?e:void 0}var Rr=qm,Vm=Rr;function Km(e,t,n){var r=e==null?void 0:Vm(e,t);return r===void 0?n:r}var Xm=Km;function Ym(e,t){return e!=null&&t in Object(e)}var Zm=Ym,Jm=Xi,Qm=Sr,e0=le,t0=Tr,n0=Er,r0=Sn;function s0(e,t,n){t=Jm(t,e);for(var r=-1,s=t.length,i=!1;++r<s;){var a=r0(t[r]);if(!(i=e!=null&&n(e,a)))break;e=e[a]}return i||++r!=s?i:(s=e==null?0:e.length,!!s&&n0(s)&&t0(a,s)&&(e0(e)||Qm(e)))}var i0=s0,a0=Zm,o0=i0;function c0(e,t){return e!=null&&o0(e,t,a0)}var l0=c0,d0=Ui,u0=Xm,g0=l0,h0=Nr,p0=Wi,f0=Gi,v0=Sn,m0=1,x0=2;function y0(e,t){return h0(e)&&p0(t)?f0(v0(e),t):function(n){var r=u0(n,e);return r===void 0&&r===t?g0(n,e):d0(t,r,m0|x0)}}var b0=y0;function w0(e){return e}var Tn=w0;function _0(e){return function(t){return t==null?void 0:t[e]}}var S0=_0,T0=Rr;function E0(e){return function(t){return T0(t,e)}}var C0=E0,D0=S0,A0=C0,$0=Nr,N0=Sn;function j0(e){return $0(e)?D0(N0(e)):A0(e)}var R0=j0,I0=gm,P0=b0,k0=Tn,O0=le,B0=R0;function L0(e){return typeof e=="function"?e:e==null?k0:typeof e=="object"?O0(e)?P0(e[0],e[1]):I0(e):B0(e)}var Yi=L0,M0=hu,F0=oh,z0=Yi,H0=le;function U0(e,t){return function(n,r){var s=H0(n)?M0:F0,i=t?t():{};return s(n,e,z0(r),i)}}var W0=U0,G0=uu,q0=W0,V0=Object.prototype,K0=V0.hasOwnProperty,X0=q0(function(e,t,n){K0.call(e,n)?e[n].push(t):G0(e,n,[t])}),Y0=X0;const Zi=mn(Y0),Z0="_input_1pngz_1",J0="_dropdown_1pngz_5",Vs={input:Z0,dropdown:J0},Q0=({initialValue:e,options:t,onSelectOption:n,onCreateOption:r,onClearSelection:s})=>{const i=Ya({onDropdownClose:()=>i.resetSelectedOption()}),[a,o]=f.useState(e||""),c=t.some(p=>p.label===a),l=c?t:t.filter(p=>p.label.toLowerCase().includes(a.toLowerCase().trim())),u=Zi(l,p=>p.group),g=Object.entries(u).map(([p,m])=>d.jsx(Se.Group,{"data-testid":"autocomplete-option-group",label:p,children:m.map(y=>d.jsx(Se.Option,{"data-testid":"autocomplete-option",value:y.value,children:y.label},y.value))},p)),h=()=>{o(""),s==null||s()};return d.jsxs(Se,{store:i,withinPortal:!1,onOptionSubmit:p=>{var m;if(p==="$create")r==null||r(a);else{const y=(m=t.find(b=>b.value===p))==null?void 0:m.label;y&&(o(y),n(p))}i.closeDropdown()},classNames:{dropdown:Vs.dropdown},children:[d.jsx(Se.Target,{children:d.jsx(Za,{"data-testid":"autocomplete-input",className:Vs.input,leftSection:d.jsx(Se.ClearButton,{onClear:h}),rightSection:d.jsx(Se.Chevron,{}),value:a,onChange:p=>{i.openDropdown(),i.updateSelectedOptionIndex(),o(p.currentTarget.value)},onClick:()=>i.openDropdown(),onFocus:()=>i.openDropdown(),onBlur:()=>{i.closeDropdown()},placeholder:"Search value",rightSectionPointerEvents:"none"})}),d.jsx(Se.Dropdown,{"data-testid":"autocomplete-dropdown",children:d.jsxs(Se.Options,{children:[g,!c&&a.trim().length>0&&d.jsxs(Se.Option,{"data-testid":"autocomplete-option-create",value:"$create",children:['+ Create: "',a,'"']},"create-option")]})})]})};var Ks=Bt,e1=Sr,t1=le,Xs=Ks?Ks.isConcatSpreadable:void 0;function n1(e){return t1(e)||e1(e)||!!(Xs&&e&&e[Xs])}var r1=n1,s1=Fi,i1=r1;function Ji(e,t,n,r,s){var i=-1,a=e.length;for(n||(n=i1),s||(s=[]);++i<a;){var o=e[i];t>0&&n(o)?t>1?Ji(o,t-1,n,r,s):s1(s,o):r||(s[s.length]=o)}return s}var a1=Ji,o1=Bi,c1=xn;function l1(e,t){var n=-1,r=c1(e)?Array(e.length):[];return o1(e,function(s,i,a){r[++n]=t(s,i,a)}),r}var d1=l1;function u1(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}var g1=u1,Ys=Ft;function h1(e,t){if(e!==t){var n=e!==void 0,r=e===null,s=e===e,i=Ys(e),a=t!==void 0,o=t===null,c=t===t,l=Ys(t);if(!o&&!l&&!i&&e>t||i&&a&&c&&!o&&!l||r&&a&&c||!n&&c||!s)return 1;if(!r&&!i&&!l&&e<t||l&&n&&s&&!r&&!i||o&&n&&s||!a&&s||!c)return-1}return 0}var p1=h1,f1=p1;function v1(e,t,n){for(var r=-1,s=e.criteria,i=t.criteria,a=s.length,o=n.length;++r<a;){var c=f1(s[r],i[r]);if(c){if(r>=o)return c;var l=n[r];return c*(l=="desc"?-1:1)}}return e.index-t.index}var m1=v1,Fn=Vi,x1=Rr,y1=Yi,b1=d1,w1=g1,_1=ki,S1=m1,T1=Tn,E1=le;function C1(e,t,n){t.length?t=Fn(t,function(i){return E1(i)?function(a){return x1(a,i.length===1?i[0]:i)}:i}):t=[T1];var r=-1;t=Fn(t,_1(y1));var s=b1(e,function(i,a,o){var c=Fn(t,function(l){return l(i)});return{criteria:c,index:++r,value:i}});return w1(s,function(i,a){return S1(i,a,n)})}var D1=C1;function A1(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}var $1=A1,N1=$1,Zs=Math.max;function j1(e,t,n){return t=Zs(t===void 0?e.length-1:t,0),function(){for(var r=arguments,s=-1,i=Zs(r.length-t,0),a=Array(i);++s<i;)a[s]=r[t+s];s=-1;for(var o=Array(t+1);++s<t;)o[s]=r[s];return o[t]=n(a),N1(e,this,o)}}var R1=j1;function I1(e){return function(){return e}}var P1=I1,k1=P1,Js=Ri,O1=Tn,B1=Js?function(e,t){return Js(e,"toString",{configurable:!0,enumerable:!1,value:k1(t),writable:!0})}:O1,L1=B1,M1=800,F1=16,z1=Date.now;function H1(e){var t=0,n=0;return function(){var r=z1(),s=F1-(r-n);if(n=r,s>0){if(++t>=M1)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var U1=H1,W1=L1,G1=U1,q1=G1(W1),V1=q1,K1=Tn,X1=R1,Y1=V1;function Z1(e,t){return Y1(X1(e,t,K1),e+"")}var J1=Z1,Q1=Dr,ex=xn,tx=Tr,nx=Ot;function rx(e,t,n){if(!nx(n))return!1;var r=typeof t;return(r=="number"?ex(n)&&tx(t,n.length):r=="string"&&t in n)?Q1(n[t],e):!1}var sx=rx,ix=a1,ax=D1,ox=J1,Qs=sx,cx=ox(function(e,t){if(e==null)return[];var n=t.length;return n>1&&Qs(e,t[0],t[1])?t=[]:n>2&&Qs(t[0],t[1],t[2])&&(t=[t[0]]),ax(e,ix(t,1),[])}),lx=cx;const dx=mn(lx),ux=[{label:"Barbell Bench Press",value:"barbellBenchPress",group:"chest"},{label:"Deadlift",value:"deadlift",group:"compound"},{label:"Arm Curls Seated Biceps",value:"armCurlsSeatedBiceps",group:"biceps"},{label:"Barbell Back Squat",value:"barbellBackSquat",group:"legs"},{label:"Barbell Row (Lats)",value:"barbellRowLats",group:"back"},{label:"Cable Fly Biceps",value:"cableFlyBiceps",group:"biceps"},{label:"Calf Press Standing",value:"calfPressStanding",group:"legs"},{label:"Chest Supported Machine Row (Traps)",value:"chestSupportedMachineRowTraps",group:"back"},{label:"Close-grip Barbell Bench Press",value:"closeGripBarbellBenchPress",group:"triceps"},{label:"Dumbbell Incline Bench Press",value:"dumbbellInclineBenchPress",group:"chest"},{label:"Dumbbell Overhead Triceps Extension, 1 Arm",value:"dumbbellOverheadTricepsExtension1Arm",group:"triceps"},{label:"Dumbbell Scull Crusher",value:"dumbbellScullCrusher",group:"triceps"},{label:"Incline Machine Chest Press",value:"inclineMachineChestPress",group:"chest"},{label:"Leg Press Calf Rises",value:"legPressCalfRises",group:"legs"},{label:"Overhead Cable Extension 1 Arm",value:"overheadCableExtension1Arm",group:"triceps"},{label:"Plate Loaded Lat Pulldown",value:"plateLoadedLatPulldown",group:"back"},{label:"Pushups",value:"pushups",group:"chest"},{label:"Scott Curls Biceps",value:"scottCurlsBiceps",group:"biceps"},{label:"Seated Dumbbell Curls Supinated",value:"seatedDumbbellCurlsSupinated",group:"biceps"},{label:"Seated Dumbbell Shoulder Press",value:"seatedDumbbellShoulderPress",group:"shoulders"},{label:"Single Arm Dumbbell Row",value:"singleArmDumbbellRow",group:"back"},{label:"Standing Dumbbell Curl",value:"standingDumbbellCurl",group:"biceps"},{label:"Standing Dumbbell Hammer Curl",value:"standingDumbbellHammerCurl",group:"biceps"},{label:"Standing EZ Bar Curl",value:"standingEZBarCurl",group:"biceps"},{label:"Standing EZ Barbell Curls",value:"standingEZBarbellCurls",group:"biceps"},{label:"Triceps Cable Pushdowns",value:"tricepsCablePushdowns",group:"triceps"}],Ir=e=>{const{getStoreData:t}=e.getStore(),{trainingsApi:n}=e.getAPIs(),r=()=>t(Ir.storeDataAccessors).exerciseTypes,s=()=>{const i=r();return[...ux,...i].sort((o,c)=>o.group.localeCompare(c.group))};return{getExerciseTypes:()=>s(),onCreateNewType:(i,a)=>{n.create.exerciseType({label:i,group:a})},getSelectedTypeLabel:i=>{var o;return(o=s().find(c=>c.value===i))==null?void 0:o.label},isSaveDisabledDefault:i=>!i.name.trim().length}};Ir.storeDataAccessors=["exerciseTypes"];function er(e,t){return er=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},er(e,t)}function Pr(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,er(e,t)}function gx(e,t){return e.classList?!!t&&e.classList.contains(t):(" "+(e.className.baseVal||e.className)+" ").indexOf(" "+t+" ")!==-1}function hx(e,t){e.classList?e.classList.add(t):gx(e,t)||(typeof e.className=="string"?e.className=e.className+" "+t:e.setAttribute("class",(e.className&&e.className.baseVal||"")+" "+t))}function ei(e,t){return e.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function px(e,t){e.classList?e.classList.remove(t):typeof e.className=="string"?e.className=ei(e.className,t):e.setAttribute("class",ei(e.className&&e.className.baseVal||"",t))}const ti={disabled:!1},gn=j.createContext(null);var Qi=function(t){return t.scrollTop},Dt="unmounted",Me="exited",Fe="entering",tt="entered",tr="exiting",De=function(e){Pr(t,e);function t(r,s){var i;i=e.call(this,r,s)||this;var a=s,o=a&&!a.isMounting?r.enter:r.appear,c;return i.appearStatus=null,r.in?o?(c=Me,i.appearStatus=Fe):c=tt:r.unmountOnExit||r.mountOnEnter?c=Dt:c=Me,i.state={status:c},i.nextCallback=null,i}t.getDerivedStateFromProps=function(s,i){var a=s.in;return a&&i.status===Dt?{status:Me}:null};var n=t.prototype;return n.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},n.componentDidUpdate=function(s){var i=null;if(s!==this.props){var a=this.state.status;this.props.in?a!==Fe&&a!==tt&&(i=Fe):(a===Fe||a===tt)&&(i=tr)}this.updateStatus(!1,i)},n.componentWillUnmount=function(){this.cancelNextCallback()},n.getTimeouts=function(){var s=this.props.timeout,i,a,o;return i=a=o=s,s!=null&&typeof s!="number"&&(i=s.exit,a=s.enter,o=s.appear!==void 0?s.appear:a),{exit:i,enter:a,appear:o}},n.updateStatus=function(s,i){if(s===void 0&&(s=!1),i!==null)if(this.cancelNextCallback(),i===Fe){if(this.props.unmountOnExit||this.props.mountOnEnter){var a=this.props.nodeRef?this.props.nodeRef.current:Xt.findDOMNode(this);a&&Qi(a)}this.performEnter(s)}else this.performExit();else this.props.unmountOnExit&&this.state.status===Me&&this.setState({status:Dt})},n.performEnter=function(s){var i=this,a=this.props.enter,o=this.context?this.context.isMounting:s,c=this.props.nodeRef?[o]:[Xt.findDOMNode(this),o],l=c[0],u=c[1],g=this.getTimeouts(),h=o?g.appear:g.enter;if(!s&&!a||ti.disabled){this.safeSetState({status:tt},function(){i.props.onEntered(l)});return}this.props.onEnter(l,u),this.safeSetState({status:Fe},function(){i.props.onEntering(l,u),i.onTransitionEnd(h,function(){i.safeSetState({status:tt},function(){i.props.onEntered(l,u)})})})},n.performExit=function(){var s=this,i=this.props.exit,a=this.getTimeouts(),o=this.props.nodeRef?void 0:Xt.findDOMNode(this);if(!i||ti.disabled){this.safeSetState({status:Me},function(){s.props.onExited(o)});return}this.props.onExit(o),this.safeSetState({status:tr},function(){s.props.onExiting(o),s.onTransitionEnd(a.exit,function(){s.safeSetState({status:Me},function(){s.props.onExited(o)})})})},n.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},n.safeSetState=function(s,i){i=this.setNextCallback(i),this.setState(s,i)},n.setNextCallback=function(s){var i=this,a=!0;return this.nextCallback=function(o){a&&(a=!1,i.nextCallback=null,s(o))},this.nextCallback.cancel=function(){a=!1},this.nextCallback},n.onTransitionEnd=function(s,i){this.setNextCallback(i);var a=this.props.nodeRef?this.props.nodeRef.current:Xt.findDOMNode(this),o=s==null&&!this.props.addEndListener;if(!a||o){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var c=this.props.nodeRef?[this.nextCallback]:[a,this.nextCallback],l=c[0],u=c[1];this.props.addEndListener(l,u)}s!=null&&setTimeout(this.nextCallback,s)},n.render=function(){var s=this.state.status;if(s===Dt)return null;var i=this.props,a=i.children;i.in,i.mountOnEnter,i.unmountOnExit,i.appear,i.enter,i.exit,i.timeout,i.addEndListener,i.onEnter,i.onEntering,i.onEntered,i.onExit,i.onExiting,i.onExited,i.nodeRef;var o=lr(i,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return j.createElement(gn.Provider,{value:null},typeof a=="function"?a(s,o):j.cloneElement(j.Children.only(a),o))},t}(j.Component);De.contextType=gn;De.propTypes={};function Qe(){}De.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:Qe,onEntering:Qe,onEntered:Qe,onExit:Qe,onExiting:Qe,onExited:Qe};De.UNMOUNTED=Dt;De.EXITED=Me;De.ENTERING=Fe;De.ENTERED=tt;De.EXITING=tr;var fx=function(t,n){return t&&n&&n.split(" ").forEach(function(r){return hx(t,r)})},zn=function(t,n){return t&&n&&n.split(" ").forEach(function(r){return px(t,r)})},En=function(e){Pr(t,e);function t(){for(var r,s=arguments.length,i=new Array(s),a=0;a<s;a++)i[a]=arguments[a];return r=e.call.apply(e,[this].concat(i))||this,r.appliedClasses={appear:{},enter:{},exit:{}},r.onEnter=function(o,c){var l=r.resolveArguments(o,c),u=l[0],g=l[1];r.removeClasses(u,"exit"),r.addClass(u,g?"appear":"enter","base"),r.props.onEnter&&r.props.onEnter(o,c)},r.onEntering=function(o,c){var l=r.resolveArguments(o,c),u=l[0],g=l[1],h=g?"appear":"enter";r.addClass(u,h,"active"),r.props.onEntering&&r.props.onEntering(o,c)},r.onEntered=function(o,c){var l=r.resolveArguments(o,c),u=l[0],g=l[1],h=g?"appear":"enter";r.removeClasses(u,h),r.addClass(u,h,"done"),r.props.onEntered&&r.props.onEntered(o,c)},r.onExit=function(o){var c=r.resolveArguments(o),l=c[0];r.removeClasses(l,"appear"),r.removeClasses(l,"enter"),r.addClass(l,"exit","base"),r.props.onExit&&r.props.onExit(o)},r.onExiting=function(o){var c=r.resolveArguments(o),l=c[0];r.addClass(l,"exit","active"),r.props.onExiting&&r.props.onExiting(o)},r.onExited=function(o){var c=r.resolveArguments(o),l=c[0];r.removeClasses(l,"exit"),r.addClass(l,"exit","done"),r.props.onExited&&r.props.onExited(o)},r.resolveArguments=function(o,c){return r.props.nodeRef?[r.props.nodeRef.current,o]:[o,c]},r.getClassNames=function(o){var c=r.props.classNames,l=typeof c=="string",u=l&&c?c+"-":"",g=l?""+u+o:c[o],h=l?g+"-active":c[o+"Active"],p=l?g+"-done":c[o+"Done"];return{baseClassName:g,activeClassName:h,doneClassName:p}},r}var n=t.prototype;return n.addClass=function(s,i,a){var o=this.getClassNames(i)[a+"ClassName"],c=this.getClassNames("enter"),l=c.doneClassName;i==="appear"&&a==="done"&&l&&(o+=" "+l),a==="active"&&s&&Qi(s),o&&(this.appliedClasses[i][a]=o,fx(s,o))},n.removeClasses=function(s,i){var a=this.appliedClasses[i],o=a.base,c=a.active,l=a.done;this.appliedClasses[i]={},o&&zn(s,o),c&&zn(s,c),l&&zn(s,l)},n.render=function(){var s=this.props;s.classNames;var i=lr(s,["classNames"]);return j.createElement(De,Si({},i,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},t}(j.Component);En.defaultProps={classNames:""};En.propTypes={};function vx(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kr(e,t){var n=function(i){return t&&f.isValidElement(i)?t(i):i},r=Object.create(null);return e&&f.Children.map(e,function(s){return s}).forEach(function(s){r[s.key]=n(s)}),r}function mx(e,t){e=e||{},t=t||{};function n(u){return u in t?t[u]:e[u]}var r=Object.create(null),s=[];for(var i in e)i in t?s.length&&(r[i]=s,s=[]):s.push(i);var a,o={};for(var c in t){if(r[c])for(a=0;a<r[c].length;a++){var l=r[c][a];o[r[c][a]]=n(l)}o[c]=n(c)}for(a=0;a<s.length;a++)o[s[a]]=n(s[a]);return o}function He(e,t,n){return n[t]!=null?n[t]:e.props[t]}function xx(e,t){return kr(e.children,function(n){return f.cloneElement(n,{onExited:t.bind(null,n),in:!0,appear:He(n,"appear",e),enter:He(n,"enter",e),exit:He(n,"exit",e)})})}function yx(e,t,n){var r=kr(e.children),s=mx(t,r);return Object.keys(s).forEach(function(i){var a=s[i];if(f.isValidElement(a)){var o=i in t,c=i in r,l=t[i],u=f.isValidElement(l)&&!l.props.in;c&&(!o||u)?s[i]=f.cloneElement(a,{onExited:n.bind(null,a),in:!0,exit:He(a,"exit",e),enter:He(a,"enter",e)}):!c&&o&&!u?s[i]=f.cloneElement(a,{in:!1}):c&&o&&f.isValidElement(l)&&(s[i]=f.cloneElement(a,{onExited:n.bind(null,a),in:l.props.in,exit:He(a,"exit",e),enter:He(a,"enter",e)}))}}),s}var bx=Object.values||function(e){return Object.keys(e).map(function(t){return e[t]})},wx={component:"div",childFactory:function(t){return t}},Cn=function(e){Pr(t,e);function t(r,s){var i;i=e.call(this,r,s)||this;var a=i.handleExited.bind(vx(i));return i.state={contextValue:{isMounting:!0},handleExited:a,firstRender:!0},i}var n=t.prototype;return n.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},n.componentWillUnmount=function(){this.mounted=!1},t.getDerivedStateFromProps=function(s,i){var a=i.children,o=i.handleExited,c=i.firstRender;return{children:c?xx(s,o):yx(s,a,o),firstRender:!1}},n.handleExited=function(s,i){var a=kr(this.props.children);s.key in a||(s.props.onExited&&s.props.onExited(i),this.mounted&&this.setState(function(o){var c=Si({},o.children);return delete c[s.key],{children:c}}))},n.render=function(){var s=this.props,i=s.component,a=s.childFactory,o=lr(s,["component","childFactory"]),c=this.state.contextValue,l=bx(this.state.children).map(a);return delete o.appear,delete o.enter,delete o.exit,i===null?j.createElement(gn.Provider,{value:c},l):j.createElement(gn.Provider,{value:c},j.createElement(i,o,l))},t}(j.Component);Cn.propTypes={};Cn.defaultProps=wx;const _x="_screen_pj8jq_1",Sx="_screenNoData_pj8jq_8",Tx="_button_pj8jq_11",Ex="_navbarContainer_pj8jq_15",Cx="_topBar_pj8jq_19",Dx="_sets_pj8jq_29",Ax="_set_pj8jq_29",$x="_setDelete_pj8jq_46",Nx="_setName_pj8jq_50",jx="_setRepetitions_pj8jq_54",Rx="_setWeight_pj8jq_58",Ix="_weightUnit_pj8jq_70",Px="_setEnter_pj8jq_74",kx="_setActiveEnter_pj8jq_78",Ox="_setExit_pj8jq_83",Bx="_setActiveExit_pj8jq_87",H={screen:_x,screenNoData:Sx,button:Tx,navbarContainer:Ex,topBar:Cx,sets:Dx,set:Ax,setDelete:$x,setName:Nx,setRepetitions:jx,setWeight:Rx,weightUnit:Ix,setEnter:Px,setActiveEnter:kx,setExit:Ox,setActiveExit:Bx},Lx=dx(["compound","miscellaneous","chest","legs","back","shoulders","biceps","triceps","abs"]),Mx=e=>{const[t,n]=Ja(!1),[r,s]=j.useState(null),[i,a]=j.useState(null),{data:o,dataTestId:c,exerciseTypes:l,disabledDelete:u,disabledSave:g,onAddSet:h,onChangeName:p,onCreateNewType:m,getSelectedTypeLabel:y,onDelete:b,onSave:S,onDeleteSet:A,onChangeRepetitions:C,onChangeWeight:_,isSaveDisabledDefault:D}=e,P=$=>{s($),a(null),n.open()},v=()=>{r&&i&&(m(r,i),p(r)),n.close(),a(null),s(null)},x=()=>d.jsx("div",{className:H.topBar,children:d.jsx(Q0,{initialValue:o.name,options:l,className:H.input,onSelectOption:$=>{const N=y($);N&&p(N)},onCreateOption:$=>{P($)},onClearSelection:()=>{p("")}})}),w=()=>d.jsxs(it,{className:H.navbarContainer,children:[d.jsx(k,{skin:"icon",size:"large",onClick:b,"data-testid":"exercise-delete-button",disabled:u,children:d.jsx(Ue,{})}),d.jsx(k,{skin:"icon",size:"large",onClick:S,"data-testid":"exercise-save-button",disabled:g??D(o),children:d.jsx(cn,{})})]}),E=()=>d.jsx(Cn,{component:"ul",className:H.sets,"data-testid":"sets-list",children:o.sets.map(($,N)=>d.jsx(En,{timeout:250,classNames:{enter:H.setEnter,enterActive:H.setActiveEnter,exit:H.setExit,exitActive:H.setActiveExit},children:d.jsxs("li",{className:H.set,"data-testid":"set-item",children:[d.jsx(k,{skin:"icon",size:"medium",className:H.setDelete,onClick:()=>A($.id),"data-testid":"delete-set-button",children:d.jsx(Ue,{})}),d.jsxs("div",{className:H.setName,children:["Set ",N+1]}),d.jsx("div",{className:H.setRepetitions,children:d.jsx(Rt,{type:"number",value:$.repetitions,onBlur:R=>C($.id,R),onChange:()=>{},className:H.input,"data-testid":"set-repetitions-input"})}),d.jsx("div",{children:"X"}),d.jsx("div",{className:H.setWeight,children:d.jsx(Rt,{type:"number",value:$.weight,onBlur:R=>_($.id,R),onChange:()=>{},className:H.input,"data-testid":"set-weight-input"})}),d.jsx("div",{className:H.weightUnit,children:"kg"})]})},$.id))}),T=!!o.sets.length;return d.jsx(ve,{dataTestId:c,topBar:x(),bottomBar:w(),children:d.jsxs("div",{className:ae(H.screen,{[H.screenNoData]:!T}),children:[E(),d.jsx(k,{skin:"primary",font:"nunito",className:H.button,onClick:h,"data-testid":"add-set-button",children:"Add set"}),d.jsxs(Qa,{opened:t,onClose:n.close,overlayProps:{backgroundOpacity:.55,blur:3},children:[d.jsx(eo,{label:"Choose group for new exercise type",placeholder:"Pick value",data:Lx,onChange:a}),d.jsx(k,{skin:"icon",size:"large",onClick:v,"data-testid":"finish-create-exercise-type-button",disabled:!i,children:d.jsx(cn,{})})]})]})})},Or=V({controller:Ir},e=>({exerciseTypes:e.getExerciseTypes(),onCreateNewType:e.onCreateNewType,getSelectedTypeLabel:e.getSelectedTypeLabel,isSaveDisabledDefault:e.isSaveDisabledDefault}))(Mx),Fx="_screen_fbnhd_1",zx="_screenNoData_fbnhd_8",Hx="_button_fbnhd_11",Ux="_navbarContainer_fbnhd_15",Wx="_topBar_fbnhd_19",Gx="_exercises_fbnhd_29",qx="_exercise_fbnhd_29",Vx="_exerciseBox_fbnhd_44",Kx="_exerciseDelete_fbnhd_54",Xx="_setEnter_fbnhd_58",Yx="_setActiveEnter_fbnhd_62",Zx="_setExit_fbnhd_67",Jx="_setActiveExit_fbnhd_71",te={screen:Fx,screenNoData:zx,button:Hx,navbarContainer:Ux,topBar:Wx,exercises:Gx,exercise:qx,exerciseBox:Vx,exerciseDelete:Kx,setEnter:Xx,setActiveEnter:Yx,setExit:Zx,setActiveExit:Jx},ea=({id:e,name:t,exercises:n,dataTestId:r,onChangeName:s,onAddExercise:i,onDelete:a,onSave:o,onDeleteExercise:c,onOpenExercise:l,onReorderExercises:u})=>{const g=!!n.length;return d.jsx(ve,{dataTestId:r,topBar:d.jsx("div",{className:te.topBar,children:d.jsx(Rt,{type:"text",value:t,onBlur:s,"data-testid":"training-name-input"})}),bottomBar:d.jsxs(it,{className:te.navbarContainer,children:[d.jsx(k,{skin:"icon",size:"large",onClick:a,"data-testid":"training-delete-button",children:d.jsx(Ue,{})}),d.jsx(k,{skin:"icon",size:"large",onClick:o,"data-testid":"training-save-button",children:d.jsx(cn,{})})]}),children:d.jsxs("div",{className:ae(te.screen,{[te.screenNoData]:!g}),children:[d.jsx(uw,{data:n,containerClassName:te.exercises,containerDataTestId:"exercises-list",animationClassNames:{enter:te.setEnter,enterActive:te.setActiveEnter,exit:te.setExit,exitActive:te.setActiveExit},onReorder:({newData:h})=>u(e,h),renderItem:(h,p)=>d.jsxs("li",{...p,className:ae(te.exercise,p.className),"data-testid":"exercise-item",children:[d.jsx(k,{skin:"icon",size:"medium",className:te.exerciseDelete,onClick:()=>c(e,h.id),"data-testid":"delete-exercise-button",children:d.jsx(Ue,{})}),d.jsxs("div",{className:te.exerciseBox,onClick:()=>l(h.id),"data-testid":"open-exercise-button",children:[h.name,d.jsx("br",{}),h.setsPreview]})]})}),d.jsx(k,{skin:"primary",font:"nunito",className:te.button,onClick:i,"data-testid":"add-exercise-button",children:"Add exersise"})]})})},Br=e=>{const t=e.getStore(),{notificationsApi:n}=e.getAPIs();return{getNotifications:()=>t.getStoreData(Br.storeDataAccessors).notifications,removeNotification:r=>n.removeNotification(r)}};Br.storeDataAccessors=["notifications"];const Qx="_notifications_1c88m_1",ey="_toast_1c88m_12",ty="_toastInfo_1c88m_22",ny="_toastSuccess_1c88m_26",ry="_toastError_1c88m_30",sy="_message_1c88m_34",iy="_closeBtn_1c88m_41",ze={notifications:Qx,toast:ey,toastInfo:ty,toastSuccess:ny,toastError:ry,message:sy,closeBtn:iy},ay=5e3,oy=({n:e,onClose:t})=>(f.useEffect(()=>{const n=setTimeout(()=>t(e.id),ay);return()=>clearTimeout(n)},[e.id,t]),d.jsxs("div",{className:ae(ze.toast,{[ze.toastError]:e.type==="error",[ze.toastSuccess]:e.type==="success",[ze.toastInfo]:e.type==="info"}),role:"status","aria-live":"polite","data-testid":"notification",children:[d.jsx("div",{className:ze.message,"data-testid":"notification-message",children:e.message}),d.jsx(k,{skin:"icon",size:"small",className:ze.closeBtn,onClick:()=>t(e.id),"aria-label":"Dismiss","data-testid":"dismiss-notification-button",children:d.jsx(Ue,{})})]})),cy=({notifications:e,removeNotification:t})=>e.length?d.jsx("div",{className:ze.notifications,"aria-live":"polite","data-testid":"notifications-container",children:e.map(n=>d.jsx(oy,{n,onClose:t},n.id))}):null,ly=V({controller:Br},e=>({notifications:e.getNotifications(),removeNotification:e.removeNotification}))(cy),Lr=e=>{const t=e.getStore(),n=()=>t.getStoreData(Lr.storeDataAccessors);return{getData:()=>n().uiBlockingLayer}};Lr.storeDataAccessors=["uiBlockingLayer"];const dy="_blockingLayer_x34gr_1",uy="_overlay_x34gr_11",gy="_messageWrapper_x34gr_18",hy="_message_x34gr_18",Zt={blockingLayer:dy,overlay:uy,messageWrapper:gy,message:hy},py=({data:e})=>e.isVisible?d.jsxs("div",{className:Zt.blockingLayer,role:"status","aria-live":"polite","data-testid":"ui-blocking-layer",children:[d.jsx("div",{className:Zt.overlay}),d.jsx("div",{className:Zt.messageWrapper,children:d.jsx("div",{className:Zt.message,"data-testid":"ui-blocking-layer-message",children:e.message})})]}):null,fy=V({controller:Lr},e=>({data:e.getData()}))(py),Mr=e=>{const t=e.getStore(),{navigationApi:n}=e.getAPIs(),r=()=>t.getStoreData(Mr.storeDataAccessors);return{getLast7DaysAggregates:()=>{const s=r().completedTrainings||[],i=Kn(s);return xs(i,7)},getTotalsForLast7Days:()=>{const s=r().completedTrainings||[],i=Kn(s),a=xs(i,7),o=a.reduce((l,u)=>l+u.totalVolumeKg,0),c=a.reduce((l,u)=>l+u.sessionsCount,0);return{totalVolumeKg:o,sessions:c}},onOpen:async()=>{await n.toDashboard()}}};Mr.storeDataAccessors=["completedTrainings"];const nr=({data:e,variant:t="detailed",height:n=140})=>{const s=e.map(i=>({date:i.dateISO.slice(5),volume:Math.round(i.totalVolumeKg),sessions:i.sessionsCount}));return t==="sparkline"?d.jsx("div",{style:{width:"100%",height:"100%"},children:d.jsx(kn,{width:"100%",height:"100%",initialDimension:{width:10,height:10},children:d.jsx(is,{data:s,children:d.jsx(On,{type:"monotone",dataKey:"volume",stroke:"#8884d8",strokeWidth:2,dot:!1})})})}):t==="bar"?d.jsx("div",{style:{width:"100%",height:n},children:d.jsx(kn,{width:"100%",height:"100%",initialDimension:{width:10,height:10},children:d.jsxs(to,{data:s,children:[d.jsx(as,{strokeDasharray:"3 3"}),d.jsx(os,{dataKey:"date"}),d.jsx(cs,{}),d.jsx(ls,{}),d.jsx(no,{dataKey:"volume",fill:"#82ca9d"})]})})}):d.jsx("div",{style:{width:"100%",height:n},children:d.jsx(kn,{width:"100%",height:"100%",initialDimension:{width:10,height:10},children:d.jsxs(is,{data:s,children:[d.jsx(as,{strokeDasharray:"3 3"}),d.jsx(os,{dataKey:"date"}),d.jsx(cs,{}),d.jsx(ls,{}),d.jsx(On,{type:"monotone",dataKey:"volume",stroke:"#8884d8",strokeWidth:2}),d.jsx(On,{type:"monotone",dataKey:"sessions",stroke:"#82ca9d",strokeWidth:1})]})})})},vy="_card_8q4o9_1",my="_header_8q4o9_8",xy="_kpis_8q4o9_14",yy="_kpiItem_8q4o9_20",by="_kpiLabel_8q4o9_24",wy="_kpiValue_8q4o9_29",pe={card:vy,header:my,kpis:xy,kpiItem:yy,kpiLabel:by,kpiValue:wy},_y=({last7:e,totals:t,onOpen:n})=>d.jsxs("div",{className:pe.card,children:[d.jsxs("div",{className:pe.header,children:[d.jsx("h4",{children:"Progress"}),d.jsx("div",{className:pe.actions,children:d.jsx(k,{skin:"primary",size:"small",onClick:n,children:"Open"})})]}),d.jsxs("div",{className:pe.kpis,children:[d.jsxs("div",{className:pe.kpiItem,children:[d.jsx("div",{className:pe.kpiLabel,children:"7d volume"}),d.jsxs("div",{className:pe.kpiValue,children:[Math.round(t.totalVolumeKg)," kg"]})]}),d.jsxs("div",{className:pe.kpiItem,children:[d.jsx("div",{className:pe.kpiLabel,children:"sessions"}),d.jsx("div",{className:pe.kpiValue,children:t.sessions})]})]}),d.jsx("div",{style:{height:64},children:d.jsx(nr,{data:e,variant:"sparkline",height:64})})]}),Sy=V({controller:Mr},e=>({last7:e.getLast7DaysAggregates(),totals:e.getTotalsForLast7Days(),onOpen:e.onOpen}))(_y);function Ty(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return f.useMemo(()=>r=>{t.forEach(s=>s(r))},t)}const Dn=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function ut(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function Fr(e){return"nodeType"in e}function Z(e){var t,n;return e?ut(e)?e:Fr(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function zr(e){const{Document:t}=Z(e);return e instanceof t}function zt(e){return ut(e)?!1:e instanceof Z(e).HTMLElement}function ta(e){return e instanceof Z(e).SVGElement}function gt(e){return e?ut(e)?e.document:Fr(e)?zr(e)?e:zt(e)||ta(e)?e.ownerDocument:document:document:document}const me=Dn?f.useLayoutEffect:f.useEffect;function Hr(e){const t=f.useRef(e);return me(()=>{t.current=e}),f.useCallback(function(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return t.current==null?void 0:t.current(...r)},[])}function Ey(){const e=f.useRef(null),t=f.useCallback((r,s)=>{e.current=setInterval(r,s)},[]),n=f.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function It(e,t){t===void 0&&(t=[e]);const n=f.useRef(e);return me(()=>{n.current!==e&&(n.current=e)},t),n}function Ht(e,t){const n=f.useRef();return f.useMemo(()=>{const r=e(n.current);return n.current=r,r},[...t])}function hn(e){const t=Hr(e),n=f.useRef(null),r=f.useCallback(s=>{s!==n.current&&(t==null||t(s,n.current)),n.current=s},[]);return[n,r]}function rr(e){const t=f.useRef();return f.useEffect(()=>{t.current=e},[e]),t.current}let Hn={};function Ut(e,t){return f.useMemo(()=>{if(t)return t;const n=Hn[e]==null?0:Hn[e]+1;return Hn[e]=n,e+"-"+n},[e,t])}function na(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];return r.reduce((i,a)=>{const o=Object.entries(a);for(const[c,l]of o){const u=i[c];u!=null&&(i[c]=u+e*l)}return i},{...t})}}const rt=na(1),pn=na(-1);function Cy(e){return"clientX"in e&&"clientY"in e}function Ur(e){if(!e)return!1;const{KeyboardEvent:t}=Z(e.target);return t&&e instanceof t}function Dy(e){if(!e)return!1;const{TouchEvent:t}=Z(e.target);return t&&e instanceof t}function sr(e){if(Dy(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return Cy(e)?{x:e.clientX,y:e.clientY}:null}const Pt=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[Pt.Translate.toString(e),Pt.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:r}=e;return t+" "+n+"ms "+r}}}),ni="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function Ay(e){return e.matches(ni)?e:e.querySelector(ni)}const $y={display:"none"};function Ny(e){let{id:t,value:n}=e;return j.createElement("div",{id:t,style:$y},n)}function jy(e){let{id:t,announcement:n,ariaLiveType:r="assertive"}=e;const s={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return j.createElement("div",{id:t,style:s,role:"status","aria-live":r,"aria-atomic":!0},n)}function Ry(){const[e,t]=f.useState("");return{announce:f.useCallback(r=>{r!=null&&t(r)},[]),announcement:e}}const ra=f.createContext(null);function Iy(e){const t=f.useContext(ra);f.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function Py(){const[e]=f.useState(()=>new Set),t=f.useCallback(r=>(e.add(r),()=>e.delete(r)),[e]);return[f.useCallback(r=>{let{type:s,event:i}=r;e.forEach(a=>{var o;return(o=a[s])==null?void 0:o.call(a,i)})},[e]),t]}const ky={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},Oy={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function By(e){let{announcements:t=Oy,container:n,hiddenTextDescribedById:r,screenReaderInstructions:s=ky}=e;const{announce:i,announcement:a}=Ry(),o=Ut("DndLiveRegion"),[c,l]=f.useState(!1);if(f.useEffect(()=>{l(!0)},[]),Iy(f.useMemo(()=>({onDragStart(g){let{active:h}=g;i(t.onDragStart({active:h}))},onDragMove(g){let{active:h,over:p}=g;t.onDragMove&&i(t.onDragMove({active:h,over:p}))},onDragOver(g){let{active:h,over:p}=g;i(t.onDragOver({active:h,over:p}))},onDragEnd(g){let{active:h,over:p}=g;i(t.onDragEnd({active:h,over:p}))},onDragCancel(g){let{active:h,over:p}=g;i(t.onDragCancel({active:h,over:p}))}}),[i,t])),!c)return null;const u=j.createElement(j.Fragment,null,j.createElement(Ny,{id:r,value:s.draggable}),j.createElement(jy,{id:o,announcement:a}));return n?nt.createPortal(u,n):u}var U;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(U||(U={}));function fn(){}function ri(e,t){return f.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function Ly(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return f.useMemo(()=>[...t].filter(r=>r!=null),[...t])}const ce=Object.freeze({x:0,y:0});function My(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function Fy(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return n-r}function zy(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return r-n}function Hy(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}function si(e,t,n){return t===void 0&&(t=e.left),n===void 0&&(n=e.top),{x:t+e.width*.5,y:n+e.height*.5}}const Uy=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const s=si(t,t.left,t.top),i=[];for(const a of r){const{id:o}=a,c=n.get(o);if(c){const l=My(si(c),s);i.push({id:o,data:{droppableContainer:a,value:l}})}}return i.sort(Fy)};function Wy(e,t){const n=Math.max(t.top,e.top),r=Math.max(t.left,e.left),s=Math.min(t.left+t.width,e.left+e.width),i=Math.min(t.top+t.height,e.top+e.height),a=s-r,o=i-n;if(r<s&&n<i){const c=t.width*t.height,l=e.width*e.height,u=a*o,g=u/(c+l-u);return Number(g.toFixed(4))}return 0}const Gy=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const s=[];for(const i of r){const{id:a}=i,o=n.get(a);if(o){const c=Wy(o,t);c>0&&s.push({id:a,data:{droppableContainer:i,value:c}})}}return s.sort(zy)};function qy(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function sa(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:ce}function Vy(e){return function(n){for(var r=arguments.length,s=new Array(r>1?r-1:0),i=1;i<r;i++)s[i-1]=arguments[i];return s.reduce((a,o)=>({...a,top:a.top+e*o.y,bottom:a.bottom+e*o.y,left:a.left+e*o.x,right:a.right+e*o.x}),{...n})}}const Ky=Vy(1);function Xy(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function Yy(e,t,n){const r=Xy(t);if(!r)return e;const{scaleX:s,scaleY:i,x:a,y:o}=r,c=e.left-a-(1-s)*parseFloat(n),l=e.top-o-(1-i)*parseFloat(n.slice(n.indexOf(" ")+1)),u=s?e.width/s:e.width,g=i?e.height/i:e.height;return{width:u,height:g,top:l,right:c+u,bottom:l+g,left:c}}const Zy={ignoreTransform:!1};function ht(e,t){t===void 0&&(t=Zy);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:l,transformOrigin:u}=Z(e).getComputedStyle(e);l&&(n=Yy(n,l,u))}const{top:r,left:s,width:i,height:a,bottom:o,right:c}=n;return{top:r,left:s,width:i,height:a,bottom:o,right:c}}function ii(e){return ht(e,{ignoreTransform:!0})}function Jy(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function Qy(e,t){return t===void 0&&(t=Z(e).getComputedStyle(e)),t.position==="fixed"}function eb(e,t){t===void 0&&(t=Z(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(s=>{const i=t[s];return typeof i=="string"?n.test(i):!1})}function Wr(e,t){const n=[];function r(s){if(t!=null&&n.length>=t||!s)return n;if(zr(s)&&s.scrollingElement!=null&&!n.includes(s.scrollingElement))return n.push(s.scrollingElement),n;if(!zt(s)||ta(s)||n.includes(s))return n;const i=Z(e).getComputedStyle(s);return s!==e&&eb(s,i)&&n.push(s),Qy(s,i)?n:r(s.parentNode)}return e?r(e):n}function ia(e){const[t]=Wr(e,1);return t??null}function Un(e){return!Dn||!e?null:ut(e)?e:Fr(e)?zr(e)||e===gt(e).scrollingElement?window:zt(e)?e:null:null}function aa(e){return ut(e)?e.scrollX:e.scrollLeft}function oa(e){return ut(e)?e.scrollY:e.scrollTop}function ir(e){return{x:aa(e),y:oa(e)}}var W;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(W||(W={}));function ca(e){return!Dn||!e?!1:e===document.scrollingElement}function la(e){const t={x:0,y:0},n=ca(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},r={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},s=e.scrollTop<=t.y,i=e.scrollLeft<=t.x,a=e.scrollTop>=r.y,o=e.scrollLeft>=r.x;return{isTop:s,isLeft:i,isBottom:a,isRight:o,maxScroll:r,minScroll:t}}const tb={x:.2,y:.2};function nb(e,t,n,r,s){let{top:i,left:a,right:o,bottom:c}=n;r===void 0&&(r=10),s===void 0&&(s=tb);const{isTop:l,isBottom:u,isLeft:g,isRight:h}=la(e),p={x:0,y:0},m={x:0,y:0},y={height:t.height*s.y,width:t.width*s.x};return!l&&i<=t.top+y.height?(p.y=W.Backward,m.y=r*Math.abs((t.top+y.height-i)/y.height)):!u&&c>=t.bottom-y.height&&(p.y=W.Forward,m.y=r*Math.abs((t.bottom-y.height-c)/y.height)),!h&&o>=t.right-y.width?(p.x=W.Forward,m.x=r*Math.abs((t.right-y.width-o)/y.width)):!g&&a<=t.left+y.width&&(p.x=W.Backward,m.x=r*Math.abs((t.left+y.width-a)/y.width)),{direction:p,speed:m}}function rb(e){if(e===document.scrollingElement){const{innerWidth:i,innerHeight:a}=window;return{top:0,left:0,right:i,bottom:a,width:i,height:a}}const{top:t,left:n,right:r,bottom:s}=e.getBoundingClientRect();return{top:t,left:n,right:r,bottom:s,width:e.clientWidth,height:e.clientHeight}}function da(e){return e.reduce((t,n)=>rt(t,ir(n)),ce)}function sb(e){return e.reduce((t,n)=>t+aa(n),0)}function ib(e){return e.reduce((t,n)=>t+oa(n),0)}function ab(e,t){if(t===void 0&&(t=ht),!e)return;const{top:n,left:r,bottom:s,right:i}=t(e);ia(e)&&(s<=0||i<=0||n>=window.innerHeight||r>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const ob=[["x",["left","right"],sb],["y",["top","bottom"],ib]];class Gr{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=Wr(n),s=da(r);this.rect={...t},this.width=t.width,this.height=t.height;for(const[i,a,o]of ob)for(const c of a)Object.defineProperty(this,c,{get:()=>{const l=o(r),u=s[i]-l;return this.rect[c]+u},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class At{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...n)})},this.target=t}add(t,n,r){var s;(s=this.target)==null||s.addEventListener(t,n,r),this.listeners.push([t,n,r])}}function cb(e){const{EventTarget:t}=Z(e);return e instanceof t?e:gt(e)}function Wn(e,t){const n=Math.abs(e.x),r=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+r**2)>t:"x"in t&&"y"in t?n>t.x&&r>t.y:"x"in t?n>t.x:"y"in t?r>t.y:!1}var ie;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(ie||(ie={}));function ai(e){e.preventDefault()}function lb(e){e.stopPropagation()}var O;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(O||(O={}));const ua={start:[O.Space,O.Enter],cancel:[O.Esc],end:[O.Space,O.Enter,O.Tab]},db=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case O.Right:return{...n,x:n.x+25};case O.Left:return{...n,x:n.x-25};case O.Down:return{...n,y:n.y+25};case O.Up:return{...n,y:n.y-25}}};class ga{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new At(gt(n)),this.windowListeners=new At(Z(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(ie.Resize,this.handleCancel),this.windowListeners.add(ie.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(ie.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,r=t.node.current;r&&ab(r),n(ce)}handleKeyDown(t){if(Ur(t)){const{active:n,context:r,options:s}=this.props,{keyboardCodes:i=ua,coordinateGetter:a=db,scrollBehavior:o="smooth"}=s,{code:c}=t;if(i.end.includes(c)){this.handleEnd(t);return}if(i.cancel.includes(c)){this.handleCancel(t);return}const{collisionRect:l}=r.current,u=l?{x:l.left,y:l.top}:ce;this.referenceCoordinates||(this.referenceCoordinates=u);const g=a(t,{active:n,context:r.current,currentCoordinates:u});if(g){const h=pn(g,u),p={x:0,y:0},{scrollableAncestors:m}=r.current;for(const y of m){const b=t.code,{isTop:S,isRight:A,isLeft:C,isBottom:_,maxScroll:D,minScroll:P}=la(y),v=rb(y),x={x:Math.min(b===O.Right?v.right-v.width/2:v.right,Math.max(b===O.Right?v.left:v.left+v.width/2,g.x)),y:Math.min(b===O.Down?v.bottom-v.height/2:v.bottom,Math.max(b===O.Down?v.top:v.top+v.height/2,g.y))},w=b===O.Right&&!A||b===O.Left&&!C,E=b===O.Down&&!_||b===O.Up&&!S;if(w&&x.x!==g.x){const T=y.scrollLeft+h.x,$=b===O.Right&&T<=D.x||b===O.Left&&T>=P.x;if($&&!h.y){y.scrollTo({left:T,behavior:o});return}$?p.x=y.scrollLeft-T:p.x=b===O.Right?y.scrollLeft-D.x:y.scrollLeft-P.x,p.x&&y.scrollBy({left:-p.x,behavior:o});break}else if(E&&x.y!==g.y){const T=y.scrollTop+h.y,$=b===O.Down&&T<=D.y||b===O.Up&&T>=P.y;if($&&!h.x){y.scrollTo({top:T,behavior:o});return}$?p.y=y.scrollTop-T:p.y=b===O.Down?y.scrollTop-D.y:y.scrollTop-P.y,p.y&&y.scrollBy({top:-p.y,behavior:o});break}}this.handleMove(t,rt(pn(g,this.referenceCoordinates),p))}}}handleMove(t,n){const{onMove:r}=this.props;t.preventDefault(),r(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}ga.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:r=ua,onActivation:s}=t,{active:i}=n;const{code:a}=e.nativeEvent;if(r.start.includes(a)){const o=i.activatorNode.current;return o&&e.target!==o?!1:(e.preventDefault(),s==null||s({event:e.nativeEvent}),!0)}return!1}}];function oi(e){return!!(e&&"distance"in e)}function ci(e){return!!(e&&"delay"in e)}class qr{constructor(t,n,r){var s;r===void 0&&(r=cb(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:i}=t,{target:a}=i;this.props=t,this.events=n,this.document=gt(a),this.documentListeners=new At(this.document),this.listeners=new At(r),this.windowListeners=new At(Z(a)),this.initialCoordinates=(s=sr(i))!=null?s:ce,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:r}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(ie.Resize,this.handleCancel),this.windowListeners.add(ie.DragStart,ai),this.windowListeners.add(ie.VisibilityChange,this.handleCancel),this.windowListeners.add(ie.ContextMenu,ai),this.documentListeners.add(ie.Keydown,this.handleKeydown),n){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(ci(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(oi(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:r,onPending:s}=this.props;s(r,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(ie.Click,lb,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(ie.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:r,initialCoordinates:s,props:i}=this,{onMove:a,options:{activationConstraint:o}}=i;if(!s)return;const c=(n=sr(t))!=null?n:ce,l=pn(s,c);if(!r&&o){if(oi(o)){if(o.tolerance!=null&&Wn(l,o.tolerance))return this.handleCancel();if(Wn(l,o.distance))return this.handleStart()}if(ci(o)&&Wn(l,o.tolerance))return this.handleCancel();this.handlePending(o,l);return}t.cancelable&&t.preventDefault(),a(c)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===O.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const ub={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class Vr extends qr{constructor(t){const{event:n}=t,r=gt(n.target);super(t,ub,r)}}Vr.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return!n.isPrimary||n.button!==0?!1:(r==null||r({event:n}),!0)}}];const gb={move:{name:"mousemove"},end:{name:"mouseup"}};var ar;(function(e){e[e.RightClick=2]="RightClick"})(ar||(ar={}));class hb extends qr{constructor(t){super(t,gb,gt(t.event.target))}}hb.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return n.button===ar.RightClick?!1:(r==null||r({event:n}),!0)}}];const Gn={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class ha extends qr{constructor(t){super(t,Gn)}static setup(){return window.addEventListener(Gn.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(Gn.move.name,t)};function t(){}}}ha.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;const{touches:s}=n;return s.length>1?!1:(r==null||r({event:n}),!0)}}];var $t;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})($t||($t={}));var vn;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(vn||(vn={}));function pb(e){let{acceleration:t,activator:n=$t.Pointer,canScroll:r,draggingRect:s,enabled:i,interval:a=5,order:o=vn.TreeOrder,pointerCoordinates:c,scrollableAncestors:l,scrollableAncestorRects:u,delta:g,threshold:h}=e;const p=vb({delta:g,disabled:!i}),[m,y]=Ey(),b=f.useRef({x:0,y:0}),S=f.useRef({x:0,y:0}),A=f.useMemo(()=>{switch(n){case $t.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case $t.DraggableRect:return s}},[n,s,c]),C=f.useRef(null),_=f.useCallback(()=>{const P=C.current;if(!P)return;const v=b.current.x*S.current.x,x=b.current.y*S.current.y;P.scrollBy(v,x)},[]),D=f.useMemo(()=>o===vn.TreeOrder?[...l].reverse():l,[o,l]);f.useEffect(()=>{if(!i||!l.length||!A){y();return}for(const P of D){if((r==null?void 0:r(P))===!1)continue;const v=l.indexOf(P),x=u[v];if(!x)continue;const{direction:w,speed:E}=nb(P,x,A,t,h);for(const T of["x","y"])p[T][w[T]]||(E[T]=0,w[T]=0);if(E.x>0||E.y>0){y(),C.current=P,m(_,a),b.current=E,S.current=w;return}}b.current={x:0,y:0},S.current={x:0,y:0},y()},[t,_,r,y,i,a,JSON.stringify(A),JSON.stringify(p),m,l,D,u,JSON.stringify(h)])}const fb={x:{[W.Backward]:!1,[W.Forward]:!1},y:{[W.Backward]:!1,[W.Forward]:!1}};function vb(e){let{delta:t,disabled:n}=e;const r=rr(t);return Ht(s=>{if(n||!r||!s)return fb;const i={x:Math.sign(t.x-r.x),y:Math.sign(t.y-r.y)};return{x:{[W.Backward]:s.x[W.Backward]||i.x===-1,[W.Forward]:s.x[W.Forward]||i.x===1},y:{[W.Backward]:s.y[W.Backward]||i.y===-1,[W.Forward]:s.y[W.Forward]||i.y===1}}},[n,t,r])}function mb(e,t){const n=t!=null?e.get(t):void 0,r=n?n.node.current:null;return Ht(s=>{var i;return t==null?null:(i=r??s)!=null?i:null},[r,t])}function xb(e,t){return f.useMemo(()=>e.reduce((n,r)=>{const{sensor:s}=r,i=s.activators.map(a=>({eventName:a.eventName,handler:t(a.handler,r)}));return[...n,...i]},[]),[e,t])}var kt;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(kt||(kt={}));var or;(function(e){e.Optimized="optimized"})(or||(or={}));const li=new Map;function yb(e,t){let{dragging:n,dependencies:r,config:s}=t;const[i,a]=f.useState(null),{frequency:o,measure:c,strategy:l}=s,u=f.useRef(e),g=b(),h=It(g),p=f.useCallback(function(S){S===void 0&&(S=[]),!h.current&&a(A=>A===null?S:A.concat(S.filter(C=>!A.includes(C))))},[h]),m=f.useRef(null),y=Ht(S=>{if(g&&!n)return li;if(!S||S===li||u.current!==e||i!=null){const A=new Map;for(let C of e){if(!C)continue;if(i&&i.length>0&&!i.includes(C.id)&&C.rect.current){A.set(C.id,C.rect.current);continue}const _=C.node.current,D=_?new Gr(c(_),_):null;C.rect.current=D,D&&A.set(C.id,D)}return A}return S},[e,i,n,g,c]);return f.useEffect(()=>{u.current=e},[e]),f.useEffect(()=>{g||p()},[n,g]),f.useEffect(()=>{i&&i.length>0&&a(null)},[JSON.stringify(i)]),f.useEffect(()=>{g||typeof o!="number"||m.current!==null||(m.current=setTimeout(()=>{p(),m.current=null},o))},[o,g,p,...r]),{droppableRects:y,measureDroppableContainers:p,measuringScheduled:i!=null};function b(){switch(l){case kt.Always:return!1;case kt.BeforeDragging:return n;default:return!n}}}function pa(e,t){return Ht(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function bb(e,t){return pa(e,t)}function wb(e){let{callback:t,disabled:n}=e;const r=Hr(t),s=f.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:i}=window;return new i(r)},[r,n]);return f.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function An(e){let{callback:t,disabled:n}=e;const r=Hr(t),s=f.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:i}=window;return new i(r)},[n]);return f.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function _b(e){return new Gr(ht(e),e)}function di(e,t,n){t===void 0&&(t=_b);const[r,s]=f.useState(null);function i(){s(c=>{if(!e)return null;if(e.isConnected===!1){var l;return(l=c??n)!=null?l:null}const u=t(e);return JSON.stringify(c)===JSON.stringify(u)?c:u})}const a=wb({callback(c){if(e)for(const l of c){const{type:u,target:g}=l;if(u==="childList"&&g instanceof HTMLElement&&g.contains(e)){i();break}}}}),o=An({callback:i});return me(()=>{i(),e?(o==null||o.observe(e),a==null||a.observe(document.body,{childList:!0,subtree:!0})):(o==null||o.disconnect(),a==null||a.disconnect())},[e]),r}function Sb(e){const t=pa(e);return sa(e,t)}const ui=[];function Tb(e){const t=f.useRef(e),n=Ht(r=>e?r&&r!==ui&&e&&t.current&&e.parentNode===t.current.parentNode?r:Wr(e):ui,[e]);return f.useEffect(()=>{t.current=e},[e]),n}function Eb(e){const[t,n]=f.useState(null),r=f.useRef(e),s=f.useCallback(i=>{const a=Un(i.target);a&&n(o=>o?(o.set(a,ir(a)),new Map(o)):null)},[]);return f.useEffect(()=>{const i=r.current;if(e!==i){a(i);const o=e.map(c=>{const l=Un(c);return l?(l.addEventListener("scroll",s,{passive:!0}),[l,ir(l)]):null}).filter(c=>c!=null);n(o.length?new Map(o):null),r.current=e}return()=>{a(e),a(i)};function a(o){o.forEach(c=>{const l=Un(c);l==null||l.removeEventListener("scroll",s)})}},[s,e]),f.useMemo(()=>e.length?t?Array.from(t.values()).reduce((i,a)=>rt(i,a),ce):da(e):ce,[e,t])}function gi(e,t){t===void 0&&(t=[]);const n=f.useRef(null);return f.useEffect(()=>{n.current=null},t),f.useEffect(()=>{const r=e!==ce;r&&!n.current&&(n.current=e),!r&&n.current&&(n.current=null)},[e]),n.current?pn(e,n.current):ce}function Cb(e){f.useEffect(()=>{if(!Dn)return;const t=e.map(n=>{let{sensor:r}=n;return r.setup==null?void 0:r.setup()});return()=>{for(const n of t)n==null||n()}},e.map(t=>{let{sensor:n}=t;return n}))}function Db(e,t){return f.useMemo(()=>e.reduce((n,r)=>{let{eventName:s,handler:i}=r;return n[s]=a=>{i(a,t)},n},{}),[e,t])}function fa(e){return f.useMemo(()=>e?Jy(e):null,[e])}const hi=[];function Ab(e,t){t===void 0&&(t=ht);const[n]=e,r=fa(n?Z(n):null),[s,i]=f.useState(hi);function a(){i(()=>e.length?e.map(c=>ca(c)?r:new Gr(t(c),c)):hi)}const o=An({callback:a});return me(()=>{o==null||o.disconnect(),a(),e.forEach(c=>o==null?void 0:o.observe(c))},[e]),s}function $b(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return zt(t)?t:e}function Nb(e){let{measure:t}=e;const[n,r]=f.useState(null),s=f.useCallback(l=>{for(const{target:u}of l)if(zt(u)){r(g=>{const h=t(u);return g?{...g,width:h.width,height:h.height}:h});break}},[t]),i=An({callback:s}),a=f.useCallback(l=>{const u=$b(l);i==null||i.disconnect(),u&&(i==null||i.observe(u)),r(u?t(u):null)},[t,i]),[o,c]=hn(a);return f.useMemo(()=>({nodeRef:o,rect:n,setRef:c}),[n,o,c])}const jb=[{sensor:Vr,options:{}},{sensor:ga,options:{}}],Rb={current:{}},on={draggable:{measure:ii},droppable:{measure:ii,strategy:kt.WhileDragging,frequency:or.Optimized},dragOverlay:{measure:ht}};class Nt extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,r;return(n=(r=this.get(t))==null?void 0:r.node.current)!=null?n:void 0}}const Ib={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Nt,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:fn},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:on,measureDroppableContainers:fn,windowRect:null,measuringScheduled:!1},Pb={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:fn,draggableNodes:new Map,over:null,measureDroppableContainers:fn},$n=f.createContext(Pb),va=f.createContext(Ib);function kb(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Nt}}}function Ob(e,t){switch(t.type){case U.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case U.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case U.DragEnd:case U.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case U.RegisterDroppable:{const{element:n}=t,{id:r}=n,s=new Nt(e.droppable.containers);return s.set(r,n),{...e,droppable:{...e.droppable,containers:s}}}case U.SetDroppableDisabled:{const{id:n,key:r,disabled:s}=t,i=e.droppable.containers.get(n);if(!i||r!==i.key)return e;const a=new Nt(e.droppable.containers);return a.set(n,{...i,disabled:s}),{...e,droppable:{...e.droppable,containers:a}}}case U.UnregisterDroppable:{const{id:n,key:r}=t,s=e.droppable.containers.get(n);if(!s||r!==s.key)return e;const i=new Nt(e.droppable.containers);return i.delete(n),{...e,droppable:{...e.droppable,containers:i}}}default:return e}}function Bb(e){let{disabled:t}=e;const{active:n,activatorEvent:r,draggableNodes:s}=f.useContext($n),i=rr(r),a=rr(n==null?void 0:n.id);return f.useEffect(()=>{if(!t&&!r&&i&&a!=null){if(!Ur(i)||document.activeElement===i.target)return;const o=s.get(a);if(!o)return;const{activatorNode:c,node:l}=o;if(!c.current&&!l.current)return;requestAnimationFrame(()=>{for(const u of[c.current,l.current]){if(!u)continue;const g=Ay(u);if(g){g.focus();break}}})}},[r,t,s,a,i]),null}function Lb(e,t){let{transform:n,...r}=t;return e!=null&&e.length?e.reduce((s,i)=>i({transform:s,...r}),n):n}function Mb(e){return f.useMemo(()=>({draggable:{...on.draggable,...e==null?void 0:e.draggable},droppable:{...on.droppable,...e==null?void 0:e.droppable},dragOverlay:{...on.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function Fb(e){let{activeNode:t,measure:n,initialRect:r,config:s=!0}=e;const i=f.useRef(!1),{x:a,y:o}=typeof s=="boolean"?{x:s,y:s}:s;me(()=>{if(!a&&!o||!t){i.current=!1;return}if(i.current||!r)return;const l=t==null?void 0:t.node.current;if(!l||l.isConnected===!1)return;const u=n(l),g=sa(u,r);if(a||(g.x=0),o||(g.y=0),i.current=!0,Math.abs(g.x)>0||Math.abs(g.y)>0){const h=ia(l);h&&h.scrollBy({top:g.y,left:g.x})}},[t,a,o,r,n])}const ma=f.createContext({...ce,scaleX:1,scaleY:1});var ke;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(ke||(ke={}));const zb=f.memo(function(t){var n,r,s,i;let{id:a,accessibility:o,autoScroll:c=!0,children:l,sensors:u=jb,collisionDetection:g=Gy,measuring:h,modifiers:p,...m}=t;const y=f.useReducer(Ob,void 0,kb),[b,S]=y,[A,C]=Py(),[_,D]=f.useState(ke.Uninitialized),P=_===ke.Initialized,{draggable:{active:v,nodes:x,translate:w},droppable:{containers:E}}=b,T=v!=null?x.get(v):null,$=f.useRef({initial:null,translated:null}),N=f.useMemo(()=>{var K;return v!=null?{id:v,data:(K=T==null?void 0:T.data)!=null?K:Rb,rect:$}:null},[v,T]),R=f.useRef(null),[oe,de]=f.useState(null),[z,qe]=f.useState(null),xe=It(m,Object.values(m)),mt=Ut("DndDescribedBy",a),Wt=f.useMemo(()=>E.getEnabled(),[E]),Y=Mb(h),{droppableRects:ye,measureDroppableContainers:Be,measuringScheduled:xt}=yb(Wt,{dragging:P,dependencies:[w.x,w.y],config:Y.droppable}),ne=mb(x,v),Gt=f.useMemo(()=>z?sr(z):null,[z]),Ae=Ha(),be=bb(ne,Y.draggable.measure);Fb({activeNode:v!=null?x.get(v):null,config:Ae.layoutShiftCompensation,initialRect:be,measure:Y.draggable.measure});const B=di(ne,Y.draggable.measure,be),yt=di(ne?ne.parentElement:null),ue=f.useRef({activatorEvent:null,active:null,activeNode:ne,collisionRect:null,collisions:null,droppableRects:ye,draggableNodes:x,draggingNode:null,draggingNodeRect:null,droppableContainers:E,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Ve=E.getNodeFor((n=ue.current.over)==null?void 0:n.id),we=Nb({measure:Y.dragOverlay.measure}),Ke=(r=we.nodeRef.current)!=null?r:ne,Xe=P?(s=we.rect)!=null?s:B:null,Zr=!!(we.nodeRef.current&&we.rect),Jr=Sb(Zr?null:B),Rn=fa(Ke?Z(Ke):null),$e=Tb(P?Ve??ne:null),qt=Ab($e),Vt=Lb(p,{transform:{x:w.x-Jr.x,y:w.y-Jr.y,scaleX:1,scaleY:1},activatorEvent:z,active:N,activeNodeRect:B,containerNodeRect:yt,draggingNodeRect:Xe,over:ue.current.over,overlayNodeRect:we.rect,scrollableAncestors:$e,scrollableAncestorRects:qt,windowRect:Rn}),Qr=Gt?rt(Gt,w):null,es=Eb($e),ka=gi(es),Oa=gi(es,[B]),Ye=rt(Vt,ka),Ze=Xe?Ky(Xe,Vt):null,bt=N&&Ze?g({active:N,collisionRect:Ze,droppableRects:ye,droppableContainers:Wt,pointerCoordinates:Qr}):null,ts=Hy(bt,"id"),[Ne,ns]=f.useState(null),Ba=Zr?Vt:rt(Vt,Oa),La=qy(Ba,(i=Ne==null?void 0:Ne.rect)!=null?i:null,B),In=f.useRef(null),rs=f.useCallback((K,J)=>{let{sensor:Q,options:je}=J;if(R.current==null)return;const re=x.get(R.current);if(!re)return;const ee=K.nativeEvent,ge=new Q({active:R.current,activeNode:re,event:ee,options:je,context:ue,onAbort(G){if(!x.get(G))return;const{onDragAbort:he}=xe.current,_e={id:G};he==null||he(_e),A({type:"onDragAbort",event:_e})},onPending(G,Re,he,_e){if(!x.get(G))return;const{onDragPending:_t}=xe.current,Ie={id:G,constraint:Re,initialCoordinates:he,offset:_e};_t==null||_t(Ie),A({type:"onDragPending",event:Ie})},onStart(G){const Re=R.current;if(Re==null)return;const he=x.get(Re);if(!he)return;const{onDragStart:_e}=xe.current,wt={activatorEvent:ee,active:{id:Re,data:he.data,rect:$}};nt.unstable_batchedUpdates(()=>{_e==null||_e(wt),D(ke.Initializing),S({type:U.DragStart,initialCoordinates:G,active:Re}),A({type:"onDragStart",event:wt}),de(In.current),qe(ee)})},onMove(G){S({type:U.DragMove,coordinates:G})},onEnd:Je(U.DragEnd),onCancel:Je(U.DragCancel)});In.current=ge;function Je(G){return async function(){const{active:he,collisions:_e,over:wt,scrollAdjustedTranslate:_t}=ue.current;let Ie=null;if(he&&_t){const{cancelDrop:St}=xe.current;Ie={activatorEvent:ee,active:he,collisions:_e,delta:_t,over:wt},G===U.DragEnd&&typeof St=="function"&&await Promise.resolve(St(Ie))&&(G=U.DragCancel)}R.current=null,nt.unstable_batchedUpdates(()=>{S({type:G}),D(ke.Uninitialized),ns(null),de(null),qe(null),In.current=null;const St=G===U.DragEnd?"onDragEnd":"onDragCancel";if(Ie){const Pn=xe.current[St];Pn==null||Pn(Ie),A({type:St,event:Ie})}})}}},[x]),Ma=f.useCallback((K,J)=>(Q,je)=>{const re=Q.nativeEvent,ee=x.get(je);if(R.current!==null||!ee||re.dndKit||re.defaultPrevented)return;const ge={active:ee};K(Q,J.options,ge)===!0&&(re.dndKit={capturedBy:J.sensor},R.current=je,rs(Q,J))},[x,rs]),ss=xb(u,Ma);Cb(u),me(()=>{B&&_===ke.Initializing&&D(ke.Initialized)},[B,_]),f.useEffect(()=>{const{onDragMove:K}=xe.current,{active:J,activatorEvent:Q,collisions:je,over:re}=ue.current;if(!J||!Q)return;const ee={active:J,activatorEvent:Q,collisions:je,delta:{x:Ye.x,y:Ye.y},over:re};nt.unstable_batchedUpdates(()=>{K==null||K(ee),A({type:"onDragMove",event:ee})})},[Ye.x,Ye.y]),f.useEffect(()=>{const{active:K,activatorEvent:J,collisions:Q,droppableContainers:je,scrollAdjustedTranslate:re}=ue.current;if(!K||R.current==null||!J||!re)return;const{onDragOver:ee}=xe.current,ge=je.get(ts),Je=ge&&ge.rect.current?{id:ge.id,rect:ge.rect.current,data:ge.data,disabled:ge.disabled}:null,G={active:K,activatorEvent:J,collisions:Q,delta:{x:re.x,y:re.y},over:Je};nt.unstable_batchedUpdates(()=>{ns(Je),ee==null||ee(G),A({type:"onDragOver",event:G})})},[ts]),me(()=>{ue.current={activatorEvent:z,active:N,activeNode:ne,collisionRect:Ze,collisions:bt,droppableRects:ye,draggableNodes:x,draggingNode:Ke,draggingNodeRect:Xe,droppableContainers:E,over:Ne,scrollableAncestors:$e,scrollAdjustedTranslate:Ye},$.current={initial:Xe,translated:Ze}},[N,ne,bt,Ze,x,Ke,Xe,ye,E,Ne,$e,Ye]),pb({...Ae,delta:w,draggingRect:Ze,pointerCoordinates:Qr,scrollableAncestors:$e,scrollableAncestorRects:qt});const Fa=f.useMemo(()=>({active:N,activeNode:ne,activeNodeRect:B,activatorEvent:z,collisions:bt,containerNodeRect:yt,dragOverlay:we,draggableNodes:x,droppableContainers:E,droppableRects:ye,over:Ne,measureDroppableContainers:Be,scrollableAncestors:$e,scrollableAncestorRects:qt,measuringConfiguration:Y,measuringScheduled:xt,windowRect:Rn}),[N,ne,B,z,bt,yt,we,x,E,ye,Ne,Be,$e,qt,Y,xt,Rn]),za=f.useMemo(()=>({activatorEvent:z,activators:ss,active:N,activeNodeRect:B,ariaDescribedById:{draggable:mt},dispatch:S,draggableNodes:x,over:Ne,measureDroppableContainers:Be}),[z,ss,N,B,S,mt,x,Ne,Be]);return j.createElement(ra.Provider,{value:C},j.createElement($n.Provider,{value:za},j.createElement(va.Provider,{value:Fa},j.createElement(ma.Provider,{value:La},l)),j.createElement(Bb,{disabled:(o==null?void 0:o.restoreFocus)===!1})),j.createElement(By,{...o,hiddenTextDescribedById:mt}));function Ha(){const K=(oe==null?void 0:oe.autoScrollEnabled)===!1,J=typeof c=="object"?c.enabled===!1:c===!1,Q=P&&!K&&!J;return typeof c=="object"?{...c,enabled:Q}:{enabled:Q}}}),Hb=f.createContext(null),pi="button",Ub="Draggable";function Wb(e){let{id:t,data:n,disabled:r=!1,attributes:s}=e;const i=Ut(Ub),{activators:a,activatorEvent:o,active:c,activeNodeRect:l,ariaDescribedById:u,draggableNodes:g,over:h}=f.useContext($n),{role:p=pi,roleDescription:m="draggable",tabIndex:y=0}=s??{},b=(c==null?void 0:c.id)===t,S=f.useContext(b?ma:Hb),[A,C]=hn(),[_,D]=hn(),P=Db(a,t),v=It(n);me(()=>(g.set(t,{id:t,key:i,node:A,activatorNode:_,data:v}),()=>{const w=g.get(t);w&&w.key===i&&g.delete(t)}),[g,t]);const x=f.useMemo(()=>({role:p,tabIndex:y,"aria-disabled":r,"aria-pressed":b&&p===pi?!0:void 0,"aria-roledescription":m,"aria-describedby":u.draggable}),[r,p,y,b,m,u.draggable]);return{active:c,activatorEvent:o,activeNodeRect:l,attributes:x,isDragging:b,listeners:r?void 0:P,node:A,over:h,setNodeRef:C,setActivatorNodeRef:D,transform:S}}function Gb(){return f.useContext(va)}const qb="Droppable",Vb={timeout:25};function Kb(e){let{data:t,disabled:n=!1,id:r,resizeObserverConfig:s}=e;const i=Ut(qb),{active:a,dispatch:o,over:c,measureDroppableContainers:l}=f.useContext($n),u=f.useRef({disabled:n}),g=f.useRef(!1),h=f.useRef(null),p=f.useRef(null),{disabled:m,updateMeasurementsFor:y,timeout:b}={...Vb,...s},S=It(y??r),A=f.useCallback(()=>{if(!g.current){g.current=!0;return}p.current!=null&&clearTimeout(p.current),p.current=setTimeout(()=>{l(Array.isArray(S.current)?S.current:[S.current]),p.current=null},b)},[b]),C=An({callback:A,disabled:m||!a}),_=f.useCallback((x,w)=>{C&&(w&&(C.unobserve(w),g.current=!1),x&&C.observe(x))},[C]),[D,P]=hn(_),v=It(t);return f.useEffect(()=>{!C||!D.current||(C.disconnect(),g.current=!1,C.observe(D.current))},[D,C]),f.useEffect(()=>(o({type:U.RegisterDroppable,element:{id:r,key:i,disabled:n,node:D,rect:h,data:v}}),()=>o({type:U.UnregisterDroppable,key:i,id:r})),[r]),f.useEffect(()=>{n!==u.current.disabled&&(o({type:U.SetDroppableDisabled,id:r,key:i,disabled:n}),u.current.disabled=n)},[r,i,n,o]),{active:a,rect:h,isOver:(c==null?void 0:c.id)===r,node:D,over:c,setNodeRef:P}}function Kr(e,t,n){const r=e.slice();return r.splice(n<0?r.length+n:n,0,r.splice(t,1)[0]),r}function Xb(e,t){return e.reduce((n,r,s)=>{const i=t.get(r);return i&&(n[s]=i),n},Array(e.length))}function Jt(e){return e!==null&&e>=0}function Yb(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Zb(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const xa=e=>{let{rects:t,activeIndex:n,overIndex:r,index:s}=e;const i=Kr(t,r,n),a=t[s],o=i[s];return!o||!a?null:{x:o.left-a.left,y:o.top-a.top,scaleX:o.width/a.width,scaleY:o.height/a.height}},Qt={scaleX:1,scaleY:1},Jb=e=>{var t;let{activeIndex:n,activeNodeRect:r,index:s,rects:i,overIndex:a}=e;const o=(t=i[n])!=null?t:r;if(!o)return null;if(s===n){const l=i[a];return l?{x:0,y:n<a?l.top+l.height-(o.top+o.height):l.top-o.top,...Qt}:null}const c=Qb(i,s,n);return s>n&&s<=a?{x:0,y:-o.height-c,...Qt}:s<n&&s>=a?{x:0,y:o.height+c,...Qt}:{x:0,y:0,...Qt}};function Qb(e,t,n){const r=e[t],s=e[t-1],i=e[t+1];return r?n<t?s?r.top-(s.top+s.height):i?i.top-(r.top+r.height):0:i?i.top-(r.top+r.height):s?r.top-(s.top+s.height):0:0}const ya="Sortable",ba=j.createContext({activeIndex:-1,containerId:ya,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:xa,disabled:{draggable:!1,droppable:!1}});function ew(e){let{children:t,id:n,items:r,strategy:s=xa,disabled:i=!1}=e;const{active:a,dragOverlay:o,droppableRects:c,over:l,measureDroppableContainers:u}=Gb(),g=Ut(ya,n),h=o.rect!==null,p=f.useMemo(()=>r.map(P=>typeof P=="object"&&"id"in P?P.id:P),[r]),m=a!=null,y=a?p.indexOf(a.id):-1,b=l?p.indexOf(l.id):-1,S=f.useRef(p),A=!Yb(p,S.current),C=b!==-1&&y===-1||A,_=Zb(i);me(()=>{A&&m&&u(p)},[A,p,m,u]),f.useEffect(()=>{S.current=p},[p]);const D=f.useMemo(()=>({activeIndex:y,containerId:g,disabled:_,disableTransforms:C,items:p,overIndex:b,useDragOverlay:h,sortedRects:Xb(p,c),strategy:s}),[y,g,_.draggable,_.droppable,C,p,b,c,h,s]);return j.createElement(ba.Provider,{value:D},t)}const tw=e=>{let{id:t,items:n,activeIndex:r,overIndex:s}=e;return Kr(n,r,s).indexOf(t)},nw=e=>{let{containerId:t,isSorting:n,wasDragging:r,index:s,items:i,newIndex:a,previousItems:o,previousContainerId:c,transition:l}=e;return!l||!r||o!==i&&s===a?!1:n?!0:a!==s&&t===c},rw={duration:200,easing:"ease"},wa="transform",sw=Pt.Transition.toString({property:wa,duration:0,easing:"linear"}),iw={roleDescription:"sortable"};function aw(e){let{disabled:t,index:n,node:r,rect:s}=e;const[i,a]=f.useState(null),o=f.useRef(n);return me(()=>{if(!t&&n!==o.current&&r.current){const c=s.current;if(c){const l=ht(r.current,{ignoreTransform:!0}),u={x:c.left-l.left,y:c.top-l.top,scaleX:c.width/l.width,scaleY:c.height/l.height};(u.x||u.y)&&a(u)}}n!==o.current&&(o.current=n)},[t,n,r,s]),f.useEffect(()=>{i&&a(null)},[i]),i}function ow(e){let{animateLayoutChanges:t=nw,attributes:n,disabled:r,data:s,getNewIndex:i=tw,id:a,strategy:o,resizeObserverConfig:c,transition:l=rw}=e;const{items:u,containerId:g,activeIndex:h,disabled:p,disableTransforms:m,sortedRects:y,overIndex:b,useDragOverlay:S,strategy:A}=f.useContext(ba),C=cw(r,p),_=u.indexOf(a),D=f.useMemo(()=>({sortable:{containerId:g,index:_,items:u},...s}),[g,s,_,u]),P=f.useMemo(()=>u.slice(u.indexOf(a)),[u,a]),{rect:v,node:x,isOver:w,setNodeRef:E}=Kb({id:a,data:D,disabled:C.droppable,resizeObserverConfig:{updateMeasurementsFor:P,...c}}),{active:T,activatorEvent:$,activeNodeRect:N,attributes:R,setNodeRef:oe,listeners:de,isDragging:z,over:qe,setActivatorNodeRef:xe,transform:mt}=Wb({id:a,data:D,attributes:{...iw,...n},disabled:C.draggable}),Wt=Ty(E,oe),Y=!!T,ye=Y&&!m&&Jt(h)&&Jt(b),Be=!S&&z,xt=Be&&ye?mt:null,Gt=ye?xt??(o??A)({rects:y,activeNodeRect:N,activeIndex:h,overIndex:b,index:_}):null,Ae=Jt(h)&&Jt(b)?i({id:a,items:u,activeIndex:h,overIndex:b}):_,be=T==null?void 0:T.id,B=f.useRef({activeId:be,items:u,newIndex:Ae,containerId:g}),yt=u!==B.current.items,ue=t({active:T,containerId:g,isDragging:z,isSorting:Y,id:a,index:_,items:u,newIndex:B.current.newIndex,previousItems:B.current.items,previousContainerId:B.current.containerId,transition:l,wasDragging:B.current.activeId!=null}),Ve=aw({disabled:!ue,index:_,node:x,rect:v});return f.useEffect(()=>{Y&&B.current.newIndex!==Ae&&(B.current.newIndex=Ae),g!==B.current.containerId&&(B.current.containerId=g),u!==B.current.items&&(B.current.items=u)},[Y,Ae,g,u]),f.useEffect(()=>{if(be===B.current.activeId)return;if(be!=null&&B.current.activeId==null){B.current.activeId=be;return}const Ke=setTimeout(()=>{B.current.activeId=be},50);return()=>clearTimeout(Ke)},[be]),{active:T,activeIndex:h,attributes:R,data:D,rect:v,index:_,newIndex:Ae,items:u,isOver:w,isSorting:Y,isDragging:z,listeners:de,node:x,overIndex:b,over:qe,setNodeRef:Wt,setActivatorNodeRef:xe,setDroppableNodeRef:E,setDraggableNodeRef:oe,transform:Ve??Gt,transition:we()};function we(){if(Ve||yt&&B.current.newIndex===_)return sw;if(!(Be&&!Ur($)||!l)&&(Y||ue))return Pt.Transition.toString({...l,property:wa})}}function cw(e,t){var n,r;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e==null?void 0:e.draggable)!=null?n:t.draggable,droppable:(r=e==null?void 0:e.droppable)!=null?r:t.droppable}}O.Down,O.Right,O.Up,O.Left;const lw="_dragging_11hxq_1",dw="_dragHandle_11hxq_5",cr={dragging:lw,dragHandle:dw};function uw({data:e,containerClassName:t,containerDataTestId:n,animationClassNames:r,onReorder:s,renderItem:i}){const a=Ly(ri(Vr,{activationConstraint:{delay:200,tolerance:5}}),ri(ha,{activationConstraint:{delay:200,tolerance:5}})),o=!!r,c={className:t,"data-testid":n},l=e.map(u=>o?d.jsx(En,{timeout:250,classNames:{enter:r==null?void 0:r.enter,enterActive:r==null?void 0:r.enterActive,exit:r==null?void 0:r.exit,exitActive:r==null?void 0:r.exitActive},children:d.jsx(fi,{id:u.id,children:g=>i(u,g)})},u.id):d.jsx(fi,{id:u.id,children:g=>i(u,g)},u.id));return d.jsx(zb,{sensors:a,collisionDetection:Uy,onDragStart:()=>document.body.classList.add(cr.dragging),onDragEnd:({active:u,over:g})=>{if(document.body.classList.remove(cr.dragging),!g||u.id===g.id)return;const h=e.findIndex(y=>y.id===u.id),p=e.findIndex(y=>y.id===g.id),m=Kr(e,h,p);s({active:e[h],oldIndex:h,newIndex:p,newData:m})},children:d.jsx(ew,{items:e,strategy:Jb,children:o?d.jsx(Cn,{component:"ul",...c,children:l}):d.jsx("ul",{...c,children:l})})})}function fi({id:e,children:t}){const{setNodeRef:n,attributes:r,listeners:s,transform:i,transition:a}=ow({id:e}),o={transform:Pt.Transform.toString(i),transition:a};return t({ref:n,style:o,className:cr.dragHandle,...r,...s})}function Xr(e){return new Promise((t,n)=>{e.oncomplete=e.onsuccess=()=>t(e.result),e.onabort=e.onerror=()=>n(e.error)})}function gw(e,t){let n;const r=()=>{if(n)return n;const s=indexedDB.open(e);return s.onupgradeneeded=()=>s.result.createObjectStore(t),n=Xr(s),n.then(i=>{i.onclose=()=>n=void 0},()=>{}),n};return(s,i)=>r().then(a=>i(a.transaction(t,s).objectStore(t)))}let qn;function _a(){return qn||(qn=gw("keyval-store","keyval")),qn}function hw(e,t=_a()){return t("readonly",n=>Xr(n.get(e)))}function pw(e,t,n=_a()){return n("readwrite",r=>(r.put(t,e),Xr(r.transaction)))}class fw{constructor(){I(this,"state");I(this,"subscribers");I(this,"IDB_PREFIX","app-store");I(this,"_persistenceEnabled",!0);I(this,"_updateStoreData",(t,n)=>{et(n);const r=t(this.state);this.state={...this.state,...r},this._notify(n),n.forEach(s=>{this._persistIDBAccessorValue(s)})});I(this,"_notify",t=>{et(t),t.forEach(n=>{this.isValidAccessor(n)&&this.subscribers[n].forEach(r=>{r()})})});I(this,"_subscribe",(t,n)=>{n.forEach(r=>{this.isValidAccessor(r)&&this.subscribers[r].push(t)})});I(this,"_delete",t=>{Object.keys(this.subscribers).forEach(n=>{this.isValidAccessor(n)&&(this.subscribers[n]=this.subscribers[n].filter(r=>r!==t))})});I(this,"subscribe",(t,n)=>{if(typeof t!="function")throw new Error(`Subscriber can't be of type ${typeof t}. Provide function.`);return et(n),this._subscribe(t,n),()=>{this._delete(t)}});I(this,"getPublicDataAccessorsToDataMap",t=>({trainings:t.trainings,completedTrainings:t.completedTrainings,exerciseTypes:t.exerciseTypes,activeTraining:t.activeTraining,newTraining:t.newTraining,newExercise:t.newExercise,auth:t.auth,sync:t.sync,notifications:t.notifications,uiBlockingLayer:t.uiBlockingLayer}));I(this,"getStoreData",t=>{et(t);const n=this.getPublicDataAccessorsToDataMap(this.state),r=Object.keys(n);return et(r),vi(r),t.reduce((i,a)=>(i[a]=n[a],i),{})});this.state={trainings:[],completedTrainings:[],exerciseTypes:[],activeTraining:null,newTraining:null,newExercise:null,auth:{user:null,isAuthenticated:!1,authLoading:!1,authError:null},sync:{lastSyncAt:void 0,isLoading:!1,serverHasChanges:!1,error:void 0},notifications:[],uiBlockingLayer:{isVisible:!1,message:void 0}},this.subscribers={trainings:[],completedTrainings:[],exerciseTypes:[],activeTraining:[],newTraining:[],newExercise:[],auth:[],sync:[],notifications:[],uiBlockingLayer:[]};const t=Object.keys(this.subscribers);et(t),vi(t)}async hasServerDataInIndexedDB(){try{return(await Promise.all([this._readIDBAccessorValue("completedTrainings")])).every(n=>typeof n<"u")}catch(t){return console.error("[Store] Failed to check IndexedDB emptiness:",t),!1}}_getIDBAccessorKey(t){return`${this.IDB_PREFIX}:${t}`}async _persistIDBAccessorValue(t){if(this._persistenceEnabled)try{const n=this._valueForIDBAccessor(t);await pw(this._getIDBAccessorKey(t),n)}catch(n){console.error(`[Store] Failed to persist "${t}" to IndexedDB:`,n)}}async _readIDBAccessorValue(t){try{return await hw(this._getIDBAccessorKey(t))}catch(n){console.error(`[Store] Failed to read ${t} from IndexedDB:`,n);return}}_valueForIDBAccessor(t){switch(t){case"trainings":return this.state.trainings;case"completedTrainings":return this.state.completedTrainings;case"exerciseTypes":return this.state.exerciseTypes;case"activeTraining":return this.state.activeTraining;case"newTraining":return this.state.newTraining;case"newExercise":return this.state.newExercise;case"auth":return this.state.auth;case"sync":return this.state.sync;case"notifications":return this.state.notifications;case"uiBlockingLayer":return this.state.uiBlockingLayer;default:return}}async hydrateFromIndexedDB(){this._persistenceEnabled=!1;try{const t=Nn.map(async n=>{const r=await this._readIDBAccessorValue(n);if(r!==void 0)switch(n){case"trainings":this.trainings=r;break;case"completedTrainings":this.completedTrainings=r;break;case"exerciseTypes":this.exerciseTypes=r;break;case"activeTraining":this.activeTraining=r;break;case"newTraining":this.newTraining=r;break;case"newExercise":this.newExercise=r;break;case"auth":this.auth=r;break;case"sync":this.sync=r;break;case"notifications":this.notifications=r;break;case"uiBlockingLayer":this.state.uiBlockingLayer=r;break;default:break}});await Promise.all(t)}finally{this._persistenceEnabled=!0}}isValidAccessor(t){return t in this.subscribers}get trainings(){return this.state.trainings}get completedTrainings(){return this.state.completedTrainings}get exerciseTypes(){return this.state.exerciseTypes}get notifications(){return this.state.notifications}get activeTraining(){return this.state.activeTraining}get newTraining(){return this.state.newTraining}get newExercise(){return this.state.newExercise}get auth(){return this.state.auth}get sync(){return this.state.sync}get uiBlockingLayer(){return this.state.uiBlockingLayer}set auth(t){const n=r=>({auth:{...r.auth,...t}});this._updateStoreData(n,["auth"])}set sync(t){const n=r=>({sync:{...r.sync,...t}});this._updateStoreData(n,["sync"])}set trainings(t){const n=()=>({trainings:t});this._updateStoreData(n,["trainings"])}set completedTrainings(t){const n=()=>({completedTrainings:t});this._updateStoreData(n,["completedTrainings"])}set exerciseTypes(t){const n=()=>({exerciseTypes:t});this._updateStoreData(n,["exerciseTypes"])}set activeTraining(t){const n=()=>({activeTraining:t});this._updateStoreData(n,["activeTraining"])}set newTraining(t){const n=()=>({newTraining:t});this._updateStoreData(n,["newTraining"])}set newExercise(t){const n=()=>({newExercise:t});this._updateStoreData(n,["newExercise"])}set notifications(t){const n=()=>({notifications:t});this._updateStoreData(n,["notifications"])}set uiBlockingLayer(t){const n=r=>({uiBlockingLayer:{...r.uiBlockingLayer,...t}});this._updateStoreData(n,["uiBlockingLayer"])}}const Nn=["trainings","completedTrainings","exerciseTypes","activeTraining","newTraining","newExercise","auth","sync","notifications","uiBlockingLayer"];function et(e){if(!xw(e))throw new Error("Public Data Accessors were not specified!");if(!mw(e))throw new Error(`Public Data Accessors are not valid!
      Provided accessors might not exist or there is a typo.`)}function vi(e){if(!vw(e))throw new Error(`Declare >>>ALL<<< Public Data Accessors!
      Seems some Data Accessor were missed.
      You added: ${e.join(", ")}.
      Must be added: ${Nn.join(", ")}.`)}function vw(e){return Nn.every(t=>e.includes(t))}function mw(e){return e.every(t=>Nn.includes(t))}function xw(e){return!(!Array.isArray(e)||!e.length)}const yw=()=>({history:qa()}),pt=Va(),Yr=X({getParentRoute:()=>pt,id:"pathless_auth"}),Sa=X({getParentRoute:()=>Yr,path:"menu"}),Ta=X({getParentRoute:()=>pt,path:"/"}),Ea=X({getParentRoute:()=>pt,path:"dashboard"}),jn=X({getParentRoute:()=>pt,path:"trainings"}),Ca=X({getParentRoute:()=>jn,path:"/"}),ft=X({getParentRoute:()=>jn,path:"$training"}),Da=X({getParentRoute:()=>ft,path:"/"}),Aa=X({getParentRoute:()=>ft,path:"new"}),$a=X({getParentRoute:()=>ft,path:"edit"}),vt=X({getParentRoute:()=>ft,path:"$exercise"}),Na=X({getParentRoute:()=>vt,path:"/"}),ja=X({getParentRoute:()=>vt,path:"new-exercise"}),Ra=X({getParentRoute:()=>vt,path:"editNew"}),Ia=X({getParentRoute:()=>vt,path:"edit"}),bw=pt.addChildren([Yr.addChildren([Sa]),Ta,Ea,jn.addChildren([Ca,ft.addChildren([Da,Aa,$a,vt.addChildren([Na,ja,Ra,Ia])])])]),ww=Ka({routeTree:bw,...yw()}),Pa={__root__:pt,"/":Ta,"/dashboard":Ea,"/pathless_auth":Yr,"/menu":Sa,"/trainings":jn,"/trainings/":Ca,"/trainings/$training":ft,"/trainings/$training/":Da,"/trainings/$training/edit":$a,"/trainings/$training/new":Aa,"/trainings/$training/$exercise":vt,"/trainings/$training/$exercise/":Na,"/trainings/$training/$exercise/edit":Ia,"/trainings/$training/$exercise/editNew":Ra,"/trainings/$training/$exercise/new-exercise":ja},_w=Object.keys(Pa),Sw=()=>{const e=(n,r)=>{const s=Pa[n];if(!s)throw new Error(`[ROUTER] originalRoute is absent for route path: ${n}`);const i=r[n];return i?s.update({component:i}):s};return{router:ww,setConfiguration:({routePathsToComponents:n})=>{_w.forEach(r=>{e(r,n)})}}},Tw=()=>{const e={home:"/",menu:"/menu",dashboard:"/dashboard",trainings:"/trainings",openTraining:"/trainings/$training",createTraining:"/trainings/$training/new",editTraining:"/trainings/$training/edit",openExercise:"/trainings/$training/$exercise",createExercise:"/trainings/$training/$exercise/new-exercise",editNewExercise:"/trainings/$training/$exercise/editNew",editExistingExercise:"/trainings/$training/$exercise/edit"},{router:t,setConfiguration:n}=Sw(),r=u=>({...t.matchRoute({to:u})}),s=u=>u&&u!=="/"?u.replace(/\/$/,""):u,i=()=>t.state.location.pathname,a=()=>{var p;const u=i(),g=t.matchRoutes(u),h=(p=g[g.length-1])==null?void 0:p.routeId;return s(h)},o=u=>!!t.matchRoute({to:u}),c=async(u,g={},h={})=>{await t.navigate({to:u,params:g,state:h})},l=()=>{var u;return(u=t.state.location.state)==null?void 0:u.goBackTo};return{__router:t,routes:e,setRouterConfiguration:u=>{n(u)},goBack:async({replace:u}={})=>{const g=l();if(g){const h=r(g);return t.navigate({to:g,params:h,replace:u})}else t.history.canGoBack()&&t.history.back()},toHome:()=>c(e.home),toTrainings:()=>c(e.trainings),toMenu:()=>c(e.menu),toCreateTraining:u=>c(e.createTraining,{training:u}),toCreateExercise:(u,g,h)=>c(e.createExercise,{training:u,exercise:g},{goBackTo:h==null?void 0:h.goBackTo}),toEditNewExercise:(u,g,h)=>c(e.editNewExercise,{training:u,exercise:g},{goBackTo:h==null?void 0:h.goBackTo}),toEditExistingExercise:(u,g)=>c(e.editExistingExercise,{training:u,exercise:g}),toEditTraining:u=>c(e.editTraining,{training:u}),toTraining:u=>c(e.openTraining,{training:u}),toExercise:(u,g)=>c(e.openExercise,{training:u,exercise:g}),toDashboard:()=>c(e.dashboard),isHomeUrl:()=>o(e.home),isTrainingsUrl:()=>o(e.trainings),isMenuUrl:()=>o(e.menu),getPathParams:r,getCurrentPath:i,getCurrentRoutePath:a}};var en,Ew=new Uint8Array(16);function Cw(){if(!en&&(en=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!en))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return en(Ew)}const Dw=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Aw(e){return typeof e=="string"&&Dw.test(e)}var q=[];for(var Vn=0;Vn<256;++Vn)q.push((Vn+256).toString(16).substr(1));function $w(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=(q[e[t+0]]+q[e[t+1]]+q[e[t+2]]+q[e[t+3]]+"-"+q[e[t+4]]+q[e[t+5]]+"-"+q[e[t+6]]+q[e[t+7]]+"-"+q[e[t+8]]+q[e[t+9]]+"-"+q[e[t+10]]+q[e[t+11]]+q[e[t+12]]+q[e[t+13]]+q[e[t+14]]+q[e[t+15]]).toLowerCase();if(!Aw(n))throw TypeError("Stringified UUID is invalid");return n}function fe(e,t,n){e=e||{};var r=e.random||(e.rng||Cw)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,$w(r)}const mi={id:"/AllTrainingsSchema",type:"array",items:{$ref:"/TrainingSchema"}},tn={id:"/TrainingSchema",type:"object",properties:{id:{type:"string"},name:{type:"string"},exercises:{type:"array",items:{$ref:"/ExerciseSchema"}}},required:["id","name","exercises"]},nn={id:"/ExerciseSchema",type:"object",properties:{id:{type:"string"},name:{type:"string"},sets:{type:"array",items:{$ref:"/SetSchema"}}},required:["id","name","sets"]},xi={id:"/SetSchema",type:"object",properties:{id:{type:"string"},repetitions:{type:"number"},weight:{type:"number"},time:{type:"string"}},required:["id","repetitions","weight"]},yi={id:"/CompletedTrainingsSchema",type:"array",items:{$ref:"/CompletedTrainingSchema"}},rn={id:"/CompletedTrainingSchema",type:"object",properties:{id:{type:"string"},name:{type:"string"},exercises:{type:"array",items:{$ref:"/CompletedExerciseSchema"}},createdInDbAt:{type:"string"},updatedInDbAt:{type:"string"}},required:["id","name","exercises"]},Nw={id:"/CompletedExerciseSchema",type:"object",properties:{id:{type:"string"},name:{type:"string"},sets:{type:"array",items:{$ref:"/SetSchema"}}},required:["id","name","sets"]},bi={id:"/ExerciseTypesSchema",type:"array",items:{$ref:"/ExerciseTypeSchema"}},jw={id:"/ExerciseTypeSchema",type:"object",properties:{group:{type:"string"},value:{type:"string"},label:{type:"string"}},required:["group","value","label"]},Rw=({store:e,validator:t},n)=>{t.addSchema(mi),t.addSchema(tn),t.addSchema(nn),t.addSchema(xi),t.addSchema(yi),t.addSchema(rn),t.addSchema(Nw),t.addSchema(jw),t.addSchema(bi);const{trainingsServerApi:r,notificationsApi:s}=n,i=(v,x)=>{t.validate(v,x).valid},a=()=>e.getStoreData(["trainings","completedTrainings","activeTraining","newTraining","newExercise","exerciseTypes"]),o=()=>{e.newTraining=null},c=()=>{e.newExercise=null},l=(v,x)=>{const w=a().newTraining;if((w==null?void 0:w.id)===v){e.newTraining={...w,exercises:w.exercises.filter(T=>T.id!==x)};return}const E=a().trainings.map(T=>T.id===v?{...T,exercises:T.exercises.filter($=>$.id!==x)}:T);_.allTrainings(E)},u=v=>{const x=[...a().trainings,v];_.allTrainings(x)},g=(v,x)=>{const w=a().newTraining;if((w==null?void 0:w.id)===v){_.newTraining({exercises:w.exercises.concat(x)});return}const E=a().trainings.map($=>$.id===v?{...$,exercises:$.exercises.concat(x)}:$);_.allTrainings(E);const T=a().activeTraining;if((T==null?void 0:T.templateTrainingId)===v)try{_.activeTraining({exercises:T.exercises.concat({id:fe(),name:x.name,sets:[]})})}catch{}},h=(v,x,w)=>{const E=a().newExercise,T=a().newTraining,$=N=>N.map(R=>R.id===x?{...R,sets:R.sets.concat(w)}:R);if((E==null?void 0:E.id)===x)_.newExercise({sets:E.sets.concat(w)});else if((T==null?void 0:T.id)===v)_.newTraining({exercises:$(T.exercises)});else{const N=a().trainings.map(R=>R.id===v?{...R,exercises:$(R.exercises)}:R);_.allTrainings(N)}},p=(v,x,w)=>{const E=a().newTraining,T=a().newExercise,$=N=>N.map(R=>R.id===x?{...R,sets:R.sets.filter(oe=>oe.id!==w)}:R);if((T==null?void 0:T.id)===x)_.newExercise({sets:T.sets.filter(N=>N.id!==w)});else if((E==null?void 0:E.id)===v)_.newTraining({exercises:$(E.exercises)});else{const N=a().trainings.map(R=>R.id===v?{...R,exercises:$(R.exercises)}:R);_.allTrainings(N)}},m=v=>{const x=a().trainings.filter(w=>w.id!==v);_.allTrainings(x)},y=v=>{let x="";return v.forEach((w,E)=>{x+=`${w.repetitions}x${w.weight}kg`,E<v.length-1&&(x+=" - ")}),x},b=v=>{const x=new Date(v),w=Intl.DateTimeFormat().resolvedOptions(),E="en-GB",T=w.timeZone;return x.toDateString().slice(0,3)+", "+x.toLocaleDateString(E,{timeZone:T})},S=v=>{const x=new Date(v),w=x.getHours()<10?"0"+x.getHours():x.getHours(),E=x.getMinutes()<10?"0"+x.getMinutes():x.getMinutes();return`${w}:${E}`},A={exerciseTypes:()=>a().exerciseTypes},C={newTraining:()=>{const v={id:fe(),name:"New Training",exercises:[]};i(v,tn),e.newTraining=v},newActiveTraining:v=>{const x=a().trainings.find(E=>E.id===v);if(!x)return;const w={id:fe(),name:x.name,timestamptz:jt(new Date),templateTrainingId:x.id,exercises:x.exercises.map(E=>({id:fe(),name:E.name,sets:[]}))};i(w,rn),e.activeTraining=w},newExercise:()=>{const v={id:fe(),name:"New Exercise",sets:[]};i(v,nn),e.newExercise=v},set:(v,x)=>{const w={id:fe(),repetitions:8,weight:12,done:!1};i(w,xi),h(v,x,w)},exerciseType:({label:v,group:x})=>{const E={value:`type::${fe()}`,label:v,group:x},$=[...a().exerciseTypes,E];_.exerciseTypes($)},setsPreview:v=>y(v),datePreview:b,timePreview:S},_={allTrainings:v=>{i(v,mi),e.trainings=v},completedTrainings:v=>{i(v,yi),e.completedTrainings=v},exerciseTypes:v=>{i(v,bi),e.exerciseTypes=v},newTraining:v=>{const x={...a().newTraining,...v};i(x,tn),e.newTraining=x},newActiveTraining:(v,x,w)=>{const E=a().activeTraining;if(!E)return;const T=a().trainings.find(N=>N.id===v);if(!T)return;const $=T.exercises.find(N=>N.id===x);$&&_.activeTraining({exercises:E.exercises.map(N=>N.name!==$.name?N:{...N,sets:N.sets.concat({id:fe(),repetitions:w.repetitions,weight:w.weight,timestamptz:jt(new Date)})})})},activeTraining:v=>{const x=a().activeTraining;if(!x)return;const w={...x,...v};i(w,rn),e.activeTraining=w},newExercise:v=>{const x={...a().newExercise,...v};i(x,nn),e.newExercise=x},training:(v,x)=>{const w=a().trainings.map(E=>E.id===v?{...E,...x}:E);_.allTrainings(w)},exercise:(v,x,w)=>{const E=a().trainings.map(T=>T.id===v?{...T,exercises:T.exercises.map($=>$.id===x?{...$,...w}:$)}:T);_.allTrainings(E)},exercisesOrder:(v,x)=>{const w=(N,R,oe)=>{const de=x.map(({id:z})=>N.find(qe=>R(qe,z))).filter(z=>!!z);de.length===N.length&&oe(de)},E=a().newTraining,T=a().activeTraining,$=a().trainings.find(N=>N.id===v);(E==null?void 0:E.id)===v?w(E.exercises,(N,R)=>N.id===R,N=>{_.newTraining({exercises:N})}):$&&w($.exercises,(N,R)=>N.id===R,N=>{_.training(v,{exercises:N})}),(T==null?void 0:T.templateTrainingId)===v&&w(T.exercises,(N,R)=>{var de;const oe=(de=$==null?void 0:$.exercises.find(z=>z.id===R))==null?void 0:de.name;return N.name===oe},N=>{_.activeTraining({exercises:N})})}};return{get:A,create:C,update:_,save:{newTraining:()=>{const v=a().newTraining;v&&(i(v,tn),u(v),o())},newExercise:v=>{const x=a().newExercise;x&&(i(x,nn),g(v,x),c())},newActiveTraining:()=>{const v=a().activeTraining;if(v){const x={...v};delete x.templateTrainingId,i(x,rn);const w=[...a().completedTrainings,x];_.completedTrainings(w),e.activeTraining=null}}},delete:{newTraining:()=>{o()},training:v=>{m(v)},completedTraining:async v=>{const x=a().completedTrainings.find(T=>T.id===v),w=x==null?void 0:x.createdInDbAt,E=a().completedTrainings.filter(T=>T.id!==v);if(_.completedTrainings(E),w)try{await r.delete.completedTraining(x)}catch(T){const $=[...a().completedTrainings,x];throw _.completedTrainings($),s.addNotification({type:"error",message:"Failed to delete training. It was restored."}),T}},newExercise:()=>{c()},exercise:(v,x)=>{l(v,x)},set:(v,x,w)=>{p(v,x,w)}}}};function wi(e){return/^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(e)}function Iw(e){return/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{6,}$/.test(e)}const Pw=(e,t,n)=>{const{store:r}=e,{httpClientAPI:s,notificationsApi:i}=t;async function a(g,h){if(!wi(g))throw new Error("Invalid email format");if(!Iw(h))throw new Error("Password does not meet requirements");r.auth={authLoading:!0};try{const p=await s.post("/api/signup",{email:g,password:h},{credentials:"include"}),m=p.session;n.saveToken({access_token:m.access_token,refresh_token:m.refresh_token,expires_in:m.expires_in,expires_at:m.expires_at}),r.auth={user:p.user,isAuthenticated:!0,authLoading:!1,authError:null}}catch(p){const m=`Signup failed. Error: ${p.message||String(p)||"Unknown error"}`;r.auth={authError:m,authLoading:!1},i.addNotification({type:"error",message:m})}}async function o(g,h){if(!wi(g))throw new Error("Invalid email format");r.auth={authLoading:!0};try{const p=await s.post("/api/signin",{email:g,password:h},{credentials:"include"}),m=p.session;n.saveToken({access_token:m.access_token,refresh_token:m.refresh_token,expires_in:m.expires_in,expires_at:m.expires_at}),r.auth={user:p.user,isAuthenticated:!0,authLoading:!1,authError:null}}catch(p){const m=`Signin failed. Error: ${p.message||String(p)||"Unknown error"}`;r.auth={authError:m,authLoading:!1},i.addNotification({type:"error",message:m})}}async function c(){r.auth={authLoading:!0};try{await s.post("/api/logout",{},{credentials:"include"}),n.clearToken(),r.auth={user:null,isAuthenticated:!1,authLoading:!1,authError:null}}catch(g){const h=`Signout failed. Error: ${g.message||String(g)||"Unknown error"}`;r.auth={authError:h,authLoading:!1},i.addNotification({type:"error",message:h})}}async function l(){r.auth={authLoading:!0};try{const g=await s.get("/api/session",{credentials:"include"});r.auth={user:g.user,isAuthenticated:!!g.user,authLoading:!1,authError:null}}catch(g){const h=`Get session failed. Error: ${g.message||String(g)||"Unknown error"}`;r.auth={authError:h,authLoading:!1},i.addNotification({type:"error",message:h})}}async function u(){try{const g=await s.post("/api/refresh",{},{credentials:"include"}),h=g.session;n.saveToken({access_token:h.access_token,refresh_token:h.refresh_token,expires_in:h.expires_in,expires_at:h.expires_at}),r.auth={user:g.user,isAuthenticated:!!g.user}}catch(g){const h=`Refresh token failed. Error: ${g.message||String(g)||"Unknown error"}`;r.auth={authError:h},i.addNotification({type:"error",message:h})}}return{signup:a,signin:o,signout:c,getSession:l,refreshToken:u}};function kw(e){const{tools:t,baseUrl:n,tokenStorage:r,refreshEndpoint:s,defaultHeaders:i={"Content-Type":"application/json",credentials:"include"}}=e,{store:a}=t;let o=!1,c=[];async function l(){if(o)return console.log(">> refreshing <<",o),new Promise(p=>{c.push(p)});o=!0;let h=null;try{const p=r.getToken();if(!p)return;const m=await fetch(`${n}${s}`,{method:"POST",headers:{...i},body:JSON.stringify({refreshToken:p.refresh_token})});if(!m.ok){r.clearToken();return}const b=(await m.json()).session;h={access_token:b.access_token,refresh_token:b.refresh_token,expires_in:b.expires_in,expires_at:b.expires_at},r.saveToken(h)}finally{o=!1,h&&c.forEach(p=>p(h.access_token)),c=[]}}const u=h=>h?Math.floor(Date.now()/1e3)>=h-30:void 0;async function g(h,p={},m=!0){const{method:y="GET",headers:b={},body:S,...A}=p,C=r.getToken(),_=C==null?void 0:C.expires_at;u(_)&&await l();const D=r.getToken(),P=D==null?void 0:D.access_token,v=D==null?void 0:D.refresh_token,x={...i,...b,...P?{Authorization:`Bearer ${P}`}:{},...v?{"x-ref-tok":v}:{}},w=await fetch(`${n}${h}`,{...A,method:y,headers:x,body:S!==void 0?JSON.stringify(S):void 0});if(w.status===401&&m){if(await l(),!r.getToken()){const N="Unauthorized. Token refresh failed.";throw a.auth={isAuthenticated:!1,authError:N},new Error(N)}return g(h,p,!1)}if(!w.ok){const T=await w.text();throw new Error(`HTTP ${w.status}: ${T}`)}const E=w.headers.get("Content-Type");return E!=null&&E.includes("application/json")?w.json():w.text()}return{get:(h,p)=>g(h,{...p,method:"GET"}),post:(h,p,m)=>g(h,{...m,method:"POST",body:p}),put:(h,p,m)=>g(h,{...m,method:"PUT",body:p}),patch:(h,p,m)=>g(h,{...m,method:"PATCH",body:p}),delete:(h,p)=>g(h,{...p,method:"DELETE"})}}const Ow={id:"/CompletedTrainingsServerReadSchema",type:"array",items:{$ref:"/CompletedTrainingServerReadSchema"}},Bw={id:"/CompletedTrainingServerReadSchema",type:"object",properties:{id:{type:"string"},name:{type:"string"},exercises:{type:"array",items:{$ref:"/CompletedExerciseServerReadSchema"}},created_at:{type:"string"},updated_at:{type:["string","null"]},user_id:{type:"string"}},required:["id","name","exercises","created_at","user_id"]},Lw={id:"/CompletedExerciseServerReadSchema",type:"object",properties:{id:{type:"string"},name:{type:"string"},type:{type:"string"},workout_id:{type:"string"},reps:{type:"number"},weight:{type:"number"},created_at:{type:"string"},date:{type:"string"},updated_at:{type:["string","null"]},user_id:{type:"string"}},required:["id","type","name","workout_id","reps","weight","created_at","date","user_id"]},Mw={id:"/CompletedTrainingsServerWriteSchema",type:"array",items:{$ref:"/CompletedTrainingServerWriteSchema"}},Fw={id:"/CompletedTrainingServerWriteSchema",type:"object",properties:{tempId:{type:"string"},name:{type:"string"},exercises:{type:"array",items:{$ref:"/CompletedExerciseServerWriteSchema"}},date:{type:"string"}},required:["name","exercises","date"]},zw={id:"/CompletedExerciseServerWriteSchema",type:"object",properties:{name:{type:"string"},type:{type:"string"},reps:{type:"number"},weight:{type:"number"},date:{type:"string"}},required:["type","name","reps","weight","date"]},sn={completedTrainings:Ow,completedTraining:Bw,completedExercise:Lw},an={completedTrainings:Mw,completedTraining:Fw,completedExercise:zw},Hw=({validator:e},t)=>{e.addSchema(sn.completedTrainings),e.addSchema(sn.completedTraining),e.addSchema(sn.completedExercise),e.addSchema(an.completedTrainings),e.addSchema(an.completedTraining),e.addSchema(an.completedExercise);const{httpClientAPI:n}=t,r=(b,S)=>{const A=e.validate(b,S);if(!A.valid)throw console.error("[ERROR_DATA] Validation for Server Training failed!",A.errors),new Error("Validation for Server Training failed!")},s=b=>{if(!b)return b;const S=Intl.DateTimeFormat().resolvedOptions().timeZone,A=ro(b,S);return so(A,"yyyy-MM-dd'T'HH:mm:ss.SSSXXX",{timeZone:S})},i=async()=>{let b=[];try{return b=await n.get("/api/workouts"),r(b,sn.completedTrainings),console.log("=== getCompletedTrainings ===",b),b}catch(S){throw console.error("[TrainingsServerApi]",S),S}},a=async b=>{try{const S=b.id;await n.delete(`/api/workouts/${S}`)}catch(S){throw console.error("[TrainingsServerApi]",S),S}},o=b=>b.sets.map(S=>({name:b.name,date:S.timestamptz,type:"custom",reps:S.repetitions,weight:S.weight})),c=b=>({tempId:b.id,name:b.name,date:b.timestamptz,exercises:b.exercises.flatMap(o)});return{get:{completedTrainings:i},create:{completedTrainings:async b=>{try{const S=b.map(c);return console.log("=== createCompletedTrainings ===",S),r(S,an.completedTrainings),await n.post("/api/workouts",{workouts:S})}catch(S){throw console.error("[TrainingsServerApi]",S),S}}},update:{},delete:{completedTraining:a},mappers:{toClientCompletedTrainings:b=>b.map(A=>{const C=Zi(A.exercises,D=>D.name),_=Object.values(C).map(D=>{var P;return{id:fe(),name:(P=D==null?void 0:D[0])==null?void 0:P.name,sets:(D==null?void 0:D.map(v=>({id:v.id,repetitions:v.reps,weight:v.weight,timestamptz:s(v.date)})))??[]}});return{id:A.id,name:A.name,exercises:_,timestamptz:s(A.date),createdInDbAt:s(A.created_at),updatedInDbAt:s(A.updated_at)??void 0}})}}},Uw=({store:e},t)=>{const{httpClientAPI:n,trainingsServerApi:r,trainingsApi:s,notificationsApi:i}=t,a=()=>e.getStoreData(["completedTrainings","sync"]),o=async()=>{try{const g=`/api/changes?${new URLSearchParams({since:e.getStoreData(["sync"]).sync.lastSyncAt||jt(new Date)}).toString()}`,h=await n.get(g),p=!!(h.completedTrainings.data.length||h.completedExercises.data.length);e.sync={serverHasChanges:p}}catch(u){throw console.error("[TrainingsServerApi] hasServerChanges failed. Error:",u),u}},c=async()=>{try{const u=a().completedTrainings.filter(m=>!m.createdInDbAt),g=u.map(m=>m.id);if(!u.length)return;const h=await r.create.completedTrainings(u),p=r.mappers.toClientCompletedTrainings(h);s.update.completedTrainings([...a().completedTrainings.filter(m=>!g.includes(m.id)),...p])}catch(u){throw new Error(`Failed to sync completed trainings: ${u.message}`)}};return{hasServerChanges:o,sync:async()=>{e.sync={isLoading:!0};try{await c(),e.sync={lastSyncAt:jt(new Date),isLoading:!1,error:void 0}}catch(u){e.sync={isLoading:!1,error:u.message},i.addNotification({type:"error",message:u.message||"Sync failed"})}}}},Ww=({store:e})=>{const t=()=>e.getStoreData(["notifications"]).notifications||[];return{getNotifications:t,addNotification:s=>{const i=fe(),a={id:i,type:s.type??"info",message:s.message??"",createdAt:jt(new Date),meta:s.meta??{}};return e.notifications=[a,...t()].slice(0,8),i},removeNotification:s=>{e.notifications=t().filter(i=>i.id!==s)}}},Gw=e=>{const t="__yg_at_rt",n={getToken:()=>{const c=localStorage.getItem(t);if(c)return JSON.parse(c)},saveToken:c=>localStorage.setItem(t,JSON.stringify(c)),clearToken:()=>localStorage.removeItem(t)},r=kw({tools:e,baseUrl:"https://yourgym.onrender.com",tokenStorage:n,refreshEndpoint:"/api/refresh"}),s=Ww(e),i=Hw(e,{httpClientAPI:r}),a=Rw(e,{trainingsServerApi:i,notificationsApi:s}),o=Uw(e,{httpClientAPI:r,trainingsServerApi:i,trainingsApi:a,notificationsApi:s});return{navigationApi:Tw(),trainingsApi:a,authApi:Pw(e,{httpClientAPI:r,notificationsApi:s},n),httpClientAPI:r,trainingsServerApi:i,syncApi:o,notificationsApi:s}};class qw{constructor(){I(this,"resumeTimer",null);I(this,"isRunning",!1);I(this,"lastResume",0);I(this,"onResume",async()=>{});I(this,"onRetryFailed",async()=>{});I(this,"logInfo",()=>{});I(this,"handleSignal",()=>{if(document.visibilityState!=="visible"){this.isRunning=!1;return}navigator.onLine||this.logInfo({message:"ResumeManager: OFFLINE when entring `handleSignal`."}),!(Date.now()-this.lastResume<2e3)&&(this.resumeTimer&&clearTimeout(this.resumeTimer),this.resumeTimer=window.setTimeout(()=>{navigator.onLine||this.logInfo({message:"ResumeManager: OFFLINE when calling `this.runResume()` !!!"}),this.resumeTimer=null,this.runResume()},500))})}init(t){return this.onResume=t.onResume,t.onRetryFailed&&(this.onRetryFailed=t.onRetryFailed),t.logInfo&&(this.logInfo=t.logInfo),document.addEventListener("visibilitychange",this.handleSignal,!1),window.addEventListener("pageshow",this.handleSignal,!1),window.addEventListener("focus",this.handleSignal,!1),()=>{document.removeEventListener("visibilitychange",this.handleSignal,!1),window.removeEventListener("pageshow",this.handleSignal,!1),window.removeEventListener("focus",this.handleSignal,!1)}}async runResume(){if(!this.isRunning){this.isRunning=!0,this.lastResume=Date.now();try{await this.onResume()}catch(t){console.error("ResumeManager: resume failed, retrying once",t);try{await this.retryOnce()}catch(n){console.error("ResumeManager: resume retry failed",n)}}finally{this.isRunning=!1}}}async retryOnce(){typeof navigator<"u"&&!navigator.onLine?await this.waitForOnline():await this.sleep(1e3);try{await this.onResume()}catch(t){try{await this.onRetryFailed(t)}catch(n){console.error("ResumeManager: onRetryFailed handler threw",n)}}}waitForOnline(t=3e4){return typeof navigator>"u"||navigator.onLine?Promise.resolve():new Promise(n=>{let r=null;const s=()=>{window.removeEventListener("online",i),r!==null&&(clearTimeout(r),r=null)},i=()=>{s(),n()};r=window.setTimeout(()=>{s(),n()},t),window.addEventListener("online",i,!1)})}sleep(t){return new Promise(n=>setTimeout(n,t))}}const Vw=(e,{authApi:t,syncApi:n,trainingsApi:r,trainingsServerApi:s,notificationsApi:i})=>{var A;let a=()=>{};const o=new qw;u(),g(),p(),o.init({onResume:l,onRetryFailed:async C=>{i.addNotification({type:"error",message:`Resume from background failed. Error: ${(C==null?void 0:C.message)||String(C)}`})},logInfo:({message:C})=>{i.addNotification({type:"info",message:C})}}),window.document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"&&h()},!1);let c=(A=e.auth)==null?void 0:A.isAuthenticated;e.subscribe(()=>{var C,_;S(c,(C=e.auth)==null?void 0:C.isAuthenticated)&&(c=(_=e.auth)==null?void 0:_.isAuthenticated,b())},["auth"]);async function l(){await Promise.all([u(),g()]),await b(),p()}function u(){return t.getSession()}function g(){return n.hasServerChanges()}function h(){a()}function p(){a=go(()=>{g().catch(D=>{const P=`[PeriodicTasks] check sync failed. Error: ${(D==null?void 0:D.message)||String(D)||"Unknown error"}`;i.addNotification({type:"error",message:P})})},3e5)}let m=!1,y=0;async function b(){var C;if(!m)try{if(!await e.hasServerDataInIndexedDB()&&(C=e.auth)!=null&&C.isAuthenticated){y=performance.now(),m=!0,e.uiBlockingLayer={isVisible:!0,message:"Hydrating local store with data from server..."},console.log("[HydrateStoreFromServer] ðŸ—ï¸ Starting hydration from server...");const[D]=await Promise.all([s.get.completedTrainings()]),P=s.mappers.toClientCompletedTrainings(D);r.update.completedTrainings(P),console.log("[HydrateStoreFromServer] âœ… Hydration from server completed successfully!")}}catch(_){const D=`[HydrateStoreFromServer] âš ï¸ Failed to hydrate store from server. Error: ${(_==null?void 0:_.message)||String(_)||"Unknown error"}`;i.addNotification({type:"error",message:D}),console.error(D)}finally{m=!1;const _=()=>{e.uiBlockingLayer={isVisible:!1,message:void 0}};performance.now()-y<1e3?setTimeout(()=>{_()},1500):_()}}function S(C,_){return C!==_&&_===!0}},Kw=async()=>{const e=new fw,t=new io;try{await e.hydrateFromIndexedDB()}catch(s){console.error("[initApp] hydrateFromIndexedDB failed. Error:",(s==null?void 0:s.message)||String(s)||"Unknown error")}const n=Gw({store:e,validator:t}),r={serviceLocator:{getStore:()=>({getStoreData:e.getStoreData,subscribe:e.subscribe}),getAPIs:()=>n}};return Vw(e,n),window._debugTools_={store:e,validator:t,apis:n},{apis:n,appContext:r}};window.addEventListener("load",async()=>{console.log(">>> LOAD event <<<");const{apis:e,appContext:t}=await Kw(),n=document.getElementById("root");n&&Ti(n).render(d.jsx(Zl,{apis:e,appContext:t}))},!1);
//# sourceMappingURL=index-Bp1qR1Iu.js.map
